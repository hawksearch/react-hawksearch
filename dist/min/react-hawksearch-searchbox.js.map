{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/ConfigProvider.tsx","webpack:///./src/models/Facets/FacetType.ts","webpack:///./src/store/HawkState.ts","webpack:///./src/util/MergableState.ts","webpack:///./src/util/WidgetBinding.ts","webpack:///./src/components/StoreProvider.tsx","webpack:///./src/components/TrackingEvent.tsx","webpack:///./src/models/Autocomplete/Request.ts","webpack:///./src/models/Autocomplete/Category.ts","webpack:///./src/models/Autocomplete/Product.ts","webpack:///./src/models/Autocomplete/Content.ts","webpack:///./src/models/Autocomplete/Popular.ts","webpack:///./src/models/Autocomplete/Response.ts","webpack:///./src/components/AuthToken.tsx","webpack:///./src/models/Search/ContentType.ts","webpack:///./node_modules/moment/locale sync ^\\.\\/.*$","webpack:///./src/net/HawkClient.ts","webpack:///./src/models/Search/Pagination.ts","webpack:///./src/models/Search/ChildResult.ts","webpack:///./src/models/Search/Result.ts","webpack:///./src/models/Search/Sorting.ts","webpack:///./src/models/Search/Selections.ts","webpack:///./src/models/Facets/Value.ts","webpack:///./src/models/Facets/Swatch.ts","webpack:///./src/models/Facets/Range.ts","webpack:///./src/models/Facets/Facet.ts","webpack:///./src/models/Search/Rule.ts","webpack:///./src/models/Search/Trigger.ts","webpack:///./src/models/Search/Merchandising.ts","webpack:///./src/models/Search/PageContent.ts","webpack:///./src/models/Search/Response.ts","webpack:///./src/store/Store.ts","webpack:///./src/components/ui/SearchBox/GlobalSearchBox.tsx","webpack:///./src/app/SearchBox.tsx","webpack:///./src/components/svg/PlusSVG.tsx","webpack:///./src/components/svg/MinusSVG.tsx","webpack:///./src/components/svg/QuestionmarkSVG.tsx","webpack:///./src/components/ui/Facets/Facet.tsx","webpack:///./src/components/svg/DashCircleSVG.tsx","webpack:///./src/components/svg/CheckmarkSVG.tsx","webpack:///./src/components/svg/PlusCircleSVG.tsx","webpack:///./src/components/ui/Facets/FacetTypes/Checkbox.tsx","webpack:///./src/components/ui/Facets/FacetTypes/Search.tsx","webpack:///./src/components/ui/Facets/FacetTypes/Link.tsx","webpack:///./src/components/ui/Facets/SliderCalendarInputs.tsx","webpack:///./src/components/ui/Facets/FacetTypes/SliderDate.tsx","webpack:///./src/components/ui/Facets/SliderNumericInputs.tsx","webpack:///./src/components/ui/Facets/FacetTypes/SliderNumeric.tsx","webpack:///./src/components/ui/Facets/FacetTypes/Slider.tsx","webpack:///./src/components/ui/Facets/FacetTypes/SwatchItem.tsx","webpack:///./src/components/ui/Facets/FacetTypes/Swatch.tsx","webpack:///./src/components/ui/Facets/FacetTypes/NestedItem.tsx","webpack:///./src/components/ui/Facets/FacetTypes/Nested.tsx","webpack:///./src/components/ui/Facets/FacetTypes/OpenRangeDatetime.tsx","webpack:///./src/components/ui/Facets/FacetTypes/OpenRangeNumber.tsx","webpack:///./src/components/ui/Facets/FacetTypes/OpenRange.tsx","webpack:///./src/components/ui/Facets/FacetTypes/SizeItem.tsx","webpack:///./src/components/ui/Facets/FacetTypes/Size.tsx","webpack:///./src/components/ui/Facets/FacetTypes/NestedLinkItem.tsx","webpack:///./src/components/ui/Facets/FacetTypes/NestedLink.tsx","webpack:///./src/components/ui/Facets/Overrides.ts","webpack:///./src/helpers/utils.ts","webpack:///./src/models/Autocomplete/Suggestion.ts","webpack:///./src/components/ui/SearchBox/SearchSuggestionsList.tsx","webpack:///./src/components/ui/SearchBox/SearchSuggestions.tsx","webpack:///./src/components/ui/SearchBox/SearchBoxBase.tsx"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","2","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","jsonpScriptSrc","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","ConfigContext","React","createContext","useHawkConfig","context","useContext","config","ConfigProvider","children","assetPath","path","startsWith","endsWith","__webpack_public_path__","Provider","FacetType","useHawkState","initialSearch","initialValue","typeConstructor","state","setState","client","HawkClient","SearchStore","pendingSearch","FacetSelections","isLoading","itemsToCompare","comparedResults","itemsToCompareIds","productDetails","language","URLSearchParams","location","search","useState","prevState","newState","store","setStore","cancellationToken","searchResults","searchParams","IsInPreview","isInPreview","ClientGuid","clientGuid","ClientData","getClientData","Keyword","decodeURIComponent","SearchWithin","indexName","assign","IndexName","indexNameRequired","axios","isCancel","requestError","Success","selectedFacets","keys","TrackingEvent","setLanguage","SortBy","PageNo","MaxPerPage","track","trackingId","TrackingId","typeId","SearchType","Refinement","keyword","Initial","Response","getComparedItems","pinItem","updatePinOrder","rebuildIndex","getProductDetails","setSearch","doHistory","setSearchSelections","selections","searchWithin","visitId","getCookie","visitorId","setCookie","createGuid","getVisitExpiry","getVisitorExpiry","clientData","VisitorId","VisitId","UserAgent","navigator","userAgent","PreviewBuckets","disablePreviewBuckets","VisitorTargets","map","v","Id","Custom","useEffect","cts","CancelToken","source","token","cancel","actor","toggleFacetValue","facet","facetValue","negate","facetName","Name","facetField","selectionField","valueValue","Value","valueLabel","Label","facetSelections","isFacetSelected","selState","selectionIndex","valuesToRemoved","items","forEach","item","indexOf","array1","array2","difference","filter","FacetSelectionState","Selected","Negated","NestedCheckbox","setFacetValues","facetValues","clearFacet","clearFacetValue","NotSelected","clearAllFacets","setItemsToCompare","resultItem","isCheck","itemsArray","DocId","setComparedResults","clearItemsToCompare","setProductDetailsResults","dataLayers","configurations","HawkContext","useHawksearch","StoreProvider","widgetId","dataLayer","_","require","entries","id","instance","isEqual","updateBindedStores","E_T","P_T","SuggestType","TrackEventNameMapping","Click","Cart","CopyRequestTracking","RequestTracking","Search","Sale","RecommendationImpression","RecommendationClick","Rate","PageLoad","Identify","BannerImpression","BannerClick","AutocompleteClick","Add2CartMultiple","Add2Cart","AvailableEvents","url","this","trackingURL","guid","clientGUID","getClientGUID","Date","setTime","getTime","toUTCString","params","CustomDictionary","substr","Math","floor","random","join","trackConfig","nameEQ","ca","cookie","split","charAt","substring","expiry","expires","pageType","documentElement","pl","EventType","pageLoad","EventData","btoa","JSON","stringify","PageTypeId","RequestPath","pathname","Qs","ViewportHeight","clientHeight","ViewportWidth","clientWidth","mr","queryId","QueryId","TypeId","uniqueId","click","Url","UniqueId","ScrollX","scrollX","ScrollY","scrollY","MouseX","clientX","MouseY","clientY","bannerId","campaignId","bannerClick","CampaignId","BannerId","bannerImpression","orderNo","itemList","total","subTotal","tax","currency","sale","OrderNo","ItemList","Total","Tax","SubTotal","Currency","price","quantity","addToCart","Quantity","Price","args","add2CartMultiple","ItemsList","rate","widgetGuid","itemIndex","requestId","recommendationClick","ItemIndex","RequestId","WidgetGuid","suggestType","autoCompleteClick","languageParams","getLanguageParams","fetch","method","headers","body","catch","eventName","isEnabled","toLowerCase","writePageLoad","writeSearchTracking","writeClick","writeBannerClick","writeBannerImpression","writeSale","writeAdd2Cart","writeAdd2CartMultiple","writeRate","writeRecommendationClick","writeAutoCompleteClick","Boolean","includes","find","getInstance","Category","init","SuggestionType","Suggestion","CategoryStrategy","downshift","Product","ProductStrategy","ProductName","Content","ContentStrategy","Popular","PopularStrategy","Categories","Products","AuthToken","accessToken","refreshToken","ContentType","webpackContext","req","webpackContextResolve","code","baseUrl","apiUrl","dashboardUrl","searchUrl","autocompleteUrl","compareItemsURL","refreshTokenURL","pinItemURL","updatePinOrderURL","rebuildIndexURL","productDetailsURL","axiosInstance","interceptors","use","conf","getTokens","Authorization","common","response","originalRequest","status","_retry","post","URL","href","Token","RefreshToken","then","res","setTokens","defaults","cancelToken","Result","Pagination","Items","PaginationItem","ChildResult","field","values","ChildResults","Document","Sorting","SortingItem","Selections","selFacet","SelectionFacet","SelectionFacetValue","Swatch","Range","Facet","SwatchData","Ranges","Values","DisplayType","TruncateThreshold","IsSearch","SearchThreshold","ParamName","Field","RuleType","RuleOperatorType","Rule","Parent","Rules","BannerTrigger","FeaturedItems","FeaturedItem","Merchandising","MerchandisingItem","PageContentItem","Trigger","PageContent","Results","Facets","f","initial","selectionIdx","negationIdx","selectedValue","clientSelections","facets","label","fieldName","selectionValues","FieldType","selectionValue","matchingVal","findMatchingValue","Path","matchingValue","Children","GlobalSearchBox","SuggestionList","searchPageUrl","className","SearchBoxBase","onSubmit","inputValue","redirect","onViewMatches","closeMenu","PageId","CustomUrl","initializeSearchBox","searchBoxElement","renderElem","getElementById","ReactDOM","render","Hawksearch","PlusSVG","props","viewBox","class","focusable","aria-hidden","MinusSVG","QuestionmarkSVG","FacetContext","useFacet","searchActor","wrapperRef","useRef","setFilter","shouldTruncate","isTruncated","setTruncated","useCookies","cookies","cookieValue","IsCollapsible","IsCollapsedDefault","getInitialCollapsibleState","isCollapsed","setCollapsed","useTranslation","i18n","shouldSearch","val","remainingFacets","valuesBeforeTrunc","selectFacet","negateFacet","setFacets","decimalPrecision","renderer","renderTruncation","onClick","current","contains","toggleCollapsible","Tooltip","ref","dangerouslySetInnerHTML","__html","onChange","currentTarget","placeholder","DashCircleSVG","fill","CheckmarkSVG","PlusCircleSVG","FacetRangeDisplayType","Checkbox","renderCheckMark","isSelected","renderFacetActions","isNegated","correspondingRange","rangeValueAssetUrl","AssetFullUrl","selectionState","aria-pressed","title","Text","alt","style","textDecoration","Count","hawkActor","input","setInput","onKeyDown","Link","setLinkFacet","formatDate","unixFormat","date","getFullYear","toString","getMonth","getDate","SliderCalendarInputs","sliderProps","minValue","setMinValue","maxValue","setMaxValue","Number","min","max","newMinValue","isNaN","onValueChange","newMaxValue","Rheostat","lazy","replaceHyphen","replace","SliderDate","range","RangeMin","rangeMin","setMinRange","RangeMax","rangeMax","setMaxRange","RangeStart","rangeStart","setStartRange","RangeEnd","rangeEnd","setEndRange","paramName","newRange","minVal","maxVal","formattedMinVal","formattedMaxVal","selection","Suspense","fallback","currentMinValue","currentMaxValue","ceil","onValuesUpdated","newMin","newMax","SliderNumericInputs","reloadFacets","thousandSeparator","isCurrency","prefix","currencySymbol","formattedValue","onBlur","decimalScale","SliderNumeric","parseFloat","toFixed","IsCurrency","isCurency","setIsCurrency","CurrencySymbol","setCurrencySymbol","selectedValues","Slider","DataType","SwatchItem","swatchValue","swatchUrl","facetSwatch","AssetUrl","AssetName","colorSwatchStyle","backgroundColor","Color","listItemClassNames","onSwatchSelected","isColor","NestedItem","expanded","ua","oldIE","newIe","classes","isExpanded","setIsExpanded","setIsTruncated","hierarchyValue","hierarchyChildren","remainingValues","shouldTruncateChildren","facetArray","matchValue","onValueSelected","aria-expanded","Nested","OpenRangeDatetime","daterange","rangeStartDate","moment","format","rangeEndDate","minDateValue","setdateStartValue","maxDateValue","setdateEndValue","setdateFacetValues","startVal","endVal","OpenRangeNumber","setStartValue","setEndValue","data-type","OpenRange","SizeItem","memo","size","Size","NestedLinkItem","NestedLink","defaultFacetComponents","facetType","component","DefaultCheckbox","DefaultNestedCheckbox","DefaultSearch","DefaultLink","DefaultSlider","DefaultSwatch","DefaultOpenRange","DefaultSize","Nestedlink","DefaultNestedLink","defaultAutocompleteStrategies","SuggestionStrategy","getFacetComponents","overridedComponents","facetComponents","fType","fComponent","getAutocompleteStrategies","overridedStrategies","suggestionStrategies","sType","autocompleteStrategy","strategyMatch","createWidgetId","suggestionType","SearchSuggestionsList","popular","categories","products","content","hasPopular","hasCategories","hasProducts","hasContent","hasAllEmpty","SearchSuggestions","query","results","setResults","setIsLoading","autocomplete","DisplayFullResponse","debounceMs","autocompleteDebounce","doAutocomplete","strategies","autocompleteStrategies","initialInput","setInitialInput","IgnoreSpellcheck","AdjustedKeyword","stateReducer","changes","itemToString","matchedStrategy","strategy","handleToString","handleItemChange","initialInputValue","options","isOpen","getInputProps","openMenu","showSuggestions","aria-labelledby","width","onFocus"],"mappings":"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","file":"react-hawksearch-searchbox.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t2: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"react-hawksearch-\" + ({\"4\":\"vendors~rheostat\"}[chunkId]||chunkId) + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/assets/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([557,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import React, { useContext } from 'react';\r\n\r\nimport { HawksearchConfig } from 'types/HawksearchConfig';\r\n\r\nconst ConfigContext = React.createContext({} as ConfigContextValue);\r\n\r\nexport interface ConfigContextValue {\r\n\t/** Global configuration. */\r\n\tconfig: HawksearchConfig;\r\n}\r\n\r\nexport interface ConfigProviderProps {\r\n\tconfig: HawksearchConfig;\r\n\tchildren: React.ReactNode;\r\n}\r\n\r\n// declare webpack's constant to appease typescript\r\ndeclare var __webpack_public_path__: string;\r\n\r\nfunction ConfigProvider({ config, children }: ConfigProviderProps) {\r\n\tif (config.assetPath) {\r\n\t\tlet path = config.assetPath;\r\n\r\n\t\t// ensure the provided path both starts and ends with a slash\r\n\t\tif (!path.startsWith('/')) {\r\n\t\t\tpath = '/' + path;\r\n\t\t}\r\n\t\tif (!path.endsWith('/')) {\r\n\t\t\tpath = path + '/';\r\n\t\t}\r\n\r\n\t\t// allow consumers to tell webpack where to load code split/lazy loaded files from, as they may not be\r\n\t\t// hosting our JS from /assets/ (the default path)\r\n\t\t__webpack_public_path__ = path;\r\n\t}\r\n\r\n\treturn <ConfigContext.Provider value={{ config }}>{children}</ConfigContext.Provider>;\r\n}\r\n\r\nexport function useHawkConfig() {\r\n\tconst context = useContext(ConfigContext);\r\n\r\n\tif (!context.config) {\r\n\t\tthrow new Error(\r\n\t\t\t'No HawksearchConfig is available, did you forget to wrap your components in a ConfigProvider component?'\r\n\t\t);\r\n\t}\r\n\r\n\treturn context;\r\n}\r\n\r\nexport default ConfigProvider;\r\n","export enum FacetType {\r\n\tCheckbox = 'checkbox',\r\n\tNestedCheckbox = 'nestedcheckbox',\r\n\tLink = 'link',\r\n\tNestedlink = 'nestedlinklist',\r\n\tSlider = 'slider',\r\n\tSwatch = 'swatch',\r\n\tRating = 'rating',\r\n\tSize = 'size',\r\n\tSearchWithin = 'search',\r\n\tRecentSearches = 'recentsearches',\r\n\tRelatedSearches = 'related',\r\n\tOpenRange = 'openRange',\r\n}\r\n","import { useEffect } from 'react';\r\nimport axios, { CancelToken } from 'axios';\r\n\r\nimport { SearchStore, FacetSelectionState } from './Store';\r\nimport HawkClient from 'net/HawkClient';\r\nimport { Response, Request, FacetSelections, Result } from 'models/Search';\r\nimport { useMergableState } from 'util/MergableState';\r\nimport { useHawkConfig } from 'components/ConfigProvider';\r\nimport { Facet, Value } from 'models/Facets';\r\nimport { FacetType } from 'models/Facets/FacetType';\r\nimport { Response as CompareDataResponse, Request as CompareItemRequest } from 'models/CompareItems';\r\nimport { Request as ProductDetailsRequest, Response as ProductDetailsResponse } from 'models/ProductDetails';\r\nimport { Request as PinItemRequest } from 'models/PinItems';\r\nimport { Request as SortingOrderRequest } from 'models/PinItemsOrder';\r\nimport { Request as RebuildIndexRequest } from 'models/RebuildIndex';\r\nimport TrackingEvent, { SearchType } from 'components/TrackingEvent';\r\nimport { getCookie, setCookie, createGuid, getVisitExpiry, getVisitorExpiry } from 'helpers/utils';\r\nimport { ClientSelectionValue } from './ClientSelections';\r\n\r\ninterface ClientData {\r\n\tVisitorId: string;\r\n\tVisitId: string;\r\n\tUserAgent: string;\r\n\tPreviewBuckets?: number[];\r\n\tCustom?: {\r\n\t\tlanguage: string;\r\n\t};\r\n}\r\n\r\nexport interface SearchActor {\r\n\t/**\r\n\t * Performs a search with the currently configured pending search request. The search request can be\r\n\t * configured via the `setSearch` method. This method usually doesn't need to be called directly, as\r\n\t * the `StoreProvider` component will usually trigger searches directly in response to calls to\r\n\t * `setSearch`.\r\n\t * @returns A promise that resolves when the search request has been completed.\r\n\t */\r\n\tsearch(cancellationToken?: CancelToken): Promise<void>;\r\n\r\n\t/**\r\n\t * Configures the next search request that will be executed. This will also execute a search in response to\r\n\t * the next search request changing.\r\n\t * @param search The partial search request object. This will be merged with previous calls to `setSearch`.\r\n\t * @param doHistory Whether or not this search request will push a history entry into the browser. If\r\n\t * \t\t\t\t\tnot specified, the default is `true`.\r\n\t */\r\n\tsetSearch(search: Partial<Request>, doHistory?: boolean): void;\r\n\r\n\t/**\r\n\t * Toggles a facet value for the next search request that will be executed. If the given facet had previously\r\n\t * been selected, it will be unselected. If the negation state of a selected facet is changed, the selection\r\n\t * will have its negation state changed. Internally, this will call `setSearch` to configure the next search\r\n\t * with this selected facet.\r\n\t * @param facet The facet for which the value is being selected.\r\n\t * @param facetValue The facet value being selected.\r\n\t * @param negate  Whether or not this selection is considered a negation.\r\n\t */\r\n\ttoggleFacetValue(facet: Facet | string, facetValue: Value | string, negate?: boolean): void;\r\n\r\n\tsetFacetValues(facet: Facet | string, facetValues: Value[] | string[]): void;\r\n\r\n\t/**\r\n\t * Entirely clears all the values of the given facet from the current selection.\r\n\t * @param facet The facet to clear.\r\n\t */\r\n\tclearFacet(facet: Facet | string): void;\r\n\r\n\t/**\r\n\t * Clears a given facet value of the given facet from the current selection.\r\n\t * @param facet The facet to clear.\r\n\t * @param facetValue The facet value to clear.\r\n\t */\r\n\tclearFacetValue(facet: Facet | string, facetValue?: Value | string): void;\r\n\r\n\t/**\r\n\t * Clears all selected facets from the current selection.\r\n\t */\r\n\tclearAllFacets(): void;\r\n\r\n\t// Store items to make comparision via request\r\n\tsetItemsToCompare(resultItem: Result, isCheck: boolean): void;\r\n\r\n\t// To store items after getting the results from compare request\r\n\tsetComparedResults(comparedResults: Result[]): void;\r\n\r\n\t// To store items after getting the results from compare request\r\n\tsetProductDetailsResults(detailsResult: Result): void;\r\n\r\n\t// Clear stored compared items\r\n\tclearItemsToCompare(): void;\r\n\r\n\t// Get comparision of items from request\r\n\tgetComparedItems(request: CompareItemRequest, cancellationToken?: CancelToken): Promise<CompareDataResponse>;\r\n\r\n\t// Pin items\r\n\tpinItem(payload: PinItemRequest, cancellationToken?: CancelToken): Promise<string | null>;\r\n\r\n\t// update sorting order of pinned items\r\n\tupdatePinOrder(payload: SortingOrderRequest, cancellationToken?: CancelToken): Promise<string | null>;\r\n\r\n\t// rebuild Index\r\n\trebuildIndex(request: RebuildIndexRequest, cancellationToken?: CancelToken): Promise<string | null>;\r\n\r\n\t// Get product details\r\n\tgetProductDetails(request: ProductDetailsRequest, cancellationToken?: CancelToken): Promise<ProductDetailsResponse>;\r\n\r\n\tsetStore(store: SearchStore): void;\r\n}\r\n\r\nexport function useHawkState(initialSearch?: Partial<Request>): [SearchStore, SearchActor] {\r\n\tconst { config } = useHawkConfig();\r\n\r\n\tconst client = new HawkClient(config);\r\n\r\n\tconst [store, setStore] = useMergableState(\r\n\t\tnew SearchStore({\r\n\t\t\tpendingSearch: initialSearch || {\r\n\t\t\t\tFacetSelections: {},\r\n\t\t\t},\r\n\t\t\tisLoading: true,\r\n\t\t\titemsToCompare: [],\r\n\t\t\tcomparedResults: [],\r\n\t\t\titemsToCompareIds: [],\r\n\t\t\tproductDetails: {},\r\n\t\t\tlanguage: getInitialLanguage(),\r\n\t\t}),\r\n\t\tSearchStore\r\n\t);\r\n\r\n\tuseEffect(() => {\r\n\t\t// when the pending search changes, trigger a search\r\n\r\n\t\tconst cts = axios.CancelToken.source();\r\n\t\tsearch(cts.token);\r\n\r\n\t\treturn () => {\r\n\t\t\tcts.cancel();\r\n\t\t};\r\n\t}, [store.pendingSearch]);\r\n\r\n\t/**\r\n\t * Performs a search with the currently configured pending search request. The search request can be\r\n\t * configured via the `setSearch` method. This method usually doesn't need to be called directly, as\r\n\t * the `StoreProvider` component will usually trigger searches directly in response to calls to\r\n\t * `setSearch`.\r\n\t * @returns A promise that resolves when the search request has been completed.\r\n\t */\r\n\tasync function search(cancellationToken?: CancelToken): Promise<void> {\r\n\t\tsetStore({ isLoading: true });\r\n\r\n\t\tlet searchResults: Response | null = null;\r\n\t\tconst searchParams = {\r\n\t\t\t// the search request being executed is spread from the pendingSearch\r\n\t\t\t...store.pendingSearch,\r\n\t\t\t// pass parameter for extended response\r\n\t\t\tIsInPreview: config.isInPreview,\r\n\t\t\t// and override some of the request fields with config values\r\n\t\t\tClientGuid: config.clientGuid,\r\n\t\t\tClientData: getClientData(),\r\n\t\t\tKeyword: store.pendingSearch.Keyword\r\n\t\t\t\t? decodeURIComponent(store.pendingSearch.Keyword || '')\r\n\t\t\t\t: store.pendingSearch.Keyword,\r\n\t\t\tSearchWithin: store.pendingSearch.SearchWithin\r\n\t\t\t\t? decodeURIComponent(store.pendingSearch.SearchWithin || '')\r\n\t\t\t\t: store.pendingSearch.SearchWithin,\r\n\t\t};\r\n\r\n\t\t// The index name in the configuration takes priority over the one supplied from the URL\r\n\t\tif (config.indexName) {\r\n\t\t\tObject.assign(searchParams, { IndexName: config.indexName });\r\n\t\t}\r\n\r\n\t\t// If the index name is required and no value is provided from the config or the URL, the request is canceled\r\n\t\tif (config.indexNameRequired && !searchParams.IndexName) {\r\n\t\t\tsetStore({ isLoading: false });\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tsearchResults = await client.search(searchParams, cancellationToken);\r\n\t\t} catch (error) {\r\n\t\t\tif (axios.isCancel(error)) {\r\n\t\t\t\t// if the request was cancelled, it's because this component was updated\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.error('Search request error:', error);\r\n\t\t\tsetStore({ requestError: true });\r\n\t\t}\r\n\r\n\t\tsetStore({ isLoading: false });\r\n\r\n\t\tif (searchResults) {\r\n\t\t\tif (!searchResults.Success) {\r\n\t\t\t\tconsole.error('Search result error:', searchResults);\r\n\t\t\t\tsetStore({ requestError: true });\r\n\t\t\t} else {\r\n\t\t\t\tconst selectedFacets = searchParams.FacetSelections ? Object.keys(searchParams.FacetSelections) : [];\r\n\r\n\t\t\t\tTrackingEvent.setLanguage(store.language);\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\tsearchParams.SortBy ||\r\n\t\t\t\t\tsearchParams.PageNo ||\r\n\t\t\t\t\tsearchParams.MaxPerPage ||\r\n\t\t\t\t\tselectedFacets.length ||\r\n\t\t\t\t\tsearchParams.SearchWithin\r\n\t\t\t\t) {\r\n\t\t\t\t\tTrackingEvent.track('searchtracking', {\r\n\t\t\t\t\t\ttrackingId: searchResults.TrackingId,\r\n\t\t\t\t\t\ttypeId: SearchType.Refinement,\r\n\t\t\t\t\t\tkeyword: searchParams.Keyword,\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tTrackingEvent.track('searchtracking', {\r\n\t\t\t\t\t\ttrackingId: searchResults.TrackingId,\r\n\t\t\t\t\t\ttypeId: SearchType.Initial,\r\n\t\t\t\t\t\tkeyword: searchParams.Keyword,\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetStore({\r\n\t\t\t\t\tsearchResults: new Response(searchResults),\r\n\t\t\t\t\trequestError: false,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Performs a comparision between two or more than two products based on ID\r\n\t * user can use this method from view application.\r\n\t * @returns A promise that resolves when the compare request has been completed.\r\n\t */\r\n\tasync function getComparedItems(\r\n\t\trequest: CompareItemRequest,\r\n\t\tcancellationToken?: CancelToken\r\n\t): Promise<CompareDataResponse> {\r\n\t\treturn await client.getComparedItems(request, cancellationToken);\r\n\t}\r\n\r\n\tasync function pinItem(request: PinItemRequest, cancellationToken?: CancelToken): Promise<string | null> {\r\n\t\treturn await client.pinItem(request, cancellationToken);\r\n\t}\r\n\r\n\tasync function updatePinOrder(\r\n\t\trequest: SortingOrderRequest,\r\n\t\tcancellationToken?: CancelToken\r\n\t): Promise<string | null> {\r\n\t\treturn await client.updatePinOrder(request, cancellationToken);\r\n\t}\r\n\r\n\tasync function rebuildIndex(request: RebuildIndexRequest, cancellationToken?: CancelToken): Promise<string | null> {\r\n\t\treturn await client.rebuildIndex(request);\r\n\t}\r\n\r\n\t/**\r\n\t * Get product details by ID\r\n\t * @returns A promise that resolves when the product details request has been completed.\r\n\t */\r\n\tasync function getProductDetails(\r\n\t\trequest: ProductDetailsRequest,\r\n\t\tcancellationToken?: CancelToken\r\n\t): Promise<ProductDetailsResponse> {\r\n\t\treturn await client.getProductDetails(request, cancellationToken);\r\n\t}\r\n\r\n\t/**\r\n\t * Configures the next search request that will be executed. This will also execute a search in response to\r\n\t * the next search request changing.\r\n\t * @param search The partial search request object. This will be merged with previous calls to `setSearch`.\r\n\t * @param doHistory Whether or not this search request will push a history entry into the browser. If\r\n\t * \t\t\t\t\tnot specified, the default is `true`.\r\n\t */\r\n\tfunction setSearch(pendingSearch: Partial<Request>, doHistory?: boolean): void {\r\n\t\tif (doHistory === undefined) {\r\n\t\t\tdoHistory = true;\r\n\t\t}\r\n\r\n\t\tsetStore(prevState => {\r\n\t\t\tconst newState = {\r\n\t\t\t\tpendingSearch: { ...prevState.pendingSearch, ...pendingSearch },\r\n\t\t\t\tdoHistory,\r\n\t\t\t};\r\n\t\t\tif (newState.pendingSearch.Keyword === '') {\r\n\t\t\t\tnewState.pendingSearch.Keyword = undefined;\r\n\t\t\t}\r\n\r\n\t\t\treturn newState;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the facet selections and search within configuration for the next search request. This will also\r\n\t * clear the page number of the next request to display the first page of results.\r\n\t * @param selections The facet selections to set.\r\n\t * @param searchWithin The search within value to set.\r\n\t */\r\n\tfunction setSearchSelections(selections?: FacetSelections, searchWithin?: string) {\r\n\t\tsetSearch({\r\n\t\t\tFacetSelections: selections,\r\n\t\t\tSearchWithin: searchWithin,\r\n\r\n\t\t\t// when we change facet selections, also clear the current page so that we navigate\r\n\t\t\t// back to the first page of results\r\n\t\t\tPageNo: undefined,\r\n\t\t});\r\n\t}\r\n\r\n\t// NOTE: It will return the difference from 1st array\r\n\t// i.e ['a', 'b', 'c'] - ['c', 'd', 'f'] => ['a', 'b']\r\n\tfunction differenceOfArrays(array1: string[], array2: string[]) {\r\n\t\treturn array1.filter(i => {\r\n\t\t\treturn array2.indexOf(i) < 0;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Toggles a facet value for the next search request that will be executed. Internally, this will call\r\n\t * `setSearch` to configure the next search with this selected facet.\r\n\t * @param facet The facet for which the value is being selected.\r\n\t * @param facetValue The facet value being selected.\r\n\t * @param negate  Whether or not this selection is considered a negation.\r\n\t */\r\n\tfunction toggleFacetValue(facet: Facet | string, facetValue: Value | string, negate?: boolean): void {\r\n\t\tif (negate === undefined) {\r\n\t\t\tnegate = false;\r\n\t\t}\r\n\r\n\t\tconst facetName: string = typeof facet === 'string' ? facet : facet.Name;\r\n\t\tconst facetField = typeof facet === 'string' ? facet : facet.selectionField;\r\n\r\n\t\tconst valueValue = typeof facetValue === 'string' ? facetValue : facetValue.Value;\r\n\t\tconst valueLabel = typeof facetValue === 'string' ? facetValue : facetValue.Label;\r\n\r\n\t\tif (!valueValue) {\r\n\t\t\tconsole.error(`Facet ${facetName} (${facetField}) has no facet value for ${valueLabel}`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet facetSelections = store.pendingSearch.FacetSelections;\r\n\r\n\t\t// handle `searchWithin` facet, which isn't a facet selection but is instead a field on the\r\n\t\t// search request.\r\n\t\tif (facetField === 'searchWithin') {\r\n\t\t\t// set the search within to the facet value provided\r\n\t\t\tsetSearchSelections(facetSelections, /* searchWithin */ valueValue);\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!facetSelections) {\r\n\t\t\tfacetSelections = {};\r\n\t\t}\r\n\r\n\t\tif (!facetSelections[facetField]) {\r\n\t\t\tfacetSelections[facetField] = [];\r\n\t\t}\r\n\r\n\t\tconst { state: selState, selectionIndex } = store.isFacetSelected(facet, facetValue);\r\n\t\tconst valuesToRemoved = [] as string[];\r\n\t\tconst items = (store.facetSelections[facetField] || {}).items || [];\r\n\t\titems.forEach((item: ClientSelectionValue) => {\r\n\t\t\tif (((item || {}).path || '').indexOf(valueValue) !== -1) {\r\n\t\t\t\tvaluesToRemoved.push(item.value);\r\n\t\t\t}\r\n\t\t});\r\n\t\tconst difference = differenceOfArrays(facetSelections[facetField] || [], valuesToRemoved || []);\r\n\t\tif (selState === FacetSelectionState.Selected || selState === FacetSelectionState.Negated) {\r\n\t\t\t// we're selecting this facet, and it's already selected\r\n\r\n\t\t\t// first, remove it from our selections\r\n\t\t\tfacetSelections[facetField]!.splice(selectionIndex!, 1);\r\n\r\n\t\t\tif (\r\n\t\t\t\t(selState === FacetSelectionState.Selected && negate) ||\r\n\t\t\t\t(selState === FacetSelectionState.Negated && !negate)\r\n\t\t\t) {\r\n\t\t\t\t// if we're toggling from negation to non-negation or vice versa, then push the new selection\r\n\t\t\t\tfacetSelections[facetField]!.push(negate ? `-${valueValue}` : valueValue);\r\n\t\t\t} else {\r\n\t\t\t\tif ((facet as Facet).FacetType === FacetType.NestedCheckbox) {\r\n\t\t\t\t\tfacetSelections[facetField] = difference;\r\n\t\t\t\t}\r\n\t\t\t\t// if we're not toggling the negation, nothing to do because we already removed the selection above\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// not selected, so we want to select it\r\n\t\t\tfacetSelections[facetField]!.push(negate ? `-${valueValue}` : valueValue);\r\n\t\t}\r\n\r\n\t\tif (facetSelections[facetField]!.length === 0) {\r\n\t\t\t// clean up any facets that no longer have any selected facet values\r\n\t\t\tdelete facetSelections[facetField];\r\n\t\t}\r\n\r\n\t\tsetSearchSelections(facetSelections, store.pendingSearch.SearchWithin);\r\n\t}\r\n\r\n\tfunction setFacetValues(facet: Facet | string, facetValues: Value[] | string[]): void {\r\n\t\tconst facetName = typeof facet === 'string' ? facet : facet.Name;\r\n\t\tconst facetField = typeof facet === 'string' ? facet : facet.selectionField;\r\n\r\n\t\tlet facetSelections = store.pendingSearch.FacetSelections;\r\n\r\n\t\tif (!facetSelections) {\r\n\t\t\tfacetSelections = {};\r\n\t\t}\r\n\r\n\t\tfacetSelections[facetField] = [];\r\n\r\n\t\tfor (const facetValue of facetValues) {\r\n\t\t\tconst valueValue = typeof facetValue === 'string' ? facetValue : facetValue.Value;\r\n\t\t\tconst valueLabel = typeof facetValue === 'string' ? facetValue : facetValue.Label;\r\n\r\n\t\t\tif (!valueValue) {\r\n\t\t\t\tconsole.error(`Facet ${facetName} (${facetField}) has no facet value for ${valueLabel}`);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfacetSelections[facetField]!.push(valueValue);\r\n\t\t}\r\n\r\n\t\tsetSearchSelections(facetSelections, store.pendingSearch.SearchWithin);\r\n\t}\r\n\r\n\t/**\r\n\t * Entirely clears all the values of the given facet from the current selection.\r\n\t * @param facet The facet to clear.\r\n\t */\r\n\tfunction clearFacet(facet: Facet | string) {\r\n\t\tconst facetField = typeof facet === 'string' ? facet : facet.selectionField;\r\n\r\n\t\tconst facetSelections = store.pendingSearch.FacetSelections;\r\n\r\n\t\t// handle `searchWithin` facet, which isn't a facet selection but is instead a field on the\r\n\t\t// search request.\r\n\t\tif (facetField === 'searchWithin') {\r\n\t\t\t// set searchWithin to undefined to clear it\r\n\t\t\tsetSearchSelections(facetSelections, /* searchWithin */ undefined);\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!facetSelections || !facetSelections[facetField]) {\r\n\t\t\t// if there are no facet selections or the facet isn't selected at all, there's nothing to clear\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tdelete facetSelections[facetField];\r\n\r\n\t\tsetSearchSelections(facetSelections, store.pendingSearch.SearchWithin);\r\n\t}\r\n\r\n\t/**\r\n\t * Clears a given facet value of the given facet from the current selection.\r\n\t * @param facet The facet to clear.\r\n\t * @param facetValue The facet value to clear.\r\n\t */\r\n\tfunction clearFacetValue(facet: Facet | string, facetValue: Value | string) {\r\n\t\tconst facetName = typeof facet === 'string' ? facet : facet.Name;\r\n\t\tconst facetField = typeof facet === 'string' ? facet : facet.selectionField;\r\n\r\n\t\tconst valueValue = typeof facetValue === 'string' ? facetValue : facetValue.Value;\r\n\t\tconst valueLabel = typeof facetValue === 'string' ? facetValue : facetValue.Label;\r\n\r\n\t\tif (!valueValue) {\r\n\t\t\tconsole.error(`Facet ${facetName} (${facetField}) has no facet value for ${valueLabel}`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// handle `searchWithin` facet, which isn't a facet selection but is instead a field on the\r\n\t\t// search request.\r\n\t\tif (facetField === 'searchWithin') {\r\n\t\t\t// set searchWithin to undefined to clear it\r\n\t\t\tsetSearchSelections(store.pendingSearch.FacetSelections, /* searchWithin */ undefined);\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst { state: selState, selectionIndex } = store.isFacetSelected(facet, facetValue);\r\n\r\n\t\tif (selState === FacetSelectionState.NotSelected) {\r\n\t\t\t// if there are no facet selections or the facet isn't selected at all, there's nothing to clear\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst facetSelections = store.pendingSearch.FacetSelections!;\r\n\r\n\t\t// remove it from the selections\r\n\t\tfacetSelections[facetField]!.splice(selectionIndex!, 1);\r\n\r\n\t\tif (facetSelections[facetField]!.length === 0) {\r\n\t\t\t// clean up any facets that no longer have any selected facet values\r\n\t\t\tdelete facetSelections[facetField];\r\n\t\t}\r\n\r\n\t\tsetSearchSelections(facetSelections, store.pendingSearch.SearchWithin);\r\n\t}\r\n\r\n\t/**\r\n\t * Clears all selected facets from the current selection.\r\n\t */\r\n\tfunction clearAllFacets(): void {\r\n\t\tsetSearchSelections(undefined, undefined);\r\n\t}\r\n\r\n\tfunction setItemsToCompare(resultItem: Result, isCheck: boolean): void {\r\n\t\tlet itemsArray = [...store.itemsToCompare];\r\n\t\tif (isCheck) {\r\n\t\t\t// append\r\n\t\t\titemsArray = [...itemsArray, ...[resultItem]];\r\n\t\t} else {\r\n\t\t\t// filter out\r\n\t\t\titemsArray = itemsArray.filter(item => item.DocId !== resultItem.DocId);\r\n\t\t}\r\n\t\t// setStore({ itemsToCompare: itemsArray });\r\n\t\tsetStore({\r\n\t\t\titemsToCompare: itemsArray,\r\n\t\t\titemsToCompareIds: itemsArray.map(item => item.DocId),\r\n\t\t});\r\n\t}\r\n\r\n\tfunction setComparedResults(data: Result[]): void {\r\n\t\tsetStore({\r\n\t\t\tcomparedResults: data,\r\n\t\t});\r\n\t}\r\n\r\n\tfunction setProductDetailsResults(data: Result): void {\r\n\t\tsetStore({\r\n\t\t\tproductDetails: data,\r\n\t\t});\r\n\t}\r\n\r\n\tfunction clearItemsToCompare() {\r\n\t\tsetStore({\r\n\t\t\titemsToCompare: [],\r\n\t\t\titemsToCompareIds: [],\r\n\t\t});\r\n\t}\r\n\r\n\tfunction getClientData() {\r\n\t\tlet visitId = getCookie('hawk_visit_id');\r\n\t\tlet visitorId = getCookie('hawk_visitor_id');\r\n\r\n\t\tif (!visitId) {\r\n\t\t\tsetCookie('hawk_visit_id', createGuid(), getVisitExpiry());\r\n\t\t\tvisitId = getCookie('hawk_visit_id');\r\n\t\t}\r\n\r\n\t\tif (!visitorId) {\r\n\t\t\tsetCookie('hawk_visitor_id', createGuid(), getVisitorExpiry());\r\n\t\t\tvisitorId = getCookie('hawk_visitor_id');\r\n\t\t}\r\n\r\n\t\tconst clientData: ClientData = {\r\n\t\t\tVisitorId: visitorId || '',\r\n\t\t\tVisitId: visitId || '',\r\n\t\t\tUserAgent: navigator.userAgent,\r\n\t\t\tPreviewBuckets:\r\n\t\t\t\tstore.searchResults && !config.disablePreviewBuckets\r\n\t\t\t\t\t? store.searchResults.VisitorTargets.map(v => v.Id)\r\n\t\t\t\t\t: [],\r\n\t\t};\r\n\r\n\t\tconst language = store.language;\r\n\r\n\t\tif (language) {\r\n\t\t\tclientData.Custom = {\r\n\t\t\t\tlanguage,\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn clientData;\r\n\t}\r\n\r\n\tfunction getInitialLanguage() {\r\n\t\tconst urlParams = new URLSearchParams(location.search);\r\n\t\tconst language = urlParams.get('language') || config.language;\r\n\t\treturn language;\r\n\t}\r\n\r\n\tconst actor: SearchActor = {\r\n\t\tsearch,\r\n\t\tsetSearch,\r\n\t\ttoggleFacetValue,\r\n\t\tsetFacetValues,\r\n\t\tclearFacet,\r\n\t\tclearFacetValue,\r\n\t\tclearAllFacets,\r\n\t\tsetItemsToCompare,\r\n\t\tsetComparedResults,\r\n\t\tclearItemsToCompare,\r\n\t\tgetComparedItems,\r\n\t\tpinItem,\r\n\t\tupdatePinOrder,\r\n\t\trebuildIndex,\r\n\t\tgetProductDetails,\r\n\t\tsetProductDetailsResults,\r\n\t\tsetStore,\r\n\t};\r\n\r\n\treturn [store, actor];\r\n}\r\n","import { useState, Dispatch } from 'react';\r\n\r\ntype SetStateAction<T> = Partial<T> | ((prevState: T) => Partial<T>);\r\n\r\nexport function useMergableState<T>(\r\n\tinitialValue: T,\r\n\ttypeConstructor: new (init: Partial<T>) => T\r\n): [T, Dispatch<SetStateAction<T>>] {\r\n\tconst [state, setState] = useState(new typeConstructor(initialValue));\r\n\r\n\tfunction setStateAndMerge(value: SetStateAction<T>) {\r\n\t\tif (typeof value === 'function') {\r\n\t\t\t// if we're being passed a function, we're setting state in the form of setState(prevState => ...).\r\n\r\n\t\t\tsetState(prevState => {\r\n\t\t\t\t// so we derive the new state from the previous state\r\n\t\t\t\tconst newState = value(prevState);\r\n\r\n\t\t\t\t// and then set the new merged state\r\n\t\t\t\treturn new typeConstructor({ ...prevState, ...newState });\r\n\t\t\t});\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// otherwise, the new state was simply passed in\r\n\t\tsetState(prevState => {\r\n\t\t\t// merge state together and set it\r\n\t\t\treturn new typeConstructor({ ...prevState, ...value });\r\n\t\t});\r\n\t}\r\n\r\n\treturn [state, setStateAndMerge];\r\n}\r\n","import { HawkContextValue } from './../components/StoreProvider';\r\n/**\r\n * Object containing all initialized stores\r\n */\r\nconst dataLayers = {};\r\n\r\n/**\r\n * All initialized configurations\r\n * Used for index name verification\r\n */\r\nconst configurations = {};\r\n\r\n/**\r\n * A method invoked at store updates that propagates the data between similar stores\r\n * Store matching is based on the unique identifier and the configuration index name\r\n */\r\nexport function updateBindedStores({ dataLayer, widgetId, store, actor, config }) {\r\n\tif (!dataLayers.hasOwnProperty(dataLayer)) {\r\n\t\tdataLayers[dataLayer] = {};\r\n\t}\r\n\r\n\tconst _ = require('lodash');\r\n\r\n\tdataLayers[dataLayer][widgetId] = { store, actor };\r\n\tconfigurations[widgetId] = config;\r\n\r\n\tfor (const [id, instance] of Object.entries(dataLayers[dataLayer])) {\r\n\t\tif (\r\n\t\t\tid !== widgetId &&\r\n\t\t\t(instance as HawkContextValue).actor &&\r\n\t\t\t!_.isEqual((instance as HawkContextValue).store.searchResults, store.searchResults) &&\r\n\t\t\tconfigurations[id].indexName === config.indexName\r\n\t\t) {\r\n\t\t\t(instance as HawkContextValue).actor.setStore(store);\r\n\t\t}\r\n\t}\r\n}\r\n","import React, { useContext, useEffect } from 'react';\r\n\r\nimport { SearchStore } from 'store/Store';\r\nimport { useHawkState, SearchActor } from '../store/HawkState';\r\nimport { Request } from 'models/Search';\r\nimport { useHawkConfig } from './ConfigProvider';\r\nimport { updateBindedStores } from 'util/WidgetBinding';\r\n\r\nconst HawkContext = React.createContext({} as HawkContextValue);\r\n\r\nexport interface HawkContextValue {\r\n\t/** The store of data used throughout the application. */\r\n\tstore: SearchStore;\r\n\t/**\r\n\t * An interface that allows actions to be performed on the store (such as executing searches,\r\n\t * changing pages, etc).\r\n\t */\r\n\tactor: SearchActor;\r\n}\r\n\r\nexport interface HawkStoreProviderProps {\r\n\t/** The initial search to perform when initializing the search components. */\r\n\tinitialSearch?: Partial<Request>;\r\n\tchildren: React.ReactNode;\r\n\twidgetId?: string;\r\n}\r\n\r\n/**\r\n * This component acts as the global store for the hawksearch application state. Only one instance of this component\r\n * should exist, and it should be the root level component.\r\n */\r\nfunction StoreProvider({ initialSearch, children, widgetId }: HawkStoreProviderProps) {\r\n\tconst [store, actor] = useHawkState(initialSearch);\r\n\tconst { config } = useHawkConfig();\r\n\tconst dataLayer = config.dataLayer;\r\n\r\n\tuseEffect(() => {\r\n\t\tif (dataLayer) {\r\n\t\t\tupdateBindedStores({ dataLayer, widgetId, store, actor, config });\r\n\t\t}\r\n\t}, [store.searchResults]);\r\n\r\n\treturn <HawkContext.Provider value={{ store, actor }}>{children}</HawkContext.Provider>;\r\n}\r\n\r\n/**\r\n * Retrieves the global hawk store for use within a component.\r\n */\r\nexport function useHawksearch() {\r\n\treturn useContext(HawkContext);\r\n}\r\n\r\nexport default StoreProvider;\r\n","enum E_T {\r\n\tpageLoad = 1,\r\n\tsearch = 2,\r\n\tclick = 3,\r\n\taddToCart = 4,\r\n\trate = 5,\r\n\tsale = 6,\r\n\tbannerClick = 7,\r\n\tbannerImpression = 8,\r\n\trecommendationClick = 10,\r\n\tautoCompleteClick = 11,\r\n\tadd2CartMultiple = 14,\r\n}\r\n\r\nenum P_T {\r\n\titem = 1,\r\n\tlanding = 2,\r\n\tcart = 3,\r\n\torder = 4,\r\n\tcustom = 5,\r\n}\r\n\r\nexport enum SuggestType {\r\n\tPopularSearches = 1,\r\n\tTopCategories = 2,\r\n\tTopProductMatches = 3,\r\n\tTopContentMatches = 4,\r\n}\r\n\r\nexport enum SearchType {\r\n\tInitial = 1,\r\n\tRefinement = 2,\r\n}\r\n\r\nconst TrackEventNameMapping = {\r\n\tClick: 'click',\r\n\tCart: '',\r\n\tCopyRequestTracking: '',\r\n\tRequestTracking: '',\r\n\tSearch: 'searchtracking',\r\n\tSale: 'sale',\r\n\tRecommendationImpression: '',\r\n\tRecommendationClick: 'recommendationclick',\r\n\tRate: 'rate',\r\n\tPageLoad: 'pageload',\r\n\tIdentify: '',\r\n\tBannerImpression: 'bannerimpression',\r\n\tBannerClick: 'bannerclick',\r\n\tAutocompleteClick: 'autocompleteclick',\r\n\tAdd2CartMultiple: 'add2cartmultiple',\r\n\tAdd2Cart: 'add2cart',\r\n};\r\n\r\nconst AvailableEvents = [\r\n\t'click',\r\n\t'pageload',\r\n\t'searchtracking',\r\n\t'autocompleteclick',\r\n\t'bannerclick',\r\n\t'bannerimpression',\r\n\t'sale',\r\n\t'add2cart',\r\n];\r\n\r\nclass TrackingEvent {\r\n\tprivate static instance: TrackingEvent;\r\n\tprivate trackingURL: string;\r\n\tprivate clientGUID: string;\r\n\tprivate trackConfig: string[];\r\n\tprivate language: string;\r\n\r\n\t/**\r\n\t * The Singleton's constructor should always be private to prevent direct\r\n\t * construction calls with the `new` operator.\r\n\t */\r\n\tprivate constructor() {}\r\n\r\n\t/**\r\n\t * The static method that controls the access to the singleton instance.\r\n\t *\r\n\t * This implementation let you subclass the Singleton class while keeping\r\n\t * just one instance of each subclass around.\r\n\t */\r\n\tpublic static getInstance(url?: string): TrackingEvent {\r\n\t\tif (!TrackingEvent.instance) {\r\n\t\t\tTrackingEvent.instance = new TrackingEvent();\r\n\t\t}\r\n\r\n\t\treturn TrackingEvent.instance;\r\n\t}\r\n\r\n\t/**\r\n\t * Finally, any singleton should define some business logic, which can be\r\n\t * executed on its instance.\r\n\t */\r\n\r\n\tpublic setTrackingURL(url: string) {\r\n\t\tthis.trackingURL = url;\r\n\t}\r\n\r\n\tpublic getTrackingURL() {\r\n\t\treturn this.trackingURL;\r\n\t}\r\n\r\n\tpublic setClientGUID(guid: string) {\r\n\t\tthis.clientGUID = guid;\r\n\t}\r\n\r\n\tpublic getClientGUID() {\r\n\t\treturn this.getClientGUID;\r\n\t}\r\n\r\n\tpublic getVisitorExpiry() {\r\n\t\tconst d = new Date();\r\n\t\t// 1 year\r\n\t\td.setTime(d.getTime() + 360 * 24 * 60 * 60 * 1000);\r\n\t\treturn d.toUTCString();\r\n\t}\r\n\r\n\tprivate getVisitExpiry() {\r\n\t\tconst d = new Date();\r\n\t\t// 4 hours\r\n\t\td.setTime(d.getTime() + 4 * 60 * 60 * 1000);\r\n\t\treturn d.toUTCString();\r\n\t}\r\n\r\n\tpublic setLanguage(language) {\r\n\t\tthis.language = language;\r\n\t}\r\n\r\n\tpublic getLanguageParams() {\r\n\t\tlet params = {};\r\n\r\n\t\tif (this.language) {\r\n\t\t\tparams = {\r\n\t\t\t\tCustomDictionary: {\r\n\t\t\t\t\tlanguage: this.language,\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn params;\r\n\t}\r\n\r\n\tpublic createGuid() {\r\n\t\tconst s: any[] = [];\r\n\t\tconst hexDigits = '0123456789abcdef';\r\n\t\tfor (let i = 0; i < 36; i++) {\r\n\t\t\ts[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\r\n\t\t}\r\n\t\ts[14] = '4'; // bits 12-15 of the time_hi_and_version field to 0010\r\n\t\t// tslint:disable-next-line: no-bitwise\r\n\t\ts[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01\r\n\t\ts[8] = s[13] = s[18] = s[23] = '-';\r\n\r\n\t\tconst uuid = s.join('');\r\n\t\treturn uuid;\r\n\t}\r\n\r\n\tpublic setTrackConfig(value: any) {\r\n\t\tthis.trackConfig = value;\r\n\t}\r\n\r\n\tpublic getCookie(name) {\r\n\t\tconst nameEQ = name + '=';\r\n\t\tconst ca = document.cookie.split(';');\r\n\t\t// tslint:disable-next-line: prefer-for-of\r\n\t\tfor (let i = 0; i < ca.length; i++) {\r\n\t\t\tlet c = ca[i];\r\n\t\t\twhile (c.charAt(0) === ' ') {\r\n\t\t\t\tc = c.substring(1, c.length);\r\n\t\t\t}\r\n\t\t\tif (c.indexOf(nameEQ) === 0) {\r\n\t\t\t\treturn c.substring(nameEQ.length, c.length);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tpublic setCookie(name, value, expiry?) {\r\n\t\tlet expires;\r\n\t\tif (expiry) {\r\n\t\t\texpires = '; expires=' + expiry;\r\n\t\t} else {\r\n\t\t\texpires = '';\r\n\t\t}\r\n\t\tdocument.cookie = name + '=' + value + expires + '; path=/';\r\n\t}\r\n\r\n\tprivate writePageLoad(pageType) {\r\n\t\tconst c = document.documentElement;\r\n\t\tconst pl = {\r\n\t\t\tEventType: E_T.pageLoad,\r\n\t\t\tEventData: btoa(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\tPageTypeId: P_T[pageType],\r\n\t\t\t\t\tRequestPath: window.location.pathname,\r\n\t\t\t\t\tQs: window.location.search,\r\n\t\t\t\t\tViewportHeight: c.clientHeight,\r\n\t\t\t\t\tViewportWidth: c.clientWidth,\r\n\t\t\t\t})\r\n\t\t\t),\r\n\t\t};\r\n\t\tthis.mr(pl);\r\n\t}\r\n\r\n\tprivate writeSearchTracking(trackingId, typeId, keyword) {\r\n\t\tconst guid = this.createGuid();\r\n\r\n\t\tif (typeId === SearchType.Initial) {\r\n\t\t\tthis.setCookie('hawk_query_id', guid);\r\n\t\t}\r\n\r\n\t\tconst queryId = this.getCookie('hawk_query_id') || guid;\r\n\r\n\t\tconst c = document.documentElement;\r\n\t\tconst pl = {\r\n\t\t\tEventType: E_T.search,\r\n\t\t\tEventData: btoa(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\tQueryId: queryId,\r\n\t\t\t\t\tTrackingId: trackingId,\r\n\t\t\t\t\tTypeId: typeId,\r\n\t\t\t\t\tViewportHeight: c.clientHeight,\r\n\t\t\t\t\tViewportWidth: c.clientWidth,\r\n\t\t\t\t\tkeyword,\r\n\t\t\t\t})\r\n\t\t\t),\r\n\t\t};\r\n\t\tthis.mr(pl);\r\n\t}\r\n\r\n\tprivate writeClick(event, uniqueId, trackingId, url) {\r\n\t\tconst c = document.documentElement;\r\n\t\tconst pl = {\r\n\t\t\tEventType: E_T.click,\r\n\t\t\tEventData: btoa(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\tUrl: url,\r\n\t\t\t\t\tQs: window.location.search,\r\n\t\t\t\t\tRequestPath: window.location.pathname,\r\n\t\t\t\t\tTrackingId: trackingId,\r\n\t\t\t\t\tUniqueId: uniqueId,\r\n\t\t\t\t\tViewportHeight: c.clientHeight,\r\n\t\t\t\t\tViewportWidth: c.clientWidth,\r\n\t\t\t\t\tScrollX: window.scrollX,\r\n\t\t\t\t\tScrollY: window.scrollY,\r\n\t\t\t\t\tMouseX: event.clientX,\r\n\t\t\t\t\tMouseY: event.clientY,\r\n\t\t\t\t})\r\n\t\t\t),\r\n\t\t};\r\n\t\tthis.mr(pl);\r\n\t}\r\n\r\n\tprivate writeBannerClick(bannerId, campaignId, trackingId) {\r\n\t\tconst pl = {\r\n\t\t\tEventType: E_T.bannerClick,\r\n\t\t\tEventData: btoa(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\tCampaignId: campaignId,\r\n\t\t\t\t\tBannerId: bannerId,\r\n\t\t\t\t\tTrackingId: trackingId,\r\n\t\t\t\t})\r\n\t\t\t),\r\n\t\t};\r\n\t\tthis.mr(pl);\r\n\t}\r\n\r\n\tprivate writeBannerImpression(bannerId, campaignId, trackingId) {\r\n\t\tconst pl = {\r\n\t\t\tEventType: E_T.bannerImpression,\r\n\t\t\tEventData: btoa(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\tCampaignId: campaignId,\r\n\t\t\t\t\tBannerId: bannerId,\r\n\t\t\t\t\tTrackingId: trackingId,\r\n\t\t\t\t})\r\n\t\t\t),\r\n\t\t};\r\n\t\tthis.mr(pl);\r\n\t}\r\n\tprivate writeSale(orderNo, itemList, total, subTotal, tax, currency) {\r\n\t\tconst pl = {\r\n\t\t\tEventType: E_T.sale,\r\n\t\t\tEventData: btoa(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\tOrderNo: orderNo,\r\n\t\t\t\t\tItemList: itemList,\r\n\t\t\t\t\tTotal: total,\r\n\t\t\t\t\tTax: tax,\r\n\t\t\t\t\tSubTotal: subTotal,\r\n\t\t\t\t\tCurrency: currency,\r\n\t\t\t\t})\r\n\t\t\t),\r\n\t\t};\r\n\t\tthis.mr(pl);\r\n\t}\r\n\tprivate writeAdd2Cart(uniqueId, price, quantity, currency) {\r\n\t\tconst pl = {\r\n\t\t\tEventType: E_T.addToCart,\r\n\t\t\tEventData: btoa(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\tUniqueId: uniqueId,\r\n\t\t\t\t\tQuantity: quantity,\r\n\t\t\t\t\tPrice: price,\r\n\t\t\t\t\tCurrency: currency,\r\n\t\t\t\t})\r\n\t\t\t),\r\n\t\t};\r\n\t\tthis.mr(pl);\r\n\t}\r\n\r\n\tprivate writeAdd2CartMultiple(args) {\r\n\t\tconst pl = {\r\n\t\t\tEventType: E_T.add2CartMultiple,\r\n\t\t\tEventData: btoa(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\tItemsList: args,\r\n\t\t\t\t})\r\n\t\t\t),\r\n\t\t};\r\n\t\tthis.mr(pl);\r\n\t}\r\n\r\n\tprivate writeRate(uniqueId, value) {\r\n\t\tconst pl = {\r\n\t\t\tEventType: E_T.rate,\r\n\t\t\tEventData: btoa(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\tUniqueId: uniqueId,\r\n\t\t\t\t\tValue: value,\r\n\t\t\t\t})\r\n\t\t\t),\r\n\t\t};\r\n\t\tthis.mr(pl);\r\n\t}\r\n\r\n\tprivate writeRecommendationClick(widgetGuid, uniqueId, itemIndex, requestId) {\r\n\t\tconst pl = {\r\n\t\t\tEventType: E_T.recommendationClick,\r\n\t\t\tEventData: btoa(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\tItemIndex: itemIndex,\r\n\t\t\t\t\tRequestId: requestId,\r\n\t\t\t\t\tUniqueId: uniqueId,\r\n\t\t\t\t\tWidgetGuid: widgetGuid,\r\n\t\t\t\t})\r\n\t\t\t),\r\n\t\t};\r\n\t\tthis.mr(pl);\r\n\t}\r\n\r\n\tprivate writeAutoCompleteClick(keyword, suggestType, name, url) {\r\n\t\tconst pl = {\r\n\t\t\tEventType: E_T.autoCompleteClick,\r\n\t\t\tEventData: btoa(\r\n\t\t\t\tJSON.stringify({\r\n\t\t\t\t\tKeyword: keyword,\r\n\t\t\t\t\tName: name,\r\n\t\t\t\t\tSuggestType: suggestType,\r\n\t\t\t\t\tUrl: url,\r\n\t\t\t\t})\r\n\t\t\t),\r\n\t\t};\r\n\t\tthis.mr(pl);\r\n\t}\r\n\r\n\tprivate mr(data) {\r\n\t\tlet visitId = this.getCookie('hawk_visit_id');\r\n\t\tlet visitorId = this.getCookie('hawk_visitor_id');\r\n\t\tconst languageParams = this.getLanguageParams();\r\n\r\n\t\tif (!visitId) {\r\n\t\t\tthis.setCookie('hawk_visit_id', this.createGuid(), this.getVisitExpiry());\r\n\t\t\tvisitId = this.getCookie('hawk_visit_id');\r\n\t\t}\r\n\r\n\t\tif (!visitorId) {\r\n\t\t\tthis.setCookie('hawk_visitor_id', this.createGuid(), this.getVisitorExpiry());\r\n\t\t\tvisitorId = this.getCookie('hawk_visitor_id');\r\n\t\t}\r\n\r\n\t\tconst pl = Object.assign(\r\n\t\t\t{\r\n\t\t\t\tClientGuid: this.clientGUID,\r\n\t\t\t\tVisitId: visitId,\r\n\t\t\t\tVisitorId: visitorId,\r\n\t\t\t\t// TrackingProperties: hs.Context,\r\n\t\t\t\t// CustomDictionary: hs.Context.Custom,\r\n\t\t\t},\r\n\t\t\tlanguageParams,\r\n\t\t\tdata\r\n\t\t);\r\n\r\n\t\tfetch(this.trackingURL, {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: { 'Content-Type': 'application/json' },\r\n\t\t\tbody: JSON.stringify(pl),\r\n\t\t}).catch(error => {\r\n\t\t\tconsole.error('Error:', error);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic track(eventName, args) {\r\n\t\tif (!this.trackingURL || !this.clientGUID || !this.isEnabled(eventName)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tswitch (eventName.toLowerCase()) {\r\n\t\t\tcase 'pageload':\r\n\t\t\t\t// HawkSearch.Context.add(\"uniqueid\", \"123456789\");\r\n\t\t\t\treturn this.writePageLoad(args.pageType);\r\n\t\t\tcase 'searchtracking':\r\n\t\t\t\t// HawkSearch.Tracking.track(\"searchtracking\", {trackingId:\"a9bd6e50-e434-45b9-9f66-489eca07ad0a\", typeId: HawkSearch.Tracking.SearchType.Initial});\r\n\t\t\t\t// HawkSearch.Tracking.track(\"searchtracking\", {trackingId:\"a9bd6e50-e434-45b9-9f66-489eca07ad0a\", typeId: HawkSearch.Tracking.SearchType.Refinement});\r\n\t\t\t\treturn this.writeSearchTracking(args.trackingId, args.typeId, args.keyword); // CHANGED\r\n\t\t\tcase 'click':\r\n\t\t\t\t// HawkSearch.Tracking.track('click',{event: e, uniqueId: \"33333\", trackingId: \"75a0801a-a93c-4bcb-81f1-f4b011f616e3\"});\r\n\t\t\t\treturn this.writeClick(args.event, args.uniqueId, args.trackingId, args.url); // CHANGED\r\n\t\t\tcase 'bannerclick':\r\n\t\t\t\t// HawkSearch.Tracking.track('bannerclick',{bannerId: 1, campaignId: 2, trackingId:\"2d652a1e-2e05-4414-9d76-51979109f724\"});\r\n\t\t\t\treturn this.writeBannerClick(args.bannerId, args.campaignId, args.trackingId); // CHANGED\r\n\t\t\tcase 'bannerimpression':\r\n\t\t\t\t// HawkSearch.Tracking.track('bannerimpression',{bannerId: \"2\", campaignId: \"2\", trackingId:\"2d652a1e-2e05-4414-9d76-51979109f724\"});\r\n\t\t\t\treturn this.writeBannerImpression(args.bannerId, args.campaignId, args.trackingId); // CHANGED\r\n\t\t\tcase 'sale':\r\n\t\t\t\t// HawkSearch.Tracking.track('sale', {orderNo: 'order_123',itemList: [{uniqueid: '123456789', itemPrice: 12.99, quantity: 2}], total: 25.98, subTotal: 22, tax: 3.98, currency: 'USD'});\r\n\t\t\t\treturn this.writeSale(args.orderNo, args.itemList, args.total, args.subTotal, args.tax, args.currency);\r\n\t\t\tcase 'add2cart':\r\n\t\t\t\t// HawkSearch.Tracking.track('add2cart',{uniqueId: '123456789', price: 19.99, quantity: 3, currency: 'USD'});\r\n\t\t\t\treturn this.writeAdd2Cart(args.uniqueId, args.price, args.quantity, args.currency);\r\n\t\t\tcase 'add2cartmultiple':\r\n\t\t\t\t// HawkSearch.Tracking.track('add2cartmultiple', [{uniqueId: '123456789',price: 15.97,quantity: 1,currency: 'USD'},{uniqueId: '987465321', price: 18.00, quantity: 1, currency: 'USD'}]);\r\n\t\t\t\treturn this.writeAdd2CartMultiple(args);\r\n\t\t\tcase 'rate':\r\n\t\t\t\t// HawkSearch.Tracking.track('rate', {uniqueId: '123456789',value: 3.00});\r\n\t\t\t\treturn this.writeRate(args.uniqueId, args.value);\r\n\t\t\tcase 'recommendationclick':\r\n\t\t\t\t// HawkSearch.Tracking.track('recommendationclick',{uniqueId: \"223222\", itemIndex: \"222\", widgetGuid:\"2d652a1e-2e05-4414-9d76-51979109f724\", requestId:\"2d652a1e-2e05-4414-9d76-51979109f724\"});\r\n\t\t\t\treturn this.writeRecommendationClick(args.widgetGuid, args.uniqueId, args.itemIndex, args.requestId);\r\n\t\t\tcase 'autocompleteclick':\r\n\t\t\t\t// HawkSearch.Tracking.track('autocompleteclick',{keyword: \"test\", suggestType: HawkSearch.Tracking.SuggestType.PopularSearches, name:\"tester\", url:\"/test\"});\r\n\t\t\t\treturn this.writeAutoCompleteClick(args.keyword, args.suggestType, args.name, args.url); // CHANGED\r\n\t\t}\r\n\t}\r\n\r\n\tpublic isEnabled(eventName) {\r\n\t\treturn Boolean(\r\n\t\t\tAvailableEvents.includes(eventName) &&\r\n\t\t\t\t(!this.trackConfig || this.trackConfig.find(e => TrackEventNameMapping[e] === eventName))\r\n\t\t);\r\n\t}\r\n}\r\n\r\n// export TrackingEvent.getInstance();\r\nexport default TrackingEvent.getInstance();\r\n","import { ClientData } from 'models/Search';\r\n\r\nexport class Request {\r\n\t/**\r\n\t * API Client Guid. Usually comes from the \"Tracking Key\" in the \"Account Info\" section of the hawk dashboard.\r\n\t */\r\n\tpublic ClientGuid: string;\r\n\r\n\t/**\r\n\t * Search term entered by a user. If keyword is not included, all items configured to be returned will be\r\n\t * returned. When this parameter is populated, the results will be matched against this term by the search\r\n\t * engine.\r\n\t */\r\n\tpublic Keyword?: string;\r\n\r\n\t/**\r\n\t * This is used by the Hawksearch Preview to set to true will display elements in a preview mode.\r\n\t *\r\n\t * You can use this if you desire additional score information returned.\r\n\t */\r\n\tpublic IsInPreview?: boolean;\r\n\r\n\tpublic Type?: 'Category' | 'Product' | 'Content' | 'Popular';\r\n\r\n\t/** The maximum number of results to return for selected @see Type */\r\n\tpublic ProductCount?: number;\r\n\r\n\t/** Flag set to true will display also full Document object from Elastic for Products and Content suggestions. */\r\n\tpublic DisplayFullResponse?: boolean;\r\n\r\n\t/**\r\n\t * An array of field names that will be returned in the response. If provided, only the fields listed will\r\n\t * be returned. If no FieldOverride value is sent, the Workbench configuration will be used.\r\n\t *\r\n\t * If the Skip from Custom flag is turned “on” for a field, it will not be returned in the response, even if\r\n\t * set in the FieldOverride parameter.\r\n\t */\r\n\tpublic FieldOverride?: string[];\r\n\r\n\t/** Client data. */\r\n\tpublic ClientData?: ClientData;\r\n\r\n\tpublic IndexName?: string;\r\n\r\n\tpublic FacetSelections?: { [key: string]: string[] | undefined };\r\n}\r\n","import { Suggestion, SuggestionType, SuggestionStrategy } from './Suggestion';\r\nimport { ControllerStateAndHelpers } from 'downshift';\r\n\r\nexport class Category extends Suggestion {\r\n\t/** Display name of category (example: Men &raquo; Jackets). */\r\n\tpublic Value: string;\r\n\t/**\r\n\t * URL for displaying contents of the category, ex:\r\n\t * http://dev.hawksearch.net/sites/elasticdemo?department_nest=Jackets_4\r\n\t */\r\n\tpublic Url: string;\r\n\r\n\tpublic constructor(init: Category) {\r\n\t\tsuper(SuggestionType.Category);\r\n\t\tObject.assign(this, init);\r\n\t}\r\n}\r\n\r\nexport class CategoryStrategy implements SuggestionStrategy {\r\n\tpublic handleItemChange(item: Category, downshift: ControllerStateAndHelpers<Category>): void {\r\n\t\tlocation.assign(item.Url);\r\n\t}\r\n\r\n\tpublic toString(item: Category): string {\r\n\t\treturn this ? item.Value : '';\r\n\t}\r\n}\r\n","import { Result } from 'models/Search';\r\nimport { Suggestion, SuggestionStrategy, SuggestionType } from './Suggestion';\r\nimport { ControllerStateAndHelpers } from 'downshift';\r\nimport { useHawksearch } from 'components/StoreProvider';\r\n\r\nexport class Product extends Suggestion {\r\n\t/** Name of the item (if applicable). */\r\n\tpublic ProductName: string;\r\n\r\n\t/* Sku of the item (if applicable). */\r\n\tpublic Sku: string;\r\n\r\n\t/** URL of image of the item (if applicable). */\r\n\tpublic Thumb: string;\r\n\r\n\t/** URL of product page (if applicable). */\r\n\tpublic Url: string;\r\n\r\n\t/** HTML to display the item in autocomplete. */\r\n\tpublic Html: string;\r\n\r\n\t/**\r\n\t * This will only be populated if the request parameter @see Request.DisplayFullResponse is sent\r\n\t * as `true`.\r\n\t */\r\n\tpublic Results: Result;\r\n\r\n\tpublic constructor(init: Product) {\r\n\t\tsuper(SuggestionType.Product);\r\n\t\tObject.assign(this, init);\r\n\t}\r\n}\r\n\r\nexport class ProductStrategy implements SuggestionStrategy {\r\n\tpublic handleItemChange(item: Product, downshift: ControllerStateAndHelpers<Product>): void {\r\n\t\tlocation.assign(item.Url);\r\n\t}\r\n\r\n\tpublic toString(item: Product): string {\r\n\t\treturn this ? item.ProductName : '';\r\n\t}\r\n}\r\n","import { Result } from 'models/Search';\r\nimport { SuggestionType, Suggestion, SuggestionStrategy } from './Suggestion';\r\nimport { ControllerStateAndHelpers } from 'downshift';\r\n\r\nexport class Content extends Suggestion {\r\n\t/** Display label for the content item in Autocomplete. */\r\n\tpublic Value: string;\r\n\r\n\t/** The URL for the link created. */\r\n\tpublic Url: string;\r\n\r\n\t/** The display label in HTML format, if applicable. */\r\n\tpublic Html: string;\r\n\r\n\tpublic Results: Result;\r\n\r\n\tpublic constructor(init: Content) {\r\n\t\tsuper(SuggestionType.Content);\r\n\t\tObject.assign(this, init);\r\n\t}\r\n}\r\n\r\nexport class ContentStrategy implements SuggestionStrategy {\r\n\tpublic handleItemChange(item: Content, downshift: ControllerStateAndHelpers<Content>): void {\r\n\t\tlocation.assign(item.Url);\r\n\t}\r\n\r\n\tpublic toString(item: Content): string {\r\n\t\treturn this ? item.Value : '';\r\n\t}\r\n}\r\n","import { SuggestionType, Suggestion, SuggestionStrategy } from './Suggestion';\r\nimport { ControllerStateAndHelpers } from 'downshift';\r\n\r\nexport class Popular extends Suggestion {\r\n\t/** Display label for the popular search term. */\r\n\tpublic Value: string;\r\n\r\n\t/** The URL for the link created. */\r\n\tpublic Url: string;\r\n\r\n\tpublic constructor(init: Popular) {\r\n\t\tsuper(SuggestionType.Popular);\r\n\t\tObject.assign(this, init);\r\n\t}\r\n}\r\n\r\nexport class PopularStrategy implements SuggestionStrategy {\r\n\tpublic handleItemChange(item: Popular, downshift: ControllerStateAndHelpers<Popular>): void {\r\n\t\tlocation.assign(item.Url);\r\n\t}\r\n\r\n\tpublic toString(item: Popular): string {\r\n\t\treturn this ? item.Value : '';\r\n\t}\r\n}\r\n","import { Category } from './Category';\r\nimport { Product } from './Product';\r\nimport { Content } from './Content';\r\nimport { Popular } from './Popular';\r\n\r\nexport class Response {\r\n\t/** Number of products that would be in search results if search was executed. */\r\n\tpublic Count: number;\r\n\t/** Number of content items that would be in search results if search was executed.  */\r\n\tpublic ContentCount: number;\r\n\r\n\t/**\r\n\t * Pairs of display values and URLs for matching category names.  The number of categories returned\r\n\t * is configured in the Hawksearch Workbench unless overridden by the request parameters.\r\n\t */\r\n\tpublic Categories: Category[];\r\n\r\n\tpublic Products: Product[];\r\n\r\n\t/**\r\n\t * A set of objects for each content item returned. The number returned is configured in the\r\n\t * Hawksearch Workbench > Keyword Search > Auto-complete > Update Top Content.\r\n\t */\r\n\tpublic Content: Content[];\r\n\r\n\t/**\r\n\t * A set of Value and Url for each popular search term. The definition of Popular can be defined in\r\n\t * the Hawksearch Workbench > Keyword Search > Auto-complete > Update Popular Searches.\r\n\t */\r\n\tpublic Popular: Popular[];\r\n\r\n\t/** Search website URL to be used to complete links. */\r\n\tpublic SearchWebsiteUrl: string;\r\n\r\n\t/** The name of the parameter used to pass the keyword entered by user. */\r\n\tpublic KeywordField: string;\r\n\r\n\t/**\r\n\t * Will be included in the response if there are results to display. The `CategoryHeading` contains\r\n\t * the text to display above the list of categories to display in Autocomplete.\r\n\t */\r\n\tpublic CategoryHeading?: string;\r\n\r\n\t/**\r\n\t * Will be included in the response if there are results to display. The `ContentHeading` contains\r\n\t * the text to display above the list of content items to display in Autocomplete.\r\n\t */\r\n\tpublic ContentHeading?: string;\r\n\r\n\t/**\r\n\t * Will be included in the response if there are results to display. The `ProductHeading` contains\r\n\t * the text to display above the list of products to display in Autocomplete.\r\n\t */\r\n\tpublic ProductHeading?: string;\r\n\r\n\t/**\r\n\t * Will be included in the response if there are results to display. The `PopularHeading` contains\r\n\t * the text to display above the list of popular search terms to display in Autocomplete.\r\n\t */\r\n\tpublic PopularHeading?: string;\r\n\r\n\t/**\r\n\t * Will be included in the response if there are results to display. The `ViewAllButtonLabel` contains\r\n\t * the text to display for the link to return all results from searching with the term entered.\r\n\t */\r\n\tpublic ViewAllButtonLabel?: string;\r\n\r\n\tpublic constructor(init: Response) {\r\n\t\tObject.assign(this, init);\r\n\r\n\t\tthis.Categories = init.Categories.map(r => new Category(r));\r\n\t\tthis.Products = init.Products.map(r => new Product(r));\r\n\t\tthis.Popular = init.Popular.map(r => new Popular(r));\r\n\t\tthis.Content = init.Content.map(r => new Content(r));\r\n\t}\r\n}\r\n\r\nexport interface ResponseProps {\r\n\tCount: number;\r\n\tContentCount: number;\r\n\tCategories: Category[];\r\n\tProducts: Product[];\r\n\tContent: Content[];\r\n\tPopular: Popular[];\r\n\tSearchWebsiteUrl: string;\r\n\tKeywordField: string;\r\n\tCategoryHeading?: string;\r\n\tContentHeading?: string;\r\n\tProductHeading?: string;\r\n\tPopularHeading?: string;\r\n\tViewAllButtonLabel?: string;\r\n}\r\n","class AuthToken {\r\n\tprivate static instance: AuthToken;\r\n\tprivate refreshToken: string;\r\n\tprivate accessToken: string;\r\n\r\n\t/**\r\n\t * The Singleton's constructor should always be private to prevent direct\r\n\t * construction calls with the `new` operator.\r\n\t */\r\n\tprivate constructor() {}\r\n\r\n\t/**\r\n\t * The static method that controls the access to the singleton instance.\r\n\t *\r\n\t * This implementation let you subclass the Singleton class while keeping\r\n\t * just one instance of each subclass around.\r\n\t */\r\n\tpublic static getInstance(url?: string): AuthToken {\r\n\t\tif (!AuthToken.instance) {\r\n\t\t\tAuthToken.instance = new AuthToken();\r\n\t\t}\r\n\r\n\t\treturn AuthToken.instance;\r\n\t}\r\n\r\n\tpublic setTokens(accessToken: string, refreshToken: string) {\r\n\t\tthis.refreshToken = refreshToken;\r\n\t\tthis.accessToken = accessToken;\r\n\t}\r\n\r\n\tpublic getTokens() {\r\n\t\treturn {\r\n\t\t\trefreshToken: this.refreshToken,\r\n\t\t\taccessToken: this.accessToken,\r\n\t\t};\r\n\t}\r\n}\r\n\r\nexport default AuthToken.getInstance();\r\n","export enum ContentType {\r\n\tImage = 'image',\r\n\tWidget = 'widget',\r\n\tFeatured = 'featured',\r\n\tCustom = 'custom',\r\n\tLandingPage = 'landingPage',\r\n}\r\n","var map = {\n\t\"./af\": 93,\n\t\"./af.js\": 93,\n\t\"./ar\": 94,\n\t\"./ar-dz\": 95,\n\t\"./ar-dz.js\": 95,\n\t\"./ar-kw\": 96,\n\t\"./ar-kw.js\": 96,\n\t\"./ar-ly\": 97,\n\t\"./ar-ly.js\": 97,\n\t\"./ar-ma\": 98,\n\t\"./ar-ma.js\": 98,\n\t\"./ar-sa\": 99,\n\t\"./ar-sa.js\": 99,\n\t\"./ar-tn\": 100,\n\t\"./ar-tn.js\": 100,\n\t\"./ar.js\": 94,\n\t\"./az\": 101,\n\t\"./az.js\": 101,\n\t\"./be\": 102,\n\t\"./be.js\": 102,\n\t\"./bg\": 103,\n\t\"./bg.js\": 103,\n\t\"./bm\": 104,\n\t\"./bm.js\": 104,\n\t\"./bn\": 105,\n\t\"./bn-bd\": 106,\n\t\"./bn-bd.js\": 106,\n\t\"./bn.js\": 105,\n\t\"./bo\": 107,\n\t\"./bo.js\": 107,\n\t\"./br\": 108,\n\t\"./br.js\": 108,\n\t\"./bs\": 109,\n\t\"./bs.js\": 109,\n\t\"./ca\": 110,\n\t\"./ca.js\": 110,\n\t\"./cs\": 111,\n\t\"./cs.js\": 111,\n\t\"./cv\": 112,\n\t\"./cv.js\": 112,\n\t\"./cy\": 113,\n\t\"./cy.js\": 113,\n\t\"./da\": 114,\n\t\"./da.js\": 114,\n\t\"./de\": 115,\n\t\"./de-at\": 116,\n\t\"./de-at.js\": 116,\n\t\"./de-ch\": 117,\n\t\"./de-ch.js\": 117,\n\t\"./de.js\": 115,\n\t\"./dv\": 118,\n\t\"./dv.js\": 118,\n\t\"./el\": 119,\n\t\"./el.js\": 119,\n\t\"./en-au\": 120,\n\t\"./en-au.js\": 120,\n\t\"./en-ca\": 121,\n\t\"./en-ca.js\": 121,\n\t\"./en-gb\": 122,\n\t\"./en-gb.js\": 122,\n\t\"./en-ie\": 123,\n\t\"./en-ie.js\": 123,\n\t\"./en-il\": 124,\n\t\"./en-il.js\": 124,\n\t\"./en-in\": 125,\n\t\"./en-in.js\": 125,\n\t\"./en-nz\": 126,\n\t\"./en-nz.js\": 126,\n\t\"./en-sg\": 127,\n\t\"./en-sg.js\": 127,\n\t\"./eo\": 128,\n\t\"./eo.js\": 128,\n\t\"./es\": 129,\n\t\"./es-do\": 130,\n\t\"./es-do.js\": 130,\n\t\"./es-mx\": 131,\n\t\"./es-mx.js\": 131,\n\t\"./es-us\": 132,\n\t\"./es-us.js\": 132,\n\t\"./es.js\": 129,\n\t\"./et\": 133,\n\t\"./et.js\": 133,\n\t\"./eu\": 134,\n\t\"./eu.js\": 134,\n\t\"./fa\": 135,\n\t\"./fa.js\": 135,\n\t\"./fi\": 136,\n\t\"./fi.js\": 136,\n\t\"./fil\": 137,\n\t\"./fil.js\": 137,\n\t\"./fo\": 138,\n\t\"./fo.js\": 138,\n\t\"./fr\": 139,\n\t\"./fr-ca\": 140,\n\t\"./fr-ca.js\": 140,\n\t\"./fr-ch\": 141,\n\t\"./fr-ch.js\": 141,\n\t\"./fr.js\": 139,\n\t\"./fy\": 142,\n\t\"./fy.js\": 142,\n\t\"./ga\": 143,\n\t\"./ga.js\": 143,\n\t\"./gd\": 144,\n\t\"./gd.js\": 144,\n\t\"./gl\": 145,\n\t\"./gl.js\": 145,\n\t\"./gom-deva\": 146,\n\t\"./gom-deva.js\": 146,\n\t\"./gom-latn\": 147,\n\t\"./gom-latn.js\": 147,\n\t\"./gu\": 148,\n\t\"./gu.js\": 148,\n\t\"./he\": 149,\n\t\"./he.js\": 149,\n\t\"./hi\": 150,\n\t\"./hi.js\": 150,\n\t\"./hr\": 151,\n\t\"./hr.js\": 151,\n\t\"./hu\": 152,\n\t\"./hu.js\": 152,\n\t\"./hy-am\": 153,\n\t\"./hy-am.js\": 153,\n\t\"./id\": 154,\n\t\"./id.js\": 154,\n\t\"./is\": 155,\n\t\"./is.js\": 155,\n\t\"./it\": 156,\n\t\"./it-ch\": 157,\n\t\"./it-ch.js\": 157,\n\t\"./it.js\": 156,\n\t\"./ja\": 158,\n\t\"./ja.js\": 158,\n\t\"./jv\": 159,\n\t\"./jv.js\": 159,\n\t\"./ka\": 160,\n\t\"./ka.js\": 160,\n\t\"./kk\": 161,\n\t\"./kk.js\": 161,\n\t\"./km\": 162,\n\t\"./km.js\": 162,\n\t\"./kn\": 163,\n\t\"./kn.js\": 163,\n\t\"./ko\": 164,\n\t\"./ko.js\": 164,\n\t\"./ku\": 165,\n\t\"./ku.js\": 165,\n\t\"./ky\": 166,\n\t\"./ky.js\": 166,\n\t\"./lb\": 167,\n\t\"./lb.js\": 167,\n\t\"./lo\": 168,\n\t\"./lo.js\": 168,\n\t\"./lt\": 169,\n\t\"./lt.js\": 169,\n\t\"./lv\": 170,\n\t\"./lv.js\": 170,\n\t\"./me\": 171,\n\t\"./me.js\": 171,\n\t\"./mi\": 172,\n\t\"./mi.js\": 172,\n\t\"./mk\": 173,\n\t\"./mk.js\": 173,\n\t\"./ml\": 174,\n\t\"./ml.js\": 174,\n\t\"./mn\": 175,\n\t\"./mn.js\": 175,\n\t\"./mr\": 176,\n\t\"./mr.js\": 176,\n\t\"./ms\": 177,\n\t\"./ms-my\": 178,\n\t\"./ms-my.js\": 178,\n\t\"./ms.js\": 177,\n\t\"./mt\": 179,\n\t\"./mt.js\": 179,\n\t\"./my\": 180,\n\t\"./my.js\": 180,\n\t\"./nb\": 181,\n\t\"./nb.js\": 181,\n\t\"./ne\": 182,\n\t\"./ne.js\": 182,\n\t\"./nl\": 183,\n\t\"./nl-be\": 184,\n\t\"./nl-be.js\": 184,\n\t\"./nl.js\": 183,\n\t\"./nn\": 185,\n\t\"./nn.js\": 185,\n\t\"./oc-lnc\": 186,\n\t\"./oc-lnc.js\": 186,\n\t\"./pa-in\": 187,\n\t\"./pa-in.js\": 187,\n\t\"./pl\": 188,\n\t\"./pl.js\": 188,\n\t\"./pt\": 189,\n\t\"./pt-br\": 190,\n\t\"./pt-br.js\": 190,\n\t\"./pt.js\": 189,\n\t\"./ro\": 191,\n\t\"./ro.js\": 191,\n\t\"./ru\": 192,\n\t\"./ru.js\": 192,\n\t\"./sd\": 193,\n\t\"./sd.js\": 193,\n\t\"./se\": 194,\n\t\"./se.js\": 194,\n\t\"./si\": 195,\n\t\"./si.js\": 195,\n\t\"./sk\": 196,\n\t\"./sk.js\": 196,\n\t\"./sl\": 197,\n\t\"./sl.js\": 197,\n\t\"./sq\": 198,\n\t\"./sq.js\": 198,\n\t\"./sr\": 199,\n\t\"./sr-cyrl\": 200,\n\t\"./sr-cyrl.js\": 200,\n\t\"./sr.js\": 199,\n\t\"./ss\": 201,\n\t\"./ss.js\": 201,\n\t\"./sv\": 202,\n\t\"./sv.js\": 202,\n\t\"./sw\": 203,\n\t\"./sw.js\": 203,\n\t\"./ta\": 204,\n\t\"./ta.js\": 204,\n\t\"./te\": 205,\n\t\"./te.js\": 205,\n\t\"./tet\": 206,\n\t\"./tet.js\": 206,\n\t\"./tg\": 207,\n\t\"./tg.js\": 207,\n\t\"./th\": 208,\n\t\"./th.js\": 208,\n\t\"./tk\": 209,\n\t\"./tk.js\": 209,\n\t\"./tl-ph\": 210,\n\t\"./tl-ph.js\": 210,\n\t\"./tlh\": 211,\n\t\"./tlh.js\": 211,\n\t\"./tr\": 212,\n\t\"./tr.js\": 212,\n\t\"./tzl\": 213,\n\t\"./tzl.js\": 213,\n\t\"./tzm\": 214,\n\t\"./tzm-latn\": 215,\n\t\"./tzm-latn.js\": 215,\n\t\"./tzm.js\": 214,\n\t\"./ug-cn\": 216,\n\t\"./ug-cn.js\": 216,\n\t\"./uk\": 217,\n\t\"./uk.js\": 217,\n\t\"./ur\": 218,\n\t\"./ur.js\": 218,\n\t\"./uz\": 219,\n\t\"./uz-latn\": 220,\n\t\"./uz-latn.js\": 220,\n\t\"./uz.js\": 219,\n\t\"./vi\": 221,\n\t\"./vi.js\": 221,\n\t\"./x-pseudo\": 222,\n\t\"./x-pseudo.js\": 222,\n\t\"./yo\": 223,\n\t\"./yo.js\": 223,\n\t\"./zh-cn\": 224,\n\t\"./zh-cn.js\": 224,\n\t\"./zh-hk\": 225,\n\t\"./zh-hk.js\": 225,\n\t\"./zh-mo\": 226,\n\t\"./zh-mo.js\": 226,\n\t\"./zh-tw\": 227,\n\t\"./zh-tw.js\": 227\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 433;","import axios, { CancelToken, AxiosInstance } from 'axios';\r\nimport { Request as SearchRequest, Response as SearchResponse, Result } from 'models/Search';\r\nimport { Request as CompareItemRequest, Response as CompareDataResponse } from 'models/CompareItems';\r\nimport { Request as AutocompleteRequest, Response as AutocompleteResponse } from 'models/Autocomplete';\r\nimport { Request as PinItemRequest } from 'models/PinItems';\r\nimport { Request as ProductDetailsRequest, Response as ProductDetailsResponse } from 'models/ProductDetails';\r\nimport { Request as SortingOrderRequest } from 'models/PinItemsOrder';\r\nimport { Request as RebuildIndexRequest } from 'models/RebuildIndex';\r\nimport { HawksearchConfig } from 'types/HawksearchConfig';\r\nimport AuthToken from 'components/AuthToken';\r\n\r\nclass HawkClient {\r\n\tprivate baseUrl: string;\r\n\tprivate searchUrl: string;\r\n\tprivate dashboardUrl: string;\r\n\tprivate autocompleteUrl: string;\r\n\tprivate compareItemsURL: string;\r\n\tprivate refreshTokenURL: string;\r\n\tprivate pinItemURL: string;\r\n\tprivate updatePinOrderURL: string;\r\n\tprivate rebuildIndexURL: string;\r\n\tprivate productDetailsURL: string;\r\n\tprivate axiosInstance: AxiosInstance = axios.create();\r\n\r\n\tconstructor(config: HawksearchConfig) {\r\n\t\tthis.baseUrl = config.apiUrl || 'https://searchapi-dev.hawksearch.net';\r\n\t\tthis.dashboardUrl = config.dashboardUrl || 'http://test.hawksearch.net/';\r\n\t\tthis.searchUrl = config.searchUrl || '/api/v2/search';\r\n\t\tthis.autocompleteUrl = config.autocompleteUrl || '/api/autocomplete';\r\n\t\tthis.compareItemsURL = config.compareItemsURL || '/api/compare';\r\n\t\tthis.refreshTokenURL = config.refreshTokenURL || '/api/internal-preview/refresh-token/';\r\n\t\tthis.pinItemURL = config.pinItemURL || '/api/pinning/set-pinning/';\r\n\t\tthis.updatePinOrderURL = config.updatePinOrderURL || '/api/pinning/update-pin-order/';\r\n\t\tthis.rebuildIndexURL = config.rebuildIndexURL || '/api/internal-preview/rebuild-percolator';\r\n\t\tthis.productDetailsURL = config.productDetailsURL || '/api/internal-preview/item-detail';\r\n\r\n\t\tthis.axiosInstance.interceptors.request.use(\r\n\t\t\tconf => {\r\n\t\t\t\tconst accessToken = AuthToken.getTokens().accessToken;\r\n\t\t\t\tif ((conf.url || '').indexOf('refresh-token') !== -1 || !accessToken) {\r\n\t\t\t\t\tdelete conf.headers.common.Authorization;\r\n\t\t\t\t\tdelete conf.headers.common.ClientGuid;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconf.headers.Authorization = `Bearer ${accessToken}`;\r\n\t\t\t\t\tconf.headers.ClientGuid = config.clientGuid;\r\n\t\t\t\t}\r\n\t\t\t\treturn conf;\r\n\t\t\t},\r\n\t\t\terror => {\r\n\t\t\t\tPromise.reject(error);\r\n\t\t\t}\r\n\t\t);\r\n\t\tthis.axiosInstance.interceptors.response.use(\r\n\t\t\tresponse => response,\r\n\t\t\terror => {\r\n\t\t\t\tconst originalRequest = error.config;\r\n\r\n\t\t\t\tif (error.response && error.response.status === 401 && !originalRequest._retry) {\r\n\t\t\t\t\toriginalRequest._retry = true;\r\n\t\t\t\t\tconst token = AuthToken.getTokens();\r\n\t\t\t\t\treturn this.axiosInstance\r\n\t\t\t\t\t\t.post(new URL(this.refreshTokenURL, this.baseUrl).href, {\r\n\t\t\t\t\t\t\tClientGuid: config.clientGuid,\r\n\t\t\t\t\t\t\tToken: token.accessToken,\r\n\t\t\t\t\t\t\tRefreshToken: token.refreshToken,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tif (res.status === 200) {\r\n\t\t\t\t\t\t\t\tAuthToken.setTokens(res.data.Token, res.data.RefreshToken);\r\n\t\t\t\t\t\t\t\tthis.axiosInstance.defaults.headers.common.Authorization = 'Bearer ' + res.data.Token;\r\n\t\t\t\t\t\t\t\treturn this.axiosInstance(originalRequest);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.reject(error);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tpublic async pinItem(request: PinItemRequest, cancellationToken?: CancelToken): Promise<string | null> {\r\n\t\tconst result = await this.axiosInstance.post<string | null>(\r\n\t\t\tnew URL(this.pinItemURL, this.baseUrl).href,\r\n\t\t\trequest,\r\n\t\t\t{\r\n\t\t\t\tcancelToken: cancellationToken,\r\n\t\t\t}\r\n\t\t);\r\n\t\treturn result.data;\r\n\t}\r\n\r\n\tpublic async updatePinOrder(request: SortingOrderRequest, cancellationToken?: CancelToken): Promise<string | null> {\r\n\t\tconst result = await this.axiosInstance.post<string | null>(\r\n\t\t\tnew URL(this.updatePinOrderURL, this.baseUrl).href,\r\n\t\t\trequest,\r\n\t\t\t{\r\n\t\t\t\tcancelToken: cancellationToken,\r\n\t\t\t}\r\n\t\t);\r\n\t\treturn result.data;\r\n\t}\r\n\r\n\tpublic async search(request: SearchRequest, cancellationToken?: CancelToken): Promise<SearchResponse> {\r\n\t\tconst result = await this.axiosInstance.post<SearchResponse>(\r\n\t\t\tnew URL(this.searchUrl, this.baseUrl).href,\r\n\t\t\trequest,\r\n\t\t\t{\r\n\t\t\t\tcancelToken: cancellationToken,\r\n\t\t\t}\r\n\t\t);\r\n\t\treturn result.data;\r\n\t}\r\n\r\n\tpublic async rebuildIndex(request: RebuildIndexRequest, cancellationToken?: CancelToken): Promise<string | null> {\r\n\t\tconst result = await this.axiosInstance.post<string | null>(\r\n\t\t\tnew URL(this.rebuildIndexURL, this.baseUrl).href,\r\n\t\t\trequest,\r\n\t\t\t{\r\n\t\t\t\tcancelToken: cancellationToken,\r\n\t\t\t}\r\n\t\t);\r\n\t\treturn result.data;\r\n\t}\r\n\r\n\tpublic async autocomplete(\r\n\t\trequest: AutocompleteRequest,\r\n\t\tcancellationToken?: CancelToken\r\n\t): Promise<AutocompleteResponse> {\r\n\t\tconst result = await axios.post<AutocompleteResponse>(\r\n\t\t\tnew URL(this.autocompleteUrl, this.baseUrl).href,\r\n\t\t\trequest,\r\n\t\t\t{\r\n\t\t\t\tcancelToken: cancellationToken,\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\treturn result.data;\r\n\t}\r\n\r\n\tpublic async getComparedItems(\r\n\t\trequest: CompareItemRequest,\r\n\t\tcancellationToken?: CancelToken\r\n\t): Promise<CompareDataResponse> {\r\n\t\tconst result = await axios.post<CompareDataResponse>(\r\n\t\t\tnew URL(this.compareItemsURL, this.baseUrl).href,\r\n\t\t\trequest,\r\n\t\t\t{\r\n\t\t\t\tcancelToken: cancellationToken,\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\treturn result.data;\r\n\t}\r\n\r\n\tpublic async getProductDetails(\r\n\t\trequest: ProductDetailsRequest,\r\n\t\tcancellationToken?: CancelToken\r\n\t): Promise<ProductDetailsResponse> {\r\n\t\tconst result = await axios.post<Result>(new URL(this.productDetailsURL, this.baseUrl).href, request, {\r\n\t\t\tcancelToken: cancellationToken,\r\n\t\t});\r\n\t\treturn new Result(result.data);\r\n\t}\r\n}\r\n\r\nexport default HawkClient;\r\n","export class Pagination {\r\n\t/** Number of total items in the result set. */\r\n\tpublic NofResults: number;\r\n\r\n\t/** The page number returned. */\r\n\tpublic CurrentPage: number;\r\n\r\n\t/** The number of items returned for the page. */\r\n\tpublic MaxPerPage: number;\r\n\r\n\t/** The total number of pages for the result set - with the current @see MaxPerPage. */\r\n\tpublic NofPages: number;\r\n\r\n\t/** Set of pagination options */\r\n\tpublic Items: PaginationItem[];\r\n\r\n\tpublic constructor(init: Pagination) {\r\n\t\tObject.assign(this, init);\r\n\r\n\t\tthis.Items = init.Items.map(i => new PaginationItem(i));\r\n\t}\r\n}\r\n\r\nexport class PaginationItem {\r\n\t/** Display label for user's pagination option (i.e. 24 per page). */\r\n\tpublic Label: string;\r\n\t/** The maximum number of items that will be returned per page when this option is selected. */\r\n\tpublic PageSize: number;\r\n\r\n\t/** Indicates if this is the option selected. Only one pagination item will have this set to `true`. */\r\n\tpublic Selected: boolean;\r\n\r\n\t/** Indicates if this is the default option. Only one pagination item will have this set to `true`. */\r\n\tpublic Default: boolean;\r\n\r\n\tpublic constructor(init: PaginationItem) {\r\n\t\tObject.assign(this, init);\r\n\t}\r\n}\r\n","/** An object that contains the data related to the client making search or autosuggest requests. */\r\nexport class ChildResult {\r\n\t/** Number of total items in the result set. */\r\n\tpublic NofResults: number;\r\n\r\n\t/** The page number returned. */\r\n\tpublic CurrentPage: number;\r\n\r\n\t/** The number of items returned for the page. */\r\n\tpublic MaxPerPage: number;\r\n\r\n\t/** The total number of pages for the result set - with the current @see MaxPerPage. */\r\n\tpublic NofPages: number;\r\n\r\n\t/** Set of pagination options */\r\n\tpublic Items: Array<{ [field: string]: string[] }>;\r\n\r\n\tpublic Sort: string;\r\n\r\n\tpublic constructor(init: ChildResult) {\r\n\t\tObject.assign(this, init);\r\n\t}\r\n\r\n\tpublic getHittedChildAttributeValue(field: string): string | undefined {\r\n\t\tif (!this.Items || this.Items.length === 0) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\tconst values = this.Items[0];\r\n\t\tif (values && values[field] && values[field].length > 0) {\r\n\t\t\treturn values[field][0];\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\t}\r\n}\r\n","import { Explain } from './Explain';\r\nimport { ChildResult } from './ChildResult';\r\n\r\nexport class Result {\r\n\t/** Unique identifier for this search result item. */\r\n\tpublic DocId: string;\r\n\r\n\t/** Calculated relevancy score. */\r\n\tpublic Score: number;\r\n\r\n\t/**\r\n\t * Contains the fields for the search result item, as an object of string keys to an array\r\n\t * of string values. The keys correspond to the name of the field within the hawk dashboard,\r\n\t * and the value of the map is an array of strings for each of the values for that field.\r\n\t */\r\n\tpublic Document?: { [field: string]: string[] };\r\n\r\n\tpublic Explain?: Explain;\r\n\r\n\tpublic IsPin: boolean;\r\n\r\n\tpublic ChildResults?: ChildResult;\r\n\r\n\tpublic BestFragment: string;\r\n\t/**\r\n\t * Returns a single document value, by the given field name. If the field does not exist in\r\n\t * the document, or has no values, then `undefined` is returned instead.\r\n\t * @param field The field within the result document to retrieve the value of.\r\n\t */\r\n\tpublic getDocumentValue(field: string): string | undefined {\r\n\t\tif (this.Document) {\r\n\t\t\tconst values = this.Document[field];\r\n\r\n\t\t\tif (values && values.length > 0) {\r\n\t\t\t\treturn values[0];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tpublic constructor(init: Result) {\r\n\t\tObject.assign(this, init);\r\n\t\tif (init.ChildResults) {\r\n\t\t\tthis.ChildResults = new ChildResult(init.ChildResults);\r\n\t\t}\r\n\t}\r\n}\r\n","export class Sorting {\r\n\t/** The sorting items. */\r\n\tpublic Items: SortingItem[];\r\n\r\n\tpublic constructor(init: Sorting) {\r\n\t\tObject.assign(this, init);\r\n\r\n\t\tthis.Items = init.Items.map(i => new SortingItem(i));\r\n\t}\r\n}\r\n\r\nexport class SortingItem {\r\n\t/** Name of the sorting option. This is the label to display to users. */\r\n\tpublic Label: string;\r\n\t/**\r\n\t * The value to be used to specify the sort order once user selects it. This value is passed in the @see Request.SortBy\r\n\t * field in the @see Request object.\r\n\t */\r\n\tpublic Value: string;\r\n\r\n\t/** Indicates if this sorting option was configured to be the default. */\r\n\tpublic IsDefault: boolean;\r\n\t/** Indicates if this sorting option is currently being used for the current result set. */\r\n\tpublic Selected: boolean;\r\n\r\n\tpublic constructor(init: SortingItem) {\r\n\t\tObject.assign(this, init);\r\n\t}\r\n}\r\n","export class Selections {\r\n\t[field: string]: SelectionFacet;\r\n\r\n\tpublic constructor(init: Selections) {\r\n\t\tObject.assign(this, init);\r\n\r\n\t\tObject.keys(init).forEach(key => {\r\n\t\t\tconst selFacet = init[key];\r\n\r\n\t\t\tthis[key] = new SelectionFacet(selFacet);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport class SelectionFacet {\r\n\t/** Display name for facet. */\r\n\tpublic Label: string;\r\n\r\n\t/** Will contain an entry for each selection made within the facet. */\r\n\tpublic Items: SelectionFacetValue[];\r\n\r\n\tpublic constructor(init: SelectionFacet) {\r\n\t\tObject.assign(this, init);\r\n\r\n\t\tthis.Items = init.Items.map(i => new SelectionFacetValue(i));\r\n\t}\r\n}\r\n\r\nexport class SelectionFacetValue {\r\n\t/** Display label for facet value. */\r\n\tpublic Label: string;\r\n\r\n\t/** Value for facet value. */\r\n\tpublic Value: string;\r\n\r\n\tpublic constructor(init: SelectionFacetValue) {\r\n\t\tObject.assign(this, init);\r\n\t}\r\n}\r\n","export class Value {\r\n\t/** Label of the value to display. */\r\n\tpublic Label?: string;\r\n\t/** Value to use when setting the facet value selection. */\r\n\tpublic Value?: string;\r\n\r\n\t/** Number of results in current set that have this facet value. */\r\n\tpublic Count: number;\r\n\t/** Indicates if this facet value has been selected. */\r\n\tpublic Selected: boolean;\r\n\r\n\t/**\r\n\t * Used for displaying the slider facet. @see RangeStart indicates what the starting point of the range\r\n\t * to display, either on basis of what the user selected by sliding the slider, or if they have no\r\n\t * selection it reflects the lowest price product.\r\n\t */\r\n\tpublic RangeStart?: string;\r\n\t/**\r\n\t * Used for displaying the slider facet. @see RangeEnd indicates what the end point of the range to\r\n\t * display is, either on basis of what the user selected by sliding the slider, or if they have no\r\n\t * selection, it reflects the highest price product.\r\n\t */\r\n\tpublic RangeEnd?: string;\r\n\r\n\t/**\r\n\t * Used for displaying the slider facet. @see RangeMin indicates lowest value for the range in the list\r\n\t * of products displayed.\r\n\t */\r\n\tpublic RangeMin?: string;\r\n\t/**\r\n\t * Used for displaying the slider facet. @see RangeMax indicates highest value for the range in the list\r\n\t * of products displayed.\r\n\t */\r\n\tpublic RangeMax?: string;\r\n\r\n\t/** Used for nested facets. */\r\n\tpublic Path?: string;\r\n\r\n\t/** Set of pagination options */\r\n\tpublic Children: Value[];\r\n\r\n\tpublic Level: number;\r\n\r\n\tpublic constructor(init: Value) {\r\n\t\tObject.assign(this, init);\r\n\t}\r\n}\r\n","export class Swatch {\r\n\t/** Match this value to the @see Value object in the @see Values array of @see Facet. */\r\n\tpublic Value: string;\r\n\r\n\t/** Name of the asset. */\r\n\tpublic AssetName: string;\r\n\t/** URL of the asset. */\r\n\tpublic AssetUrl: string;\r\n\r\n\t/** Indicates if value is the default. */\r\n\tpublic IsDefault: boolean;\r\n\r\n\t/** Color of the asset. */\r\n\tpublic Color: string;\r\n\r\n\tpublic constructor(init: Swatch) {\r\n\t\tObject.assign(this, init);\r\n\t}\r\n}\r\n","export class Range {\r\n\t/** Label of the value to display. */\r\n\tpublic Label: string;\r\n\t/** Value to use when setting the facet value selection. */\r\n\tpublic Value: string;\r\n\r\n\t/** Indicates if the values are numeric. */\r\n\tpublic IsNumeric: boolean;\r\n\r\n\t/** Lower value of the range. */\r\n\tpublic LBound: string;\r\n\t/** Upper value of the range. */\r\n\tpublic UBound: string;\r\n\t/** Asset Url */\r\n\tpublic AssetFullUrl: string;\r\n\r\n\tpublic constructor(init: Range) {\r\n\t\tObject.assign(this, init);\r\n\t}\r\n}\r\n","import { Value } from './Value';\r\nimport { Swatch } from './Swatch';\r\nimport { Range } from './Range';\r\nimport { FacetType } from 'models/Facets/FacetType';\r\n\r\nexport class Facet {\r\n\t/** Unique identifier of the facet. */\r\n\tpublic FacetId: number;\r\n\r\n\t/** Display name of the facet. */\r\n\tpublic Name: string;\r\n\r\n\t/** The name of the field that is linked to this facet. */\r\n\tpublic Field: string;\r\n\r\n\tpublic FieldType: 'string' | 'range' | 'numeric' | 'search' | 'tab';\r\n\tpublic FacetType: FacetType;\r\n\r\n\tpublic DisplayType: 'default' | 'scrolling' | 'truncating';\r\n\r\n\t/** Indicates the maximum number of facet values that are returned. */\r\n\tpublic MaxCount: number;\r\n\r\n\t/** Indicates the minimum number of results each facet value needs to have in order to be returned. */\r\n\tpublic MinHitCount: number;\r\n\r\n\t/**\r\n\t * If this is set, it is to be used as the facet name if passed in the `FacetSelections`. If not set,\r\n\t * the value of the Field object would be used. (This is only applicable when a slider and range\r\n\t * facets are both configured for the same field.)\r\n\t */\r\n\tpublic ParamName?: string;\r\n\r\n\t/**\r\n\t * Indicates the sorting logic that is used for this facet’s values. The possible values for this\r\n\t * are the parameters for sorting set options that are configured in \"Workbench > Data Configuration\r\n\t * > Sorting/Pagination\".\r\n\t */\r\n\tpublic SortBy: string;\r\n\r\n\t/** Indicates if the user should be able to apply more than one filter value from this facet. */\r\n\tpublic ExpandSelection: boolean;\r\n\r\n\t/** Indicates if facet values are numeric. */\r\n\tpublic IsNumeric: boolean;\r\n\t/** Indicates if facet values are currency (and should be displayed appropriately). */\r\n\tpublic IsCurrency: boolean;\r\n\t/** Indicates currency symbol in case of currency type facets */\r\n\tpublic CurrencySymbol: string;\r\n\t/** Indicates if the facet can be collapsed and expanded by the user. */\r\n\tpublic IsCollapsible: boolean;\r\n\t/** If @see IsCollapsible is `true`, this indicates if the facet should initially be collapsed or expanded. */\r\n\tpublic IsCollapsedDefault: boolean;\r\n\t/** Indicates if the facet is set to be visible. */\r\n\tpublic IsVisible: boolean;\r\n\t/**\r\n\t * Indicates if search is enabled for this facet. If it is enabled, a search box should be available for\r\n\t * users to filter the facet values by typing in the search box.\r\n\t */\r\n\tpublic IsSearch: boolean;\r\n\r\n\t/**\r\n\t * If facet display type is Scrolling, this value is the height in pixels for the window inside scroll box.\r\n\t * Only to be used if @see DisplayType is `\"scrolling\"`.\r\n\t */\r\n\tpublic ScrollHeight: number;\r\n\t/**\r\n\t * If the number of facet values exceeds this number and @see DisplayType is `\"scrolling\"`, then the facet\r\n\t * should be displayed as scrolling list; if not, display as `\"default\"`.\r\n\t */\r\n\tpublic ScrollThreshold: number;\r\n\t/**\r\n\t * If the number of facet values exceeds this number and @see DisplayType is `\"truncate\"`, then the facet\r\n\t * should be displayed as truncated list; if not, display as `\"default\"`.\r\n\t */\r\n\tpublic TruncateThreshold: number;\r\n\t/**\r\n\t * To be used if @see IsSearch is `true`. The number of facet values must be this number or higher for the\r\n\t * facet search box to display.\r\n\t */\r\n\tpublic SearchThreshold: number;\r\n\r\n\t/** Text to display when user hovers over a help icon. */\r\n\tpublic Tooltip?: string;\r\n\r\n\t/**\r\n\t * If `false`, indicates that sometimes this facet will not be returned. The conditions that trigger its\r\n\t * display are maintained in the Workbench.\r\n\t */\r\n\tpublic AlwaysVisible: boolean;\r\n\r\n\t/**\r\n\t * The display order of the facet in the facet list.\r\n\t */\r\n\tpublic SortOrder: number;\r\n\r\n\t/** This is maximum number of values that could be returned for the facet. */\r\n\tpublic NofVisible: number;\r\n\r\n\t/** Will be included if @see FacetType is `\"swatch\"`. */\r\n\tpublic SwatchData: Swatch[];\r\n\r\n\t/** Indicates type of facet range display. */\r\n\tpublic FacetRangeDisplayType: number;\r\n\r\n\t/** Indicates if setting in Workbench is set to On or Off. */\r\n\tpublic PreloadChildren: boolean;\r\n\r\n\t/**\r\n\t * To be used if @see FacetType is `\"slider\"`. If @see ShowSliderInputs is `true`, input boxes should be\r\n\t * available for user to enter values.\r\n\t */\r\n\tpublic ShowSliderInputs: boolean;\r\n\r\n\t/** Always present, but will only be populated if the facet is numeric and not a slider. */\r\n\tpublic Ranges: Range[];\r\n\t/** The values for this facet. */\r\n\tpublic Values: Value[];\r\n\t// Data type for datetime facet type\r\n\tpublic DataType?: string;\r\n\r\n\t/** Whether or not the facet should be rendered as truncated. */\r\n\tpublic get shouldTruncate() {\r\n\t\t// the facet does truncated listing of values if configured for truncating and we have too many facets\r\n\t\treturn this.DisplayType === 'truncating' && this.Values.length > this.TruncateThreshold;\r\n\t}\r\n\t/** Whether or not the facet should have a quick lookup search input. */\r\n\tpublic get shouldSearch() {\r\n\t\t// the facet should have a search box if configured to do so, and the number of facet values is greater\r\n\t\t// than the threshold\r\n\t\treturn this.IsSearch && this.Values.length > this.SearchThreshold;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the name of the key when using this facet for a selection. This will take into consideration\r\n\t * @see ParamName and @see Field in determining which value should be returned.\r\n\t */\r\n\tpublic get selectionField() {\r\n\t\treturn this.ParamName ? this.ParamName : this.Field;\r\n\t}\r\n\r\n\tpublic constructor(init: Facet) {\r\n\t\tObject.assign(this, init);\r\n\r\n\t\tthis.SwatchData = init.SwatchData.map(s => new Swatch(s));\r\n\t\tthis.Ranges = init.Ranges.map(r => new Range(r));\r\n\t\tthis.Values = init.Values.map(v => new Value(v));\r\n\t}\r\n}\r\n","export class Rule {\r\n\tpublic RuleType: RuleType;\r\n\tpublic Field: string;\r\n\tpublic Condition: string;\r\n\tpublic Value: string;\r\n\tpublic Operator: RuleOperatorType;\r\n\r\n\tpublic Rules: Rule[];\r\n\tpublic Parent: Rule;\r\n\tpublic constructor(init: Rule) {\r\n\t\tObject.assign(this, init);\r\n\t\tif (init.Parent) {\r\n\t\t\tthis.Parent = new Rule(init.Parent);\r\n\t\t}\r\n\t\tthis.Rules = init.Rules ? init.Rules.map(i => new Rule(i)) : [];\r\n\t}\r\n}\r\n\r\nexport enum RuleType {\r\n\tGroup = 0,\r\n\tEval = 1,\r\n}\r\n\r\nexport enum RuleOperatorType {\r\n\tAll = 0,\r\n\tAny = 1,\r\n\tNone = 2,\r\n}\r\n","import { Rule } from './Rule';\r\n\r\nexport class BannerTrigger {\r\n\tpublic BannerGroupId: number;\r\n\tpublic Name: string;\r\n\tpublic SortOrder: number;\r\n\tpublic Rule: Rule;\r\n\r\n\tpublic constructor(init: BannerTrigger) {\r\n\t\tObject.assign(this, init);\r\n\r\n\t\tthis.Rule = new Rule(this.Rule);\r\n\t}\r\n}\r\n","import { ContentType } from './ContentType';\r\nimport { Result } from './Result';\r\nimport { BannerTrigger } from './Trigger';\r\n\r\nexport class FeaturedItems {\r\n\tpublic Items: FeaturedItem[];\r\n\r\n\tpublic constructor(init: FeaturedItems) {\r\n\t\tObject.assign(this, init);\r\n\t\tif (init && init.Items) {\r\n\t\t\tthis.Items = init.Items ? init.Items.map(i => new FeaturedItem(i)) : [];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class Merchandising {\r\n\tpublic Items: MerchandisingItem[];\r\n\r\n\tpublic constructor(init: Merchandising) {\r\n\t\tObject.assign(this, init);\r\n\t\tif (init && init.Items) {\r\n\t\t\tthis.Items = init.Items ? init.Items.map(i => new MerchandisingItem(i)) : [];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class PageContentItem {\r\n\tpublic Zone: string;\r\n\tpublic ContentType: ContentType;\r\n\tpublic ImageUrl: string;\r\n\tpublic AltTag: string;\r\n\tpublic ForwardUrl: string;\r\n\tpublic Output: any;\r\n\tpublic WidgetArgs: string;\r\n\tpublic Title: string;\r\n\tpublic Name: string;\r\n\tpublic DateFrom: string;\r\n\tpublic DateTo: string;\r\n\tpublic IsMobile: boolean;\r\n\tpublic MobileContentType: string;\r\n\tpublic MobileImageUrl: string;\r\n\tpublic MobileOutput: string;\r\n\tpublic MobileWidgetArgs: string;\r\n\tpublic IsTrackingEnabled: boolean;\r\n\tpublic MobileIsTrackingEnabled?: boolean;\r\n\tpublic FeaturedItems: Result[];\r\n\tpublic Items: Result[];\r\n\tpublic Target: string;\r\n\tpublic MobileTarget: string;\r\n\tpublic MobileAltTag: string;\r\n\tpublic MobileForwardUrl: string;\r\n\tpublic MobileWidth: string;\r\n\tpublic MobileHeight: string;\r\n\tpublic Trigger: BannerTrigger;\r\n\tpublic BannerId: number;\r\n\tpublic CampaignId: number;\r\n\tpublic ImageTitle: string;\r\n\r\n\tpublic constructor(init: PageContentItem) {\r\n\t\tObject.assign(this, init);\r\n\t\tif (init.FeaturedItems) {\r\n\t\t\tthis.FeaturedItems = init.FeaturedItems.map(i => new Result(i));\r\n\t\t}\r\n\t\tif (init.Trigger) {\r\n\t\t\tthis.Trigger = new BannerTrigger(init.Trigger);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class FeaturedItem extends PageContentItem {\r\n\tpublic Items: Result[];\r\n\r\n\tpublic constructor(init: FeaturedItem) {\r\n\t\tsuper(init);\r\n\t\tObject.assign(this, init);\r\n\t\tthis.Items = init.Items.map(i => new Result(i));\r\n\t}\r\n}\r\n\r\nexport class MerchandisingItem extends PageContentItem {\r\n\tpublic constructor(init: MerchandisingItem) {\r\n\t\tsuper(init);\r\n\t\tObject.assign(this, init);\r\n\t}\r\n}\r\n","import { PageContentItem } from './Merchandising';\r\n\r\nexport class PageContent {\r\n\tpublic ZoneName: string;\r\n\tpublic Items: PageContentItem[];\r\n\tpublic constructor(init: PageContent) {\r\n\t\tObject.assign(this, init);\r\n\t\tthis.Items = init.Items.map(i => new PageContentItem(i));\r\n\t}\r\n}\r\n","import { Pagination } from './Pagination';\r\nimport { Result } from './Result';\r\nimport { Sorting } from './Sorting';\r\nimport { Selections } from './Selections';\r\nimport { Facet } from 'models/Facets';\r\nimport { Merchandising, FeaturedItems } from './Merchandising';\r\nimport { StringLiteral } from '@babel/types';\r\nimport { PageContent } from './PageContent';\r\n\r\nexport class Response {\r\n\t/** Indicates if request was successful. */\r\n\tpublic Success: boolean;\r\n\r\n\t/** Summary of pagination details and a set of pagination options. */\r\n\tpublic Pagination: Pagination;\r\n\r\n\t/**\r\n\t * The Keyword value that was sent to Hawksearch in the request. If no Keyword was set in the\r\n\t * request, the value will be empty.\r\n\t */\r\n\tpublic Keyword: string;\r\n\r\n\t/**\r\n\t * If this is populated, it indicates that the Keyword value returned 0 results, but the results\r\n\t * in this response are from this AdjustedKeyword.  A message should be displayed to the user\r\n\t * informing them that their search was corrected to this string.\r\n\t *\r\n\t * This is the result of Auto Correct, which is configured in the Workbench > Keyword Search >\r\n\t * Did You Mean.\r\n\t */\r\n\tpublic AdjustedKeyword?: string;\r\n\r\n\t/** An entry in the array for each item returned in search results. */\r\n\tpublic Results: Result[];\r\n\r\n\tpublic Facets: Facet[];\r\n\r\n\t/**\r\n\t * Will contain an entry for each facet that has one or more selections. Will be empty if no facet\r\n\t * selections have been made.\r\n\t */\r\n\tpublic Selections: Selections;\r\n\r\n\tpublic Sorting: Sorting;\r\n\r\n\t/**\r\n\t * If any strings are returned in the array, they should be displayed to the user as suggested\r\n\t * search terms.\r\n\t *\r\n\t * This is the result of Did You Mean, which is configured in the Workbench > Keyword Search >\r\n\t * Did You Mean.\r\n\t */\r\n\tpublic DidYouMean: string[];\r\n\r\n\t/**\r\n\t * Merchandising can be placed by using Campaigns in the Hawksearch Workbench. The Campaign will\r\n\t * determine if the content should appear and in what zone.\r\n\t */\r\n\tpublic Merchandising: Merchandising; // TODO: merchandising object\r\n\tpublic FeaturedItems: FeaturedItems; // TODO: featured items object\r\n\r\n\tpublic SearchDuration: number;\r\n\r\n\tpublic DocExplain?: string;\r\n\r\n\t/**\r\n\t * Properties that gets populated when user requests landing page related results\r\n\t *\r\n\t */\r\n\r\n\tpublic Breadcrumb: string;\r\n\r\n\tpublic CustomHtml: string;\r\n\r\n\tpublic HeaderTitle: string;\r\n\r\n\tpublic MetaDescription: string;\r\n\r\n\tpublic MetaKeywords: string;\r\n\tpublic MetaRobots: string;\r\n\tpublic Name: string;\r\n\tpublic Next: string;\r\n\tpublic Prev: string;\r\n\tpublic PageHeading: string;\r\n\tpublic PageContent: PageContent[];\r\n\tpublic RelCanonical: string;\r\n\tpublic PageLayoutId: number;\r\n\tpublic TrackingId: string;\r\n\tpublic VisitorTargets: Array<{ Id: number; Name: string }>;\r\n\tpublic Redirect: { Location?: string; Target?: string };\r\n\r\n\t// end of landing page related fields\r\n\tpublic constructor(init: Response) {\r\n\t\tObject.assign(this, init);\r\n\r\n\t\tthis.Pagination = new Pagination(init.Pagination);\r\n\t\tthis.Merchandising = new Merchandising(init.Merchandising);\r\n\t\tthis.FeaturedItems = new FeaturedItems(init.FeaturedItems);\r\n\t\tthis.Results = init.Results.map(r => new Result(r));\r\n\t\tthis.Facets = init.Facets.map(f => new Facet(f));\r\n\t\tthis.PageContent = init.PageContent ? init.PageContent.map(p => new PageContent(p)) : [];\r\n\t\tthis.Selections = new Selections(init.Selections);\r\n\t\tthis.Sorting = new Sorting(init.Sorting);\r\n\t}\r\n}\r\n","import { Response, Request, Result } from 'models/Search';\r\nimport { Value, Facet } from 'models/Facets';\r\nimport { ClientSelections, ClientSelectionValue } from 'store/ClientSelections';\r\n\r\nexport enum FacetSelectionState {\r\n\t/** The facet value is not selected. */\r\n\tNotSelected,\r\n\t/** The facet value is selected. */\r\n\tSelected,\r\n\t/** The facet value is selected, but negated. */\r\n\tNegated,\r\n}\r\n\r\nexport interface SelectionInfo {\r\n\t/** The facet value selection state. */\r\n\tstate: FacetSelectionState;\r\n\r\n\t/**\r\n\t * If the facet value is `FacetSelectionState.Selected` or `FacetSelectionState.Negated`, this is the value of\r\n\t * the facet value. For negated facet values this will be prefixed with the negation character `'-'`.\r\n\t */\r\n\tselectedValue?: string;\r\n\t/**\r\n\t * If the facet value is `FacetSelectionState.Selected` or `FacetSelectionState.Negated`, this is the index\r\n\t * into the `pendingSearch.FacetSelections[facetName]` array for this facet value.\r\n\t */\r\n\tselectionIndex?: number;\r\n}\r\n\r\nexport class SearchStore {\r\n\t/** This represents the next search request that will be executed. */\r\n\tpublic pendingSearch: Partial<Request>;\r\n\t/**\r\n\t * Whether or not the next search request will perform history actions (pushing the search into browser\r\n\t * history).\r\n\t */\r\n\tpublic doHistory: boolean;\r\n\r\n\t/** Whether or not a search request is waiting for completion. */\r\n\tpublic isLoading: boolean;\r\n\r\n\tpublic itemsToCompare: Result[];\r\n\tpublic itemsToCompareIds: string[];\r\n\tpublic comparedResults: Result[];\r\n\tpublic productDetails: Partial<Result>;\r\n\r\n\t/** The results of the last search request, if one has been performed. Otherwise, `undefined`. */\r\n\tpublic searchResults?: Response;\r\n\r\n\tpublic requestError: boolean;\r\n\r\n\tpublic language?: string | null | undefined;\r\n\r\n\tpublic constructor(initial?: Partial<SearchStore>) {\r\n\t\tObject.assign(this, initial);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns whether or not this is the initial load of the search results.\r\n\t */\r\n\tpublic get isInitialLoad() {\r\n\t\treturn this.isLoading && !this.searchResults;\r\n\t}\r\n\r\n\t/**\r\n\t * Determines whether or not the given facet and facet value is selected, and returns info regarding the selection.\r\n\t * @param facet The facet for which the facet value will be checked for selection.\r\n\t * @param facetValue The facet value that will be checked for selection.\r\n\t */\r\n\tpublic isFacetSelected(facet: Facet | string, facetValue: Value | string): SelectionInfo {\r\n\t\tconst facetName = typeof facet === 'string' ? facet : facet.Name;\r\n\t\tconst facetField = typeof facet === 'string' ? facet : facet.selectionField;\r\n\r\n\t\tconst valueValue = typeof facetValue === 'string' ? facetValue : facetValue.Value;\r\n\t\tconst valueLabel = typeof facetValue === 'string' ? facetValue : facetValue.Label;\r\n\r\n\t\tif (!valueValue) {\r\n\t\t\tconsole.error(`Facet ${facetName} (${facetField}) has no facet value for ${valueLabel}`);\r\n\t\t\treturn { state: FacetSelectionState.NotSelected };\r\n\t\t}\r\n\r\n\t\tconst facetSelections = this.pendingSearch.FacetSelections;\r\n\r\n\t\tif (!facetSelections || !facetSelections[facetField]) {\r\n\t\t\treturn { state: FacetSelectionState.NotSelected };\r\n\t\t}\r\n\r\n\t\tconst selectionIdx = facetSelections[facetField]!.indexOf(valueValue);\r\n\t\tconst negationIdx = facetSelections[facetField]!.indexOf(`-${valueValue}`);\r\n\r\n\t\tif (selectionIdx !== -1) {\r\n\t\t\t// if the exact facet value exists, then we're normally selected\r\n\t\t\treturn {\r\n\t\t\t\tstate: FacetSelectionState.Selected,\r\n\t\t\t\tselectedValue: valueValue,\r\n\t\t\t\tselectionIndex: selectionIdx,\r\n\t\t\t};\r\n\t\t} else if (negationIdx !== -1) {\r\n\t\t\t// if the facet value is selected but prefixed with a -, then we're negated\r\n\t\t\treturn {\r\n\t\t\t\tstate: FacetSelectionState.Negated,\r\n\t\t\t\tselectedValue: `-${valueValue}`,\r\n\t\t\t\tselectionIndex: negationIdx,\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn { state: FacetSelectionState.NotSelected };\r\n\t}\r\n\r\n\t/**\r\n\t * Returns an object containing the selections that have been made in both the next search request and also\r\n\t * in the previous search request. This should be used when iterating selections instead of pulling the values\r\n\t * out from the search result or pending search - as this will merge the values together and provide an accurate\r\n\t * view of all facet selections.\r\n\t */\r\n\tpublic get facetSelections(): ClientSelections {\r\n\t\tconst {\r\n\t\t\tpendingSearch: { FacetSelections: clientSelections, SearchWithin },\r\n\t\t\tsearchResults,\r\n\t\t} = this;\r\n\t\tconst selections: ClientSelections = {};\r\n\r\n\t\tif (!clientSelections && !SearchWithin) {\r\n\t\t\treturn selections;\r\n\t\t}\r\n\r\n\t\t// if we've made selections on the client, transform these into more detailed selections.\r\n\t\t// the client-side selections are just facet fields and values without any labels - so we\r\n\t\t// need to combine this information with the list of facets received from the server in the\r\n\t\t// previous search in order to return a rich list of selections\r\n\r\n\t\tconst facets = searchResults ? searchResults.Facets : null;\r\n\r\n\t\tif (!facets) {\r\n\t\t\t// but we can only do this if we've received facet information from the server. without this\r\n\t\t\t// info we can't determine what labels should be used\r\n\t\t\treturn selections;\r\n\t\t}\r\n\r\n\t\t// manually handle the `searchWithin` selection, as this doesn't usually behave like a normal facet selection\r\n\t\t// but instead a field on the search request\r\n\t\tif (SearchWithin) {\r\n\t\t\tconst facet = facets.find(f => f.selectionField === 'searchWithin');\r\n\r\n\t\t\tif (facet) {\r\n\t\t\t\tselections.searchWithin = {\r\n\t\t\t\t\tfacet,\r\n\t\t\t\t\tlabel: facet.Name,\r\n\t\t\t\t\titems: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlabel: SearchWithin,\r\n\t\t\t\t\t\t\tvalue: SearchWithin,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!clientSelections) {\r\n\t\t\treturn selections;\r\n\t\t}\r\n\r\n\t\tObject.keys(clientSelections).forEach(fieldName => {\r\n\t\t\tconst selectionValues = clientSelections[fieldName];\r\n\r\n\t\t\tif (!selectionValues) {\r\n\t\t\t\t// if this selection has no values, it's not really selected\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst facet = facets.find(f => f.selectionField === fieldName);\r\n\r\n\t\t\tif (!facet) {\r\n\t\t\t\t// if there's no matching facet from the server, we can't show this since we'll have no labels\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst items: ClientSelectionValue[] = [];\r\n\r\n\t\t\tif (facet.FieldType === 'range') {\r\n\t\t\t\t// if the facet this selection is for is a range, there won't be a matching value and thus there won't be a label.\r\n\t\t\t\t// so because of this we'll just use the selection value as the label\r\n\r\n\t\t\t\tselectionValues.forEach(selectionValue => {\r\n\t\t\t\t\titems.push({\r\n\t\t\t\t\t\tlabel: selectionValue,\r\n\t\t\t\t\t\tvalue: selectionValue,\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else if (facet.FieldType === 'tab') {\r\n\t\t\t\t// do not return the selection value for tab facet\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\t// for other types of facets, try to find a matching value\r\n\r\n\t\t\t\tselectionValues.forEach(selectionValue => {\r\n\t\t\t\t\tconst matchingVal = this.findMatchingValue(selectionValue, facet.Values);\r\n\r\n\t\t\t\t\tif (!matchingVal || !matchingVal.Label) {\r\n\t\t\t\t\t\t// if there's no matching value from the server, we cannot display because there would\r\n\t\t\t\t\t\t// be no label - same if there's no label at all\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\titems.push({\r\n\t\t\t\t\t\tlabel: matchingVal.Label,\r\n\t\t\t\t\t\tvalue: selectionValue,\r\n\t\t\t\t\t\tpath: matchingVal.Path,\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tselections[fieldName] = {\r\n\t\t\t\tfacet,\r\n\t\t\t\tlabel: facet.Name,\r\n\t\t\t\titems,\r\n\t\t\t};\r\n\t\t});\r\n\r\n\t\treturn selections;\r\n\t}\r\n\r\n\tprivate findMatchingValue(selectionValue: string, facetValues: Value[]): Value | null {\r\n\t\tlet matchingValue: Value | null = null;\r\n\t\tif (!facetValues || facetValues.length === 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tfor (const facetValue of facetValues) {\r\n\t\t\tconst isMatchingVal = facetValue.Value === selectionValue || `-${facetValue.Value}` === selectionValue;\r\n\t\t\t// loop through children\r\n\t\t\tif (!isMatchingVal) {\r\n\t\t\t\tmatchingValue = this.findMatchingValue(selectionValue, facetValue.Children);\r\n\t\t\t} else {\r\n\t\t\t\tmatchingValue = facetValue;\r\n\t\t\t}\r\n\r\n\t\t\tif (matchingValue) {\r\n\t\t\t\treturn matchingValue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn matchingValue;\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport { ControllerStateAndHelpers } from 'downshift';\r\n\r\nimport { useHawkConfig } from 'components/ConfigProvider';\r\nimport { Product } from 'models/Autocomplete';\r\nimport SearchBoxBase from 'components/ui/SearchBox/SearchBoxBase';\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { CustomSuggestionListProps } from 'models/Autocomplete/CustomSuggestionList';\r\n\r\ninterface SearchBoxProps {\r\n\tSuggestionList?: React.ComponentType<CustomSuggestionListProps>;\r\n}\r\n\r\n/**\r\n * This component is a simple search input box (with autosuggest) that can be placed globally throughout the site.\r\n * This search box is intended to be used on non-search pages. On search pages, the `SearchBox` component should be\r\n * used instead.\r\n */\r\nfunction GlobalSearchBox({ SuggestionList }: SearchBoxProps) {\r\n\tconst { config } = useHawkConfig();\r\n\tconst { store, actor } = useHawksearch();\r\n\r\n\tconst searchUrl = config.searchPageUrl;\r\n\r\n\tfunction handleSubmit(event: React.KeyboardEvent<HTMLInputElement>, downshift: ControllerStateAndHelpers<Product>) {\r\n\t\tconst { inputValue } = downshift;\r\n\r\n\t\tif (event.key === 'Enter') {\r\n\t\t\tlet redirect = `${searchUrl}?keyword=${inputValue}`;\r\n\r\n\t\t\tif (config.indexName) {\r\n\t\t\t\tredirect += '&indexName=' + config.indexName;\r\n\t\t\t}\r\n\r\n\t\t\tif (store.language) {\r\n\t\t\t\tredirect += '&language=' + store.language;\r\n\t\t\t}\r\n\r\n\t\t\tlocation.assign(redirect);\r\n\t\t}\r\n\t}\r\n\r\n\t// On select view all matches from suggestions list\r\n\tfunction handleViewAllMatches(downshift: ControllerStateAndHelpers<Product>) {\r\n\t\tconst { inputValue, closeMenu } = downshift;\r\n\t\tactor.setSearch({\r\n\t\t\tPageId: undefined,\r\n\t\t\tCustomUrl: undefined,\r\n\t\t\tKeyword: inputValue || '',\r\n\t\t});\r\n\t\tcloseMenu();\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"hawk hawk__searchBox\">\r\n\t\t\t<SearchBoxBase\r\n\t\t\t\tonSubmit={handleSubmit}\r\n\t\t\t\tonViewMatches={handleViewAllMatches}\r\n\t\t\t\tSuggestionList={SuggestionList}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default GlobalSearchBox;\r\n","//\r\n// this file is the entry point for the searchbox application when running the minified bundle\r\n//\r\n\r\nimport '@babel/polyfill';\r\nimport 'url-search-params-polyfill';\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport { HawksearchConfig } from 'types/HawksearchConfig';\r\nimport ConfigProvider from 'components/ConfigProvider';\r\nimport GlobalSearchBox from 'components/ui/SearchBox/GlobalSearchBox';\r\n\r\ndeclare global {\r\n\tinterface Window {\r\n\t\tHawksearch?: HawksearchConfig;\r\n\t}\r\n}\r\n\r\nif (window.Hawksearch) {\r\n\tinitializeSearchBox(window.Hawksearch);\r\n}\r\n\r\nexport function initializeSearchBox(config: HawksearchConfig) {\r\n\tif (!config.searchBoxElement) {\r\n\t\tthrow new Error('window.Hawksearch.searchBoxElement has not been configured');\r\n\t}\r\n\r\n\tconst renderElem =\r\n\t\ttypeof config.searchBoxElement === 'string'\r\n\t\t\t? document.getElementById(config.searchBoxElement)\r\n\t\t\t: config.searchBoxElement;\r\n\r\n\tReactDOM.render(\r\n\t\t<ConfigProvider config={config}>\r\n\t\t\t<GlobalSearchBox />\r\n\t\t</ConfigProvider>,\r\n\t\trenderElem\r\n\t);\r\n}\r\n","import * as React from 'react';\r\n\r\ninterface PlusSVGProps {\r\n\tclass?: string;\r\n}\r\n\r\n/**\r\n * Plus SVG\r\n *\r\n * @returns\r\n */\r\nfunction PlusSVG(props: PlusSVGProps) {\r\n\treturn (\r\n\t\t<svg viewBox=\"0 0 32 32\" className={'icon ' + props.class} focusable=\"false\" aria-hidden=\"true\">\r\n\t\t\t<path d=\"M31 12h-11v-11c0-0.552-0.448-1-1-1h-6c-0.552 0-1 0.448-1 1v11h-11c-0.552 0-1 0.448-1 1v6c0 0.552 0.448 1 1 1h11v11c0 0.552 0.448 1 1 1h6c0.552 0 1-0.448 1-1v-11h11c0.552 0 1-0.448 1-1v-6c0-0.552-0.448-1-1-1z\" />\r\n\t\t</svg>\r\n\t);\r\n}\r\n\r\nexport default PlusSVG;\r\n","import * as React from 'react';\r\n\r\ninterface MinusSVGProps {\r\n\tclass?: string;\r\n}\r\n\r\n/**\r\n * Minus SVG\r\n *\r\n * @returns\r\n */\r\nfunction MinusSVG(props: MinusSVGProps) {\r\n\treturn (\r\n\t\t<svg viewBox=\"0 0 32 32\" className={'icon ' + props.class} focusable=\"false\" aria-hidden=\"true\">\r\n\t\t\t<path d=\"M0 13v6c0 0.552 0.448 1 1 1h30c0.552 0 1-0.448 1-1v-6c0-0.552-0.448-1-1-1h-30c-0.552 0-1 0.448-1 1z\" />\r\n\t\t</svg>\r\n\t);\r\n}\r\n\r\nexport default MinusSVG;\r\n","import * as React from 'react';\r\n\r\ninterface QuestionmarkSVGProps {\r\n\tclass: string;\r\n}\r\n\r\n/**\r\n * Questionmark SVG\r\n *\r\n * @returns\r\n */\r\nfunction QuestionmarkSVG(props: QuestionmarkSVGProps) {\r\n\treturn (\r\n\t\t<svg viewBox=\"0 0 32 32\" className={'icon ' + props.class} focusable=\"false\" aria-hidden=\"true\">\r\n\t\t\t<path d=\"M 10.976562 14.785156 C 10.976562 15.324219 10.539062 15.761719 10 15.761719 C 9.460938 15.761719 9.023438 15.324219 9.023438 14.785156 C 9.023438 14.246094 9.460938 13.808594 10 13.808594 C 10.539062 13.808594 10.976562 14.246094 10.976562 14.785156 Z M 10.976562 14.785156 \" />\r\n\t\t\t<path d=\"M 10 0 C 4.472656 0 0 4.472656 0 10 C 0 15.527344 4.472656 20 10 20 C 15.527344 20 20 15.527344 20 10 C 20 4.472656 15.527344 0 10 0 Z M 10 18.4375 C 5.335938 18.4375 1.5625 14.664062 1.5625 10 C 1.5625 5.335938 5.335938 1.5625 10 1.5625 C 14.664062 1.5625 18.4375 5.335938 18.4375 10 C 18.4375 14.664062 14.664062 18.4375 10 18.4375 Z M 10 18.4375 \" />\r\n\t\t\t<path d=\"M 10 5.019531 C 8.277344 5.019531 6.875 6.421875 6.875 8.144531 C 6.875 8.574219 7.226562 8.925781 7.65625 8.925781 C 8.085938 8.925781 8.4375 8.574219 8.4375 8.144531 C 8.4375 7.28125 9.136719 6.582031 10 6.582031 C 10.863281 6.582031 11.5625 7.28125 11.5625 8.144531 C 11.5625 9.007812 10.863281 9.707031 10 9.707031 C 9.570312 9.707031 9.21875 10.058594 9.21875 10.488281 L 9.21875 12.441406 C 9.21875 12.871094 9.570312 13.222656 10 13.222656 C 10.429688 13.222656 10.78125 12.871094 10.78125 12.441406 L 10.78125 11.171875 C 12.128906 10.824219 13.125 9.597656 13.125 8.144531 C 13.125 6.421875 11.722656 5.019531 10 5.019531 Z M 10 5.019531 \" />\r\n\t\t</svg>\r\n\t);\r\n}\r\n\r\nexport default QuestionmarkSVG;\r\n","import React, { useContext, useState, useRef, MouseEvent } from 'react';\r\nimport { useCookies } from 'react-cookie';\r\nimport { Facet as FacetModel, Value } from 'models/Facets';\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport PlusSVG from 'components/svg/PlusSVG';\r\nimport MinusSVG from 'components/svg/MinusSVG';\r\nimport QuestionmarkSVG from 'components/svg/QuestionmarkSVG';\r\n\r\nconst FacetContext = React.createContext({} as FacetContextValue);\r\n\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nexport interface FacetProps {\r\n\tfacet: FacetModel;\r\n\tchildren: React.ReactNode;\r\n}\r\n\r\ninterface FacetContextValue {\r\n\t/** The facet model returned from the server for this facet. */\r\n\tfacet: FacetModel;\r\n\r\n\t/** Returns the state of the parent facet container. */\r\n\tstate: FacetState;\r\n\r\n\t/** An actor interface to perform actions for this facet. */\r\n\tactor: FacetActor;\r\n\r\n\trenderer: FacetRenderer;\r\n}\r\n\r\nexport interface FacetState {\r\n\t/**\r\n\t * An array of facet values for this facet. If this facet has a quick lookup search bar, this list\r\n\t * will be filtered by this quick lookup.\r\n\t */\r\n\tfacetValues: Value[];\r\n\r\n\t/**\r\n\t * If the facet is configured for filtering, this is the user's entered filter value. Updated on\r\n\t * immediately when the user types.\r\n\t */\r\n\tfilter: string;\r\n\r\n\t/** Whether or not this facet has its values truncated. */\r\n\tisTruncated: boolean;\r\n\t/** Whether or not this facet is collapsed. */\r\n\tisCollapsed: boolean;\r\n\t/** If filter is enabled, contains the number of facets that are truncated. */\r\n\tremainingFacets: number;\r\n\r\n\t// It shows the decimal count in slider\r\n\tdecimalPrecision: number;\r\n}\r\n\r\nexport interface FacetActor {\r\n\t/** Select the given facet value. */\r\n\tselectFacet(facetValue: Value | string): void;\r\n\t/** Selects and negates the given facet value. */\r\n\tnegateFacet(facetValue: Value | string): void;\r\n\r\n\t/** Sets the selected facet values by replacing existing selections for this facet.  */\r\n\tsetFacets(facetValues: Value[] | string[]): void;\r\n\r\n\t/** Sets the filter for this facet container. */\r\n\tsetFilter(filter: string): void;\r\n\r\n\t/** Sets whether or not this facet is currently being truncated. */\r\n\tsetTruncated(truncated: boolean): void;\r\n\t/** Sets whether or not this facet is currently collapsed. */\r\n\tsetCollapsed(collapsed: boolean): void;\r\n}\r\n\r\nexport interface FacetRenderer {\r\n\t/**\r\n\t * Conditionally renders the default truncation UI (the \"Show More\"/\"Show Less\" buttons). Nothing will render\r\n\t * if the facet is configured to not be truncated.\r\n\t */\r\n\trenderTruncation();\r\n}\r\n\r\nfunction getInitialCollapsibleState(facet: FacetModel, cookies: { [key: string]: string }) {\r\n\tconst cookieValue = cookies[facet.Field];\r\n\tif (cookieValue !== undefined) {\r\n\t\treturn cookieValue === 'true'; // Convert string to boolean\r\n\t}\r\n\treturn facet.IsCollapsible && facet.IsCollapsedDefault;\r\n}\r\n\r\nfunction Facet({ facet, children }: FacetProps) {\r\n\tconst { actor: searchActor } = useHawksearch();\r\n\tconst wrapperRef = useRef<HTMLInputElement>(null);\r\n\tconst [filter, setFilter] = useState('');\r\n\tconst [isTruncated, setTruncated] = useState(facet.shouldTruncate);\r\n\tconst [cookies, setCookie] = useCookies([facet.Field]);\r\n\tconst [isCollapsed, setCollapsed] = useState(getInitialCollapsibleState(facet, cookies));\r\n\tconst { t, i18n } = useTranslation();\r\n\r\n\tfunction selectFacet(facetValue: Value | string): void {\r\n\t\tsetFilter('');\r\n\t\tsearchActor.toggleFacetValue(facet, facetValue);\r\n\t}\r\n\r\n\tfunction setFacets(values: Value[] | string[]): void {\r\n\t\tsetFilter('');\r\n\t\tsearchActor.setFacetValues(facet, values);\r\n\t}\r\n\r\n\tfunction negateFacet(facetValue: Value | string): void {\r\n\t\tsetFilter('');\r\n\t\tsearchActor.toggleFacetValue(facet, facetValue, /* negate */ true);\r\n\t}\r\n\r\n\tfunction renderTruncation() {\r\n\t\t// only show the toggle button if the facet is configured for truncation and we're not filtering\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t{facet.shouldTruncate && !filter && (\r\n\t\t\t\t\t<button onClick={() => actor.setTruncated(!isTruncated)} className=\"hawk-facet-rail__show-more-btn\">\r\n\t\t\t\t\t\t{isTruncated ? `(+) Show ${remainingFacets} More` : '(-) Show Less'}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\t// TODO: sort facet values\r\n\tlet facetValues = facet.Values;\r\n\r\n\t// first, perform any filtering if enabled and a filter has been typed in\r\n\tif (facet.shouldSearch && filter) {\r\n\t\tfacetValues = facet.Values.filter(val => {\r\n\t\t\tif (!val.Label) {\r\n\t\t\t\t// if a facet value doesn't have a label, we can't really filter down to it\r\n\t\t\t\t// so exclude it\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn val.Label.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\r\n\t\t});\r\n\t}\r\n\r\n\t// next, handle truncation\r\n\tlet remainingFacets = 0;\r\n\r\n\tif (facet.shouldTruncate && isTruncated) {\r\n\t\tconst valuesBeforeTrunc = facetValues.length;\r\n\r\n\t\tfacetValues = facetValues.slice(0, facet.TruncateThreshold);\r\n\r\n\t\tremainingFacets = valuesBeforeTrunc - facet.TruncateThreshold;\r\n\t}\r\n\r\n\tconst actor: FacetActor = {\r\n\t\tselectFacet,\r\n\t\tnegateFacet,\r\n\r\n\t\tsetFacets,\r\n\r\n\t\tsetFilter,\r\n\r\n\t\tsetTruncated,\r\n\t\tsetCollapsed,\r\n\t};\r\n\r\n\tconst state: FacetState = {\r\n\t\tfacetValues,\r\n\r\n\t\tfilter,\r\n\r\n\t\tisTruncated,\r\n\t\tisCollapsed,\r\n\t\tremainingFacets,\r\n\t\tdecimalPrecision: 2,\r\n\t};\r\n\r\n\tconst renderer: FacetRenderer = {\r\n\t\trenderTruncation,\r\n\t};\r\n\r\n\tfunction toggleCollapsible(event: MouseEvent) {\r\n\t\tif (wrapperRef.current && wrapperRef.current.contains(event.target as Node)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsetCookie(facet.Field, !isCollapsed);\r\n\t\tsetCollapsed(!isCollapsed);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<FacetContext.Provider value={{ facet, state, actor, renderer }}>\r\n\t\t\t<div className=\"hawk-facet-rail__facet\">\r\n\t\t\t\t<div className=\"hawk-facet-rail__facet-heading\" onClick={event => toggleCollapsible(event)}>\r\n\t\t\t\t\t<h4>{facet.Name}</h4>\r\n\t\t\t\t\t{facet.Tooltip && (\r\n\t\t\t\t\t\t<div className=\"custom-tooltip\" ref={wrapperRef}>\r\n\t\t\t\t\t\t\t<QuestionmarkSVG class=\"hawk-questionmark\" />\r\n\t\t\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t\t\t<div dangerouslySetInnerHTML={{ __html: facet.Tooltip }} />\r\n\t\t\t\t\t\t\t\t<i />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{isCollapsed ? (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<PlusSVG /> <span className=\"visually-hidden\">Expand facet category</span>{' '}\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<MinusSVG /> <span className=\"visually-hidden\">Collapse facet category</span>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{!isCollapsed && (\r\n\t\t\t\t\t<div className=\"hawk-facet-rail__facet-body\">\r\n\t\t\t\t\t\t{facet.shouldSearch && (\r\n\t\t\t\t\t\t\t<div className=\"hawk-facet-rail__facet__quick-lookup\">\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\tvalue={filter}\r\n\t\t\t\t\t\t\t\t\tonChange={e => setFilter(e.currentTarget.value)}\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\tplaceholder={t('Quick Lookup')}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{/* render listing component */}\r\n\t\t\t\t\t\t{children}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</FacetContext.Provider>\r\n\t);\r\n}\r\n\r\nexport function useFacet() {\r\n\treturn useContext(FacetContext);\r\n}\r\n\r\nexport default Facet;\r\n","import * as React from 'react';\r\n\r\ninterface DashCircleSVGProps {\r\n\tclass?: string;\r\n}\r\n\r\n/**\r\n * Dash circle SVG\r\n *\r\n * @returns\r\n */\r\nfunction DashCircleSVG(props: DashCircleSVGProps) {\r\n\treturn (\r\n\t\t<svg\r\n\t\t\tviewBox=\"0 0 32 32\"\r\n\t\t\tclassName={'icon icon-help-header ' + props.class}\r\n\t\t\tfocusable=\"false\"\r\n\t\t\taria-hidden=\"true\"\r\n\t\t>\r\n\t\t\t<path\r\n\t\t\t\tfill=\"#5c5c5c\"\r\n\t\t\t\td=\"M16 0c8.837 0 16 7.163 16 16s-7.163 16-16 16c-8.837 0-16-7.163-16-16v0c0-8.837 7.163-16 16-16v0z\"\r\n\t\t\t/>\r\n\t\t\t<path\r\n\t\t\t\tfill=\"#fff\"\r\n\t\t\t\td=\"M21.51 17.594h-11.733c-0.884 0-1.6-0.716-1.6-1.6s0.716-1.6 1.6-1.6h11.733c0.884 0 1.6 0.716 1.6 1.6s-0.716 1.6-1.6 1.6z\"\r\n\t\t\t/>\r\n\t\t</svg>\r\n\t);\r\n}\r\n\r\nexport default DashCircleSVG;\r\n","import * as React from 'react';\r\n\r\ninterface CheckmarkSVGProps {\r\n\tclass: string;\r\n}\r\n\r\n/**\r\n * Checkmark SVG\r\n *\r\n * @returns\r\n */\r\nfunction CheckmarkSVG(props: CheckmarkSVGProps) {\r\n\treturn (\r\n\t\t<svg viewBox=\"0 0 32 32\" className={'icon ' + props.class} focusable=\"false\" aria-hidden=\"true\">\r\n\t\t\t<path d=\"M27 4l-15 15-7-7-5 5 12 12 20-20z\" />\r\n\t\t</svg>\r\n\t);\r\n}\r\n\r\nexport default CheckmarkSVG;\r\n","import * as React from 'react';\r\n\r\ninterface PlusCircleSVGProps {\r\n\tclass: string;\r\n}\r\n\r\n/**\r\n * Plus SVG\r\n *\r\n * @returns\r\n */\r\nfunction PlusCircleSVG(props: PlusCircleSVGProps) {\r\n\treturn (\r\n\t\t<svg viewBox=\"0 0 20 20\" className={'icon ' + props.class} focusable=\"false\" aria-hidden=\"true\">\r\n\t\t\t<path d=\"M11 9v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zM10 20c-5.523 0-10-4.477-10-10s4.477-10 10-10v0c5.523 0 10 4.477 10 10s-4.477 10-10 10v0z\" />\r\n\t\t</svg>\r\n\t);\r\n}\r\n\r\nexport default PlusCircleSVG;\r\n","import React from 'react';\r\n\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport { FacetSelectionState } from 'store/Store';\r\nimport DashCircleSVG from 'components/svg/DashCircleSVG';\r\nimport CheckmarkSVG from 'components/svg/CheckmarkSVG';\r\nimport PlusCircleSVG from 'components/svg/PlusCircleSVG';\r\nimport { useHawkConfig } from 'components/ConfigProvider';\r\n\r\nenum FacetRangeDisplayType {\r\n\tText = 1,\r\n\tImage = 2,\r\n\tBoth = 3,\r\n}\r\n\r\nfunction Checkbox() {\r\n\tconst { store } = useHawksearch();\r\n\tconst { config } = useHawkConfig();\r\n\r\n\tconst {\r\n\t\tfacet,\r\n\t\tstate: { facetValues },\r\n\t\tactor,\r\n\t\trenderer,\r\n\t} = useFacet();\r\n\r\n\tfunction renderOptions() {\r\n\t\tif (facet.FieldType === 'range') {\r\n\t\t\treturn facetValues.map(value => {\r\n\t\t\t\tconst correspondingRange = facet.Ranges.find(c => c.Value === value.Value);\r\n\t\t\t\tconst rangeValueAssetUrl = correspondingRange\r\n\t\t\t\t\t? config.dashboardUrl + correspondingRange.AssetFullUrl\r\n\t\t\t\t\t: '';\r\n\r\n\t\t\t\t// facets can be selected or negated, so explicitly check that the facet is not selected\r\n\t\t\t\tconst selectionState = store.isFacetSelected(facet, value).state;\r\n\r\n\t\t\t\tconst isSelected = selectionState !== FacetSelectionState.NotSelected;\r\n\t\t\t\tconst isNegated = selectionState === FacetSelectionState.Negated;\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<li key={value.Value} className=\"hawk-facet-rail__facet-list-item\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={e => actor.selectFacet(value)}\r\n\t\t\t\t\t\t\tclassName=\"hawk-facet-rail__facet-btn\"\r\n\t\t\t\t\t\t\taria-pressed={isSelected}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{renderCheckMark(isSelected)}\r\n\t\t\t\t\t\t\t{rangeValueAssetUrl !== '' ? (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<span className=\"hawk-selectionInner\">\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"hawk-range-asset\" title={value.Label} />\r\n\t\t\t\t\t\t\t\t\t\t{FacetRangeDisplayType.Text !== facet.FacetRangeDisplayType && (\r\n\t\t\t\t\t\t\t\t\t\t\t<img src={rangeValueAssetUrl} alt={value.Label} />\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\tstyle={isNegated ? { textDecoration: 'line-through' } : undefined}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"hawk-facet-rail__facet-name\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{value.Label} ({value.Count})\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\tstyle={isNegated ? { textDecoration: 'line-through' } : undefined}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"hawk-facet-rail__facet-name\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{value.Label} ({value.Count})\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t{renderFacetActions(value.Value || '', isNegated)}\r\n\t\t\t\t\t</li>\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\treturn facetValues.map(value => {\r\n\t\t\t\t// facets can be selected or negated, so explicitly check that the facet is not selected\r\n\t\t\t\tconst selectionState = store.isFacetSelected(facet, value).state;\r\n\r\n\t\t\t\tconst isSelected = selectionState !== FacetSelectionState.NotSelected;\r\n\t\t\t\tconst isNegated = selectionState === FacetSelectionState.Negated;\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<li key={value.Value} className=\"hawk-facet-rail__facet-list-item\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={e => actor.selectFacet(value)}\r\n\t\t\t\t\t\t\tclassName=\"hawk-facet-rail__facet-btn\"\r\n\t\t\t\t\t\t\taria-pressed={isSelected}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{renderCheckMark(isSelected)}\r\n\r\n\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\tstyle={isNegated ? { textDecoration: 'line-through' } : undefined}\r\n\t\t\t\t\t\t\t\tclassName=\"hawk-facet-rail__facet-name\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{value.Label} ({value.Count})\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t{renderFacetActions(value.Value || '', isNegated)}\r\n\t\t\t\t\t</li>\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction renderCheckMark(isSelected: boolean) {\r\n\t\treturn (\r\n\t\t\t<span\r\n\t\t\t\tclassName={\r\n\t\t\t\t\tisSelected\r\n\t\t\t\t\t\t? 'hawk-facet-rail__facet-checkbox hawk-facet-rail__facet-checkbox--checked'\r\n\t\t\t\t\t\t: 'hawk-facet-rail__facet-checkbox'\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t{isSelected ? <CheckmarkSVG class=\"hawk-facet-rail__facet-checkbox-icon\" /> : null}\r\n\t\t\t</span>\r\n\t\t);\r\n\t}\r\n\tfunction renderFacetActions(value: string, isNegated: boolean) {\r\n\t\treturn (\r\n\t\t\t<button onClick={e => actor.negateFacet(value)} className=\"hawk-facet-rail__facet-btn-exclude\">\r\n\t\t\t\t{isNegated ? (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<PlusCircleSVG class=\"hawk-facet-rail__facet-btn-include\" />\r\n\t\t\t\t\t\t<span className=\"visually-hidden\">Include facet</span>\r\n\t\t\t\t\t</>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<DashCircleSVG />\r\n\t\t\t\t\t\t<span className=\"visually-hidden\">Exclude facet</span>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</button>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"hawk-facet-rail__facet-values\">\r\n\t\t\t<div className=\"hawk-facet-rail__facet-values-checkbox\">\r\n\t\t\t\t<ul className=\"hawk-facet-rail__facet-list\">{renderOptions()}</ul>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* render the default truncation control as we don't need to customize this */}\r\n\t\t\t{renderer.renderTruncation()}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default Checkbox;\r\n","import React, { useState } from 'react';\r\n\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nfunction Search() {\r\n\tconst { store, actor: hawkActor } = useHawksearch();\r\n\tconst { facet, actor } = useFacet();\r\n\r\n\tconst [input, setInput] = useState<string | undefined>(undefined);\r\n\r\n\tconst { t, i18n } = useTranslation();\r\n\r\n\tfunction onKeyDown(event: React.KeyboardEvent<HTMLInputElement>) {\r\n\t\tif (event.key === 'Enter') {\r\n\t\t\tsetInput(undefined); // clear the user's entered value as we want to be driven by the store again\r\n\r\n\t\t\tactor.selectFacet(event.currentTarget.value);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction clearFacet() {\r\n\t\tsetInput(undefined); // clear the user's entered value as we want to be driven by the store again\r\n\r\n\t\thawkActor.clearFacet(facet);\r\n\t}\r\n\r\n\tfunction getInputValue() {\r\n\t\tif (input !== undefined) {\r\n\t\t\t// if the user type an input, that's the value for the input\r\n\t\t\treturn input;\r\n\t\t}\r\n\r\n\t\t// otherwise, use the value from the store\r\n\t\treturn decodeURIComponent(store.pendingSearch.SearchWithin || '');\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className=\"hawk-facet-rail__facet-values\">\r\n\t\t\t\t<div className=\"hawk-facet-rail__facet-values__search\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tvalue={getInputValue()}\r\n\t\t\t\t\t\tonChange={e => setInput(e.currentTarget.value)}\r\n\t\t\t\t\t\tonKeyDown={onKeyDown}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t{store.pendingSearch.SearchWithin && (\r\n\t\t\t\t<div className=\"hawk-facet-rail__facet-values__search-clear\">\r\n\t\t\t\t\t<button className=\"link-button\" onClick={clearFacet}>\r\n\t\t\t\t\t\t{t('Clear')}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default Search;\r\n","import React from 'react';\r\n\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport { FacetSelectionState } from 'store/Store';\r\nimport { Value } from 'models/Facets';\r\n\r\nfunction Link() {\r\n\tconst { store } = useHawksearch();\r\n\tconst {\r\n\t\tfacet,\r\n\t\tstate: { facetValues },\r\n\t\tactor,\r\n\t\trenderer,\r\n\t} = useFacet();\r\n\r\n\tfunction setLinkFacet(value: Value, selectionState: number) {\r\n\t\tif (selectionState) {\r\n\t\t\t// Deselect the facet\r\n\t\t\tactor.selectFacet(value);\r\n\t\t} else {\r\n\t\t\t// Select the facet\r\n\t\t\tactor.setFacets([value]);\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"hawk-facet-rail__facet-values\">\r\n\t\t\t<div className=\"hawk-facet-rail__facet-values-link\">\r\n\t\t\t\t<ul className=\"hawk-facet-rail__facet-list\">\r\n\t\t\t\t\t{facetValues.map(value => {\r\n\t\t\t\t\t\t// facets can be selected or negated, so explicitly check that the facet is not selected\r\n\t\t\t\t\t\tconst selectionState = store.isFacetSelected(facet, value).state;\r\n\r\n\t\t\t\t\t\tconst isSelected = selectionState !== FacetSelectionState.NotSelected;\r\n\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<li key={value.Value} className=\"hawk-facet-rail__facet-list-item\">\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tonClick={e => setLinkFacet(value, selectionState)}\r\n\t\t\t\t\t\t\t\t\tclassName={\r\n\t\t\t\t\t\t\t\t\t\tisSelected\r\n\t\t\t\t\t\t\t\t\t\t\t? 'hawk-facet-rail__facet-btn selected'\r\n\t\t\t\t\t\t\t\t\t\t\t: 'hawk-facet-rail__facet-btn'\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\taria-pressed={isSelected}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<span className=\"hawk-facet-rail__facet-name\">\r\n\t\t\t\t\t\t\t\t\t\t{value.Label} ({value.Count})\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* render the default truncation control as we don't need to customize this */}\r\n\t\t\t{renderer.renderTruncation()}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default Link;\r\n","import React, { useState, useEffect } from 'react';\r\n\r\nfunction formatDate(unixFormat: number) {\r\n\tconst date = new Date(unixFormat);\r\n\tconst year = date.getFullYear().toString();\r\n\tconst month = (date.getMonth() + 101).toString().substring(1);\r\n\tconst day = (date.getDate() + 100).toString().substring(1);\r\n\treturn year + '-' + month + '-' + day;\r\n}\r\nexport interface SliderCalendarInputsProps {\r\n\tmin: number;\r\n\tmax: number;\r\n\tvalues: number[];\r\n\tonValueChange(minValue: number, maxValue: number): void;\r\n}\r\nfunction SliderCalendarInputs(sliderProps: SliderCalendarInputsProps) {\r\n\tconst [minValue, setMinValue] = useState(0);\r\n\tconst [maxValue, setMaxValue] = useState(0);\r\n\r\n\tfunction onMinUpdate(event: any) {\r\n\t\tconst value = new Date(event.target.value).getTime();\r\n\r\n\t\tconst newMinValue = Number(value);\r\n\t\tif (isNaN(newMinValue) || minValue === value) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetMinValue(value);\r\n\t\tsliderProps.onValueChange(Number(newMinValue), Number(maxValue));\r\n\t}\r\n\r\n\tfunction onMaxUpdate(event: any) {\r\n\t\tconst value = new Date(event.target.value).getTime();\r\n\r\n\t\tconst newMaxValue = Number(value);\r\n\t\tif (isNaN(newMaxValue) || maxValue === value) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsetMaxValue(value);\r\n\t\tsliderProps.onValueChange(Number(minValue), Number(newMaxValue));\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tsetMinValue(sliderProps.values[0]);\r\n\t\tsetMaxValue(sliderProps.values[1]);\r\n\t}, [sliderProps]);\r\n\treturn (\r\n\t\t<div className=\"hawk-sliderNumeric\">\r\n\t\t\t<input\r\n\t\t\t\ttype=\"date\"\r\n\t\t\t\tvalue={formatDate(Number(minValue))}\r\n\t\t\t\tclassName=\"hawk-text-input hawk-date-value-start\"\r\n\t\t\t\tmin={formatDate(sliderProps.min)}\r\n\t\t\t\tmax={formatDate(sliderProps.max)}\r\n\t\t\t\tonChange={onMinUpdate}\r\n\t\t\t/>\r\n\r\n\t\t\t<input\r\n\t\t\t\ttype=\"date\"\r\n\t\t\t\tvalue={formatDate(Number(maxValue))}\r\n\t\t\t\tclassName=\"hawk-text-input hawk-date-value-end\"\r\n\t\t\t\tmin={formatDate(sliderProps.min)}\r\n\t\t\t\tmax={formatDate(sliderProps.max)}\r\n\t\t\t\tonChange={onMaxUpdate}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default SliderCalendarInputs;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { PublicState } from 'rheostat';\r\n\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport SliderCalendarInputs from '../SliderCalendarInputs';\r\nconst Rheostat = React.lazy(() => import(/* webpackChunkName: \"rheostat\" */ 'rheostat'));\r\n\r\nfunction formatDate(date: Date) {\r\n\tconst year = date.getFullYear().toString();\r\n\tconst month = (date.getMonth() + 101).toString().substring(1);\r\n\tconst day = (date.getDate() + 100).toString().substring(1);\r\n\treturn year + '-' + month + '-' + day;\r\n}\r\n\r\nfunction replaceHyphen(date: string) {\r\n\tif (!date) {\r\n\t\treturn date;\r\n\t}\r\n\treturn date.replace(/-/g, '/');\r\n}\r\n\r\nfunction getTime(date) {\r\n\treturn date && Number(new Date(date || '').getTime());\r\n}\r\n\r\nfunction SliderDate() {\r\n\tconst {\r\n\t\tstore: { facetSelections },\r\n\t} = useHawksearch();\r\n\r\n\tconst {\r\n\t\tstate: { facetValues, decimalPrecision },\r\n\t\tfacet,\r\n\t\tactor,\r\n\t} = useFacet();\r\n\t// the range of the slider is defined by the first facet value. or null if there is no first value\r\n\tconst range = facetValues.length > 0 ? facetValues[0] : null;\r\n\r\n\tconst [rangeMin, setMinRange] = useState(range && getTime(range.RangeMin));\r\n\tconst [rangeMax, setMaxRange] = useState(range && getTime(range.RangeMax));\r\n\tconst [rangeStart, setStartRange] = useState(range && getTime(range.RangeStart));\r\n\tconst [rangeEnd, setEndRange] = useState(range && getTime(range.RangeEnd));\r\n\r\n\t// if there's no range, initialize to zeros\r\n\tconst [minValue, setMinValue] = useState<number>();\r\n\tconst [maxValue, setMaxValue] = useState<number>();\r\n\r\n\tuseEffect(() => {\r\n\t\tconst paramName = facet.ParamName || facet.Field;\r\n\r\n\t\t// clear min and max value if these were cleared\r\n\t\tif (!paramName || !(paramName in facetSelections)) {\r\n\t\t\tsetMinValue(undefined);\r\n\t\t\tsetMaxValue(undefined);\r\n\t\t}\r\n\t}, [facetSelections]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst newRange = facetValues.length > 0 ? facetValues[0] : null;\r\n\t\tsetMinRange(newRange && getTime(newRange.RangeMin));\r\n\t\tsetMaxRange(newRange && getTime(newRange.RangeMax));\r\n\t\tsetStartRange(newRange && getTime(newRange.RangeStart));\r\n\t\tsetEndRange(newRange && getTime(newRange.RangeEnd));\r\n\t}, [facetValues]);\r\n\r\n\tif (\r\n\t\trangeMin === null ||\r\n\t\tisNaN(rangeMin) ||\r\n\t\trangeMax === null ||\r\n\t\tisNaN(rangeMax) ||\r\n\t\trangeStart === null ||\r\n\t\tisNaN(rangeStart) ||\r\n\t\trangeEnd === null ||\r\n\t\tisNaN(rangeEnd)\r\n\t) {\r\n\t\t// this facet is somehow misconfigured so don't render\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfunction onSliderDrag(state: PublicState) {\r\n\t\tconst [newMin, newMax] = state.values;\r\n\t\tsetMinValue(newMin);\r\n\t\tsetMaxValue(newMax);\r\n\t}\r\n\r\n\tfunction onSliderValueChange(state: PublicState) {\r\n\t\tconst [newMin, newMax] = state.values;\r\n\r\n\t\tsetFacetValues(newMin, newMax);\r\n\t}\r\n\r\n\tfunction onValueChange(newMinValue: number, newMaxValue: number) {\r\n\t\tlet currentMinValue = minValue;\r\n\t\tlet currentMaxValue = maxValue;\r\n\t\t// if min value wasn't yet selected use range start\r\n\t\tif (minValue === undefined && rangeStart !== null) {\r\n\t\t\tcurrentMinValue = rangeStart; // setMinValue(rangeStart);\r\n\t\t}\r\n\r\n\t\t// if max value wasn't yet selected use range end\r\n\t\tif (maxValue === undefined && rangeEnd !== null) {\r\n\t\t\tcurrentMaxValue = rangeEnd;\r\n\t\t}\r\n\r\n\t\tif (currentMinValue === undefined || currentMaxValue === undefined) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (currentMinValue !== newMinValue && newMinValue <= currentMaxValue) {\r\n\t\t\tif (rangeMin !== null && newMinValue <= rangeMin) {\r\n\t\t\t\tcurrentMinValue = rangeMin;\r\n\t\t\t} else {\r\n\t\t\t\tcurrentMinValue = newMinValue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (currentMaxValue !== newMaxValue && newMaxValue >= currentMinValue) {\r\n\t\t\tif (rangeMax !== null && newMaxValue >= rangeMax) {\r\n\t\t\t\tcurrentMaxValue = rangeMax;\r\n\t\t\t} else {\r\n\t\t\t\tcurrentMaxValue = newMaxValue;\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetFacetValues(currentMinValue, currentMaxValue);\r\n\t}\r\n\r\n\tfunction setFacetValues(minVal: number | undefined, maxVal: number | undefined) {\r\n\t\tif (minVal === undefined || maxVal === undefined || isNaN(minVal) || isNaN(maxVal)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsetMinValue(minVal);\r\n\t\tsetMaxValue(maxVal);\r\n\r\n\t\tconst formattedMinVal = replaceHyphen(formatDate(new Date(minVal)));\r\n\t\tconst formattedMaxVal = replaceHyphen(formatDate(new Date(maxVal)));\r\n\r\n\t\t// this selection is sent to hawk separated by commas, so build the value here\r\n\t\tconst selection = `${formattedMinVal},${formattedMaxVal}`;\r\n\t\tactor.setFacets([selection]);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"hawk-facet-rail__facet-values\">\r\n\t\t\t<div className=\"hawk-facet-rail__facet-values-link\">\r\n\t\t\t\t<React.Suspense fallback={<div>Loading...</div>}>\r\n\t\t\t\t\t<SliderCalendarInputs\r\n\t\t\t\t\t\tmin={rangeMin}\r\n\t\t\t\t\t\tmax={rangeMax}\r\n\t\t\t\t\t\tvalues={[\r\n\t\t\t\t\t\t\tminValue === undefined ? rangeStart : Math.max(minValue, rangeMin),\r\n\t\t\t\t\t\t\tmaxValue === undefined ? rangeEnd : Math.min(maxValue, rangeMax),\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t\tonValueChange={onValueChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Rheostat\r\n\t\t\t\t\t\tmin={rangeMin}\r\n\t\t\t\t\t\tmax={rangeMax}\r\n\t\t\t\t\t\tvalues={[\r\n\t\t\t\t\t\t\tMath.floor(minValue === undefined ? rangeStart : Math.max(minValue, rangeMin)),\r\n\t\t\t\t\t\t\tMath.ceil(maxValue === undefined ? rangeEnd : Math.min(maxValue, rangeMax)),\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t\tonValuesUpdated={onSliderDrag}\r\n\t\t\t\t\t\tonChange={onSliderValueChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</React.Suspense>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default SliderDate;\r\n","import React, { useState, useEffect } from 'react';\r\nimport NumberFormat from 'react-number-format';\r\n\r\nexport interface SliderNumericInputsProps {\r\n\tmin: number;\r\n\tmax: number;\r\n\tvalues: number[];\r\n\tisCurrency: boolean;\r\n\tcurrencySymbol: string;\r\n\tdecimalPrecision: number;\r\n\tonValueChange(minValue: number, maxValue: number): void;\r\n}\r\nfunction SliderNumericInputs(sliderProps: SliderNumericInputsProps) {\r\n\tconst [minValue, setMinValue] = useState('' as string);\r\n\tconst [maxValue, setMaxValue] = useState('' as string);\r\n\r\n\tfunction onMinUpdate(values: any) {\r\n\t\tconst { formattedValue, value } = values;\r\n\r\n\t\tconst newMinValue = Number(value);\r\n\t\tif (isNaN(newMinValue) || minValue === value) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetMinValue(value);\r\n\t}\r\n\r\n\tfunction onMaxUpdate(values: any) {\r\n\t\tconst { formattedValue, value } = values;\r\n\r\n\t\tconst newMaxValue = Number(value);\r\n\t\tif (isNaN(newMaxValue) || maxValue === value) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsetMaxValue(value);\r\n\t}\r\n\tfunction reloadFacets(event: React.FormEvent<HTMLInputElement>) {\r\n\t\tsliderProps.onValueChange(Number(minValue), Number(maxValue));\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tsetMinValue(sliderProps.values[0].toString());\r\n\t\tsetMaxValue(sliderProps.values[1].toString());\r\n\t}, [sliderProps]);\r\n\r\n\treturn (\r\n\t\t<div className=\"hawk-sliderNumeric\">\r\n\t\t\t<NumberFormat\r\n\t\t\t\tthousandSeparator={sliderProps.isCurrency}\r\n\t\t\t\tprefix={sliderProps.isCurrency ? sliderProps.currencySymbol : ''}\r\n\t\t\t\tvalue={minValue}\r\n\t\t\t\tclassName=\"hawk-numericInput numeric-from\"\r\n\t\t\t\tmin={sliderProps.min}\r\n\t\t\t\tmax={sliderProps.max}\r\n\t\t\t\tonValueChange={onMinUpdate}\r\n\t\t\t\tonBlur={reloadFacets}\r\n\t\t\t\tdecimalScale={sliderProps.decimalPrecision}\r\n\t\t\t/>\r\n\r\n\t\t\t<NumberFormat\r\n\t\t\t\tthousandSeparator={sliderProps.isCurrency}\r\n\t\t\t\tprefix={sliderProps.isCurrency ? sliderProps.currencySymbol : ''}\r\n\t\t\t\tvalue={maxValue}\r\n\t\t\t\tclassName=\"hawk-numericInput numeric-to\"\r\n\t\t\t\tmin={sliderProps.min}\r\n\t\t\t\tmax={sliderProps.max}\r\n\t\t\t\tonValueChange={onMaxUpdate}\r\n\t\t\t\tonBlur={reloadFacets}\r\n\t\t\t\tdecimalScale={sliderProps.decimalPrecision}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default SliderNumericInputs;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { PublicState } from 'rheostat';\r\n\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport SliderNumericInputs from 'components/ui/Facets/SliderNumericInputs';\r\nconst Rheostat = React.lazy(() => import(/* webpackChunkName: \"rheostat\" */ 'rheostat'));\r\n\r\nfunction SliderNumeric() {\r\n\tconst {\r\n\t\tstore: { facetSelections },\r\n\t} = useHawksearch();\r\n\r\n\tconst {\r\n\t\tstate: { facetValues, decimalPrecision },\r\n\t\tfacet,\r\n\t\tactor,\r\n\t} = useFacet();\r\n\t// the range of the slider is defined by the first facet value. or null if there is no first value\r\n\tconst range = facetValues.length > 0 ? facetValues[0] : null;\r\n\r\n\tconst [rangeMin, setMinRange] = useState(range && Number(parseFloat(range.RangeMin || '').toFixed(2)));\r\n\tconst [rangeMax, setMaxRange] = useState(range && Number(parseFloat(range.RangeMax || '').toFixed(2)));\r\n\tconst [rangeStart, setStartRange] = useState(range && Number(parseFloat(range.RangeStart || '').toFixed(2)));\r\n\tconst [rangeEnd, setEndRange] = useState(range && Number(parseFloat(range.RangeEnd || '').toFixed(2)));\r\n\r\n\t// if there's no range, initialize to zeros\r\n\tconst [minValue, setMinValue] = useState<number>();\r\n\tconst [maxValue, setMaxValue] = useState<number>();\r\n\r\n\tconst [isCurency, setIsCurrency] = useState(facet.IsCurrency);\r\n\tconst [currencySymbol, setCurrencySymbol] = useState(facet.CurrencySymbol);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetCurrencySymbol(facet.CurrencySymbol || '$');\r\n\t\tsetIsCurrency(facet.IsCurrency);\r\n\t}, [facet]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst paramName = facet.ParamName || facet.Field;\r\n\r\n\t\t// clear min and max value if these were cleared\r\n\t\tif (!paramName || !(paramName in facetSelections)) {\r\n\t\t\tsetMinValue(undefined);\r\n\t\t\tsetMaxValue(undefined);\r\n\t\t} else if (\r\n\t\t\tparamName in facetSelections &&\r\n\t\t\tfacetSelections[paramName].items &&\r\n\t\t\tfacetSelections[paramName].items.length > 0\r\n\t\t) {\r\n\t\t\tconst selectedValues = facetSelections[paramName].items[0].value.split(',');\r\n\t\t\tsetMinValue(Number(selectedValues[0]));\r\n\t\t\tsetMaxValue(Number(selectedValues[1]));\r\n\t\t}\r\n\t}, [facetSelections]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst newRange = facetValues.length > 0 ? facetValues[0] : null;\r\n\t\tsetMinRange(newRange && Number(parseFloat(newRange.RangeMin || '').toFixed(2)));\r\n\t\tsetMaxRange(newRange && Number(parseFloat(newRange.RangeMax || '').toFixed(2)));\r\n\t\tsetStartRange(newRange && Number(parseFloat(newRange.RangeStart || '').toFixed(2)));\r\n\t\tsetEndRange(newRange && Number(parseFloat(newRange.RangeEnd || '').toFixed(2)));\r\n\t}, [facetValues]);\r\n\r\n\tif (\r\n\t\trangeMin === null ||\r\n\t\tisNaN(rangeMin) ||\r\n\t\trangeMax === null ||\r\n\t\tisNaN(rangeMax) ||\r\n\t\trangeStart === null ||\r\n\t\tisNaN(rangeStart) ||\r\n\t\trangeEnd === null ||\r\n\t\tisNaN(rangeEnd)\r\n\t) {\r\n\t\t// this facet is somehow misconfigured so don't render\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfunction onSliderValueChange(state: PublicState) {\r\n\t\tconst [newMin, newMax] = state.values;\r\n\r\n\t\tsetFacetValues(newMin, newMax);\r\n\t}\r\n\r\n\tfunction onValueChange(newMinValue: number, newMaxValue: number) {\r\n\t\tlet currentMinValue = minValue;\r\n\t\tlet currentMaxValue = maxValue;\r\n\t\t// if min value wasn't yet selected use range start\r\n\t\tif (minValue === undefined && rangeStart !== null) {\r\n\t\t\tcurrentMinValue = rangeStart; // setMinValue(rangeStart);\r\n\t\t}\r\n\r\n\t\t// if max value wasn't yet selected use range end\r\n\t\tif (maxValue === undefined && rangeEnd !== null) {\r\n\t\t\tcurrentMaxValue = rangeEnd;\r\n\t\t}\r\n\r\n\t\tif (currentMinValue === undefined || currentMaxValue === undefined) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (currentMinValue !== newMinValue && newMinValue <= currentMaxValue) {\r\n\t\t\tif (rangeMin !== null && newMinValue <= rangeMin) {\r\n\t\t\t\tcurrentMinValue = rangeMin;\r\n\t\t\t} else {\r\n\t\t\t\tcurrentMinValue = newMinValue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (currentMaxValue !== newMaxValue && newMaxValue >= currentMinValue) {\r\n\t\t\tif (rangeMax !== null && newMaxValue >= rangeMax) {\r\n\t\t\t\tcurrentMaxValue = rangeMax;\r\n\t\t\t} else {\r\n\t\t\t\tcurrentMaxValue = newMaxValue;\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetMinValue(currentMinValue);\r\n\t\tsetMaxValue(currentMaxValue);\r\n\t\tsetFacetValues(currentMinValue, currentMaxValue);\r\n\t}\r\n\r\n\tfunction setFacetValues(minVal: number | undefined, maxVal: number | undefined) {\r\n\t\tif (minVal === undefined || maxVal === undefined || isNaN(minVal) || isNaN(maxVal)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsetMinValue(minVal);\r\n\t\tsetMaxValue(maxVal);\r\n\r\n\t\t// this selection is sent to hawk separated by commas, so build the value here\r\n\t\tconst selection = `${minVal},${maxVal}`;\r\n\r\n\t\tactor.setFacets([selection]);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"hawk-facet-rail__facet-values\">\r\n\t\t\t<div className=\"hawk-facet-rail__facet-values-link\">\r\n\t\t\t\t<React.Suspense fallback={<div>Loading...</div>}>\r\n\t\t\t\t\t<SliderNumericInputs\r\n\t\t\t\t\t\tmin={rangeMin}\r\n\t\t\t\t\t\tmax={rangeMax}\r\n\t\t\t\t\t\tcurrencySymbol={currencySymbol}\r\n\t\t\t\t\t\tisCurrency={isCurency}\r\n\t\t\t\t\t\tvalues={[\r\n\t\t\t\t\t\t\tminValue === undefined ? rangeStart : Math.max(minValue, rangeMin),\r\n\t\t\t\t\t\t\tmaxValue === undefined ? rangeEnd : Math.min(maxValue, rangeMax),\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t\tonValueChange={onValueChange}\r\n\t\t\t\t\t\tdecimalPrecision={decimalPrecision}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Rheostat\r\n\t\t\t\t\t\tmin={rangeMin}\r\n\t\t\t\t\t\tmax={rangeMax}\r\n\t\t\t\t\t\tvalues={[\r\n\t\t\t\t\t\t\tMath.floor(minValue === undefined ? rangeStart : Math.max(minValue, rangeMin)),\r\n\t\t\t\t\t\t\tMath.ceil(maxValue === undefined ? rangeEnd : Math.min(maxValue, rangeMax)),\r\n\t\t\t\t\t\t]}\r\n\t\t\t\t\t\tonChange={onSliderValueChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</React.Suspense>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default SliderNumeric;\r\n","import React from 'react';\r\n\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport SliderDate from './SliderDate';\r\nimport SliderNumeric from './SliderNumeric';\r\n\r\nfunction Slider() {\r\n\tconst { facet } = useFacet();\r\n\tif (facet.DataType && facet.DataType === 'datetime') {\r\n\t\treturn <SliderDate />;\r\n\t}\r\n\treturn <SliderNumeric />;\r\n}\r\n\r\nexport default Slider;\r\n","import React, { useState } from 'react';\r\n\r\nimport { Value } from 'models/Facets/Value';\r\nimport { Swatch } from 'models/Facets';\r\nimport { useHawkConfig } from 'components/ConfigProvider';\r\n\r\nexport interface SwatchItemProps {\r\n\tswatchValue: Value;\r\n\tfacetSwatch: Swatch;\r\n\tisNegated: boolean;\r\n\tisSelected: boolean;\r\n\tisColor: boolean;\r\n\tonSwatchSelected(facetValue: string, isNegated: boolean): void;\r\n}\r\n\r\nfunction SwatchItem(item: SwatchItemProps) {\r\n\tconst { config } = useHawkConfig();\r\n\r\n\tconst facetValue = item.swatchValue.Value || '';\r\n\r\n\t// facets can be selected or negated, so explicitly check that the facet is not selected\r\n\tconst swatchUrl =\r\n\t\tconfig.dashboardUrl + (!item.facetSwatch.AssetUrl ? item.facetSwatch.AssetName : item.facetSwatch.AssetUrl);\r\n\r\n\tconst colorSwatchStyle = {\r\n\t\tbackgroundColor: item.facetSwatch.Color,\r\n\t};\r\n\r\n\tconst listItemClassNames =\r\n\t\t'hawk-facet-rail__facet-list-item' +\r\n\t\t(item.isSelected ? ' hawkFacet-active' : '') +\r\n\t\t(item.isNegated ? ' hawkFacet-negative' : '');\r\n\r\n\treturn (\r\n\t\t<li key={item.facetSwatch.Value} className={listItemClassNames}>\r\n\t\t\t<button\r\n\t\t\t\tonClick={e => item.onSwatchSelected(facetValue, false)}\r\n\t\t\t\tclassName=\"hawk-facet-rail__facet-btn hawk-styleSwatch\"\r\n\t\t\t\taria-pressed={item.isSelected}\r\n\t\t\t>\r\n\t\t\t\t<span className=\"hawk-selectionInner\">\r\n\t\t\t\t\t{item.isColor ? (\r\n\t\t\t\t\t\t<span className=\"hawk-swatchColor\" style={colorSwatchStyle} title={item.facetSwatch.Value} />\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<img src={swatchUrl} alt={item.facetSwatch.Value} />\r\n\t\t\t\t\t)}\r\n\t\t\t\t</span>\r\n\t\t\t</button>\r\n\t\t\t<button className=\"hawk-negativeIcon\">\r\n\t\t\t\t<i className=\"hawkIcon-blocked\" onClick={e => item.onSwatchSelected(facetValue, true)} />\r\n\t\t\t</button>\r\n\t\t</li>\r\n\t);\r\n}\r\n\r\nexport default SwatchItem;\r\n","import React, { useState } from 'react';\r\n\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport { FacetSelectionState } from 'store/Store';\r\nimport SwatchItem from './SwatchItem';\r\n\r\nfunction Swatch() {\r\n\tconst { store } = useHawksearch();\r\n\tconst {\r\n\t\tfacet,\r\n\t\tactor,\r\n\t\tstate: { facetValues },\r\n\t\trenderer,\r\n\t} = useFacet();\r\n\r\n\tfunction onSwatchSelected(facetValue: string, isNegated: boolean) {\r\n\t\tisNegated ? actor.negateFacet(facetValue) : actor.selectFacet(facetValue);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"hawk-facet-rail__facet-values\">\r\n\t\t\t<div className=\"hawk-facet-rail__facet-values-swatch\">\r\n\t\t\t\t<ul className=\"hawk-facet-rail__facet-list\">\r\n\t\t\t\t\t{facet.SwatchData &&\r\n\t\t\t\t\t\tfacetValues.map(value => {\r\n\t\t\t\t\t\t\tconst facetValue = value.Value || '';\r\n\t\t\t\t\t\t\t// find swatch that is corresponding with value\r\n\t\t\t\t\t\t\tconst facetSwatch =\r\n\t\t\t\t\t\t\t\tfacet.SwatchData &&\r\n\t\t\t\t\t\t\t\tfacet.SwatchData.find(s => s.Value.toLowerCase() === facetValue.toLowerCase());\r\n\t\t\t\t\t\t\tif (!facetSwatch) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst selectionState = store.isFacetSelected(facet, value).state;\r\n\t\t\t\t\t\t\tconst isNegated = selectionState === FacetSelectionState.Negated;\r\n\t\t\t\t\t\t\tconst isSelected = selectionState !== FacetSelectionState.NotSelected;\r\n\r\n\t\t\t\t\t\t\tconst isColor = !!facetSwatch.Color;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<SwatchItem\r\n\t\t\t\t\t\t\t\t\tkey={facetValue}\r\n\t\t\t\t\t\t\t\t\tswatchValue={value}\r\n\t\t\t\t\t\t\t\t\tfacetSwatch={facetSwatch}\r\n\t\t\t\t\t\t\t\t\tisSelected={isSelected}\r\n\t\t\t\t\t\t\t\t\tisColor={isColor}\r\n\t\t\t\t\t\t\t\t\tisNegated={isNegated}\r\n\t\t\t\t\t\t\t\t\tonSwatchSelected={onSwatchSelected}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* render the default truncation control as we don't need to customize this */}\r\n\t\t\t{renderer.renderTruncation()}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default Swatch;\r\n","import React, { useEffect, useState } from 'react';\r\n\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { FacetSelectionState } from 'store/Store';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport CheckmarkSVG from 'components/svg/CheckmarkSVG';\r\nimport { Value } from 'models/Facets';\r\nimport PlusCircleSVG from 'components/svg/PlusCircleSVG';\r\nimport DashCircleSVG from 'components/svg/DashCircleSVG';\r\nimport { ClientSelectionValue } from 'store/ClientSelections';\r\n\r\nexport interface NestedItemProps {\r\n\thierarchyValue: Value;\r\n\tisNegated: boolean;\r\n\tisSelected: boolean;\r\n\tonValueSelected(facetValue: Value, isNegated: boolean): void;\r\n}\r\n\r\nfunction checkChildSelections(facetArray, matchValue) {\r\n\tconst matchedValue = facetArray.find((i: ClientSelectionValue) => {\r\n\t\treturn (i.path || '').split('/').indexOf(matchValue) !== -1;\r\n\t});\r\n\treturn !matchedValue ? false : true;\r\n}\r\n\r\nfunction NestedItem(item: NestedItemProps) {\r\n\tconst { store } = useHawksearch();\r\n\tconst { facet } = useFacet();\r\n\tconst [isExpanded, setIsExpanded] = useState(false);\r\n\tconst [isTruncated, setIsTruncated] = useState(facet.shouldTruncate);\r\n\r\n\tconst hierarchyValue = item.hierarchyValue || '';\r\n\tlet hierarchyChildren = item.hierarchyValue.Children || [];\r\n\r\n\tlet remainingValues = 0;\r\n\r\n\tconst shouldTruncateChildren =\r\n\t\tfacet.DisplayType === 'truncating' && hierarchyChildren.length > facet.TruncateThreshold;\r\n\r\n\tif (shouldTruncateChildren && isTruncated) {\r\n\t\tconst valuesBeforeTrunc = hierarchyChildren.length;\r\n\r\n\t\thierarchyChildren = hierarchyChildren.slice(0, facet.TruncateThreshold);\r\n\r\n\t\tremainingValues = valuesBeforeTrunc - facet.TruncateThreshold;\r\n\t}\r\n\r\n\tfunction renderChildTruncation() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t{shouldTruncateChildren && (\r\n\t\t\t\t\t<li className=\"hawk-facet-rail__facet-list-item hawk-show-more\">\r\n\t\t\t\t\t\t<button onClick={() => setIsTruncated(!isTruncated)} className=\"hawk-facet-rail__show-more-btn\">\r\n\t\t\t\t\t\t\t{isTruncated ? `(+) Show ${remainingValues} More` : '(-) Show Less'}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t)}\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\tfunction isIE() {\r\n\t\tconst ua = window.navigator.userAgent;\r\n\t\tconst oldIE = ua.indexOf('MSIE ');\r\n\t\tconst newIe = ua.indexOf('Trident/');\r\n\r\n\t\treturn oldIE > -1 || newIe > -1;\r\n\t}\r\n\r\n\tfunction getCollapseStateClass(expanded) {\r\n\t\tconst classes = ['hawk-collapseState'];\r\n\r\n\t\tif (!expanded) {\r\n\t\t\tclasses.push('collapsed');\r\n\t\t}\r\n\r\n\t\tif (isIE()) {\r\n\t\t\tclasses.push('ie-fix');\r\n\t\t}\r\n\r\n\t\treturn classes.join(' ');\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tconst isPartialSelection = checkChildSelections(\r\n\t\t\t(store.facetSelections[facet.Field] || {}).items || [],\r\n\t\t\titem.hierarchyValue.Value\r\n\t\t);\r\n\t\tif (isPartialSelection) {\r\n\t\t\tsetIsExpanded(true);\r\n\t\t}\r\n\t}, [item]);\r\n\r\n\tfunction setSelection() {\r\n\t\titem.onValueSelected(hierarchyValue, false);\r\n\t\tif (!isExpanded) {\r\n\t\t\tsetIsExpanded(true);\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<li className=\"hawk-facet-rail__facet-list-item hawkFacet-group\">\r\n\t\t\t<div className=\"hawkFacet-group__inline\">\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => setSelection()}\r\n\t\t\t\t\tclassName=\"hawk-facet-rail__facet-btn\"\r\n\t\t\t\t\taria-pressed={item.isSelected}\r\n\t\t\t\t>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclassName={\r\n\t\t\t\t\t\t\titem.isSelected\r\n\t\t\t\t\t\t\t\t? 'hawk-facet-rail__facet-checkbox hawk-facet-rail__facet-checkbox--checked'\r\n\t\t\t\t\t\t\t\t: 'hawk-facet-rail__facet-checkbox'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{item.isSelected ? <CheckmarkSVG class=\"hawk-facet-rail__facet-checkbox-icon\" /> : null}\r\n\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tstyle={item.isNegated ? { textDecoration: 'line-through' } : undefined}\r\n\t\t\t\t\t\tclassName=\"hawk-facet-rail__facet-name\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{item.hierarchyValue.Label} ({item.hierarchyValue.Count})\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={e => item.onValueSelected(hierarchyValue, true)}\r\n\t\t\t\t\tclassName=\"hawk-facet-rail__facet-btn-exclude\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{item.isNegated ? (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<PlusCircleSVG class=\"hawk-facet-rail__facet-btn-include\" />\r\n\t\t\t\t\t\t\t<span className=\"visually-hidden\">Include facet</span>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<DashCircleSVG />\r\n\t\t\t\t\t\t\t<span className=\"visually-hidden\">Exclude facet</span>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</button>\r\n\t\t\t\t{hierarchyChildren.length > 0 ? (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName={getCollapseStateClass(isExpanded)}\r\n\t\t\t\t\t\taria-expanded=\"false\"\r\n\t\t\t\t\t\tonClick={() => setIsExpanded(!isExpanded)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t&nbsp;\r\n\t\t\t\t\t</button>\r\n\t\t\t\t) : null}\r\n\t\t\t</div>\r\n\t\t\t{isExpanded && hierarchyChildren ? (\r\n\t\t\t\t<div className=\"hawk-facet-rail__w-100\">\r\n\t\t\t\t\t<ul className=\"hawkFacet-group-inside\">\r\n\t\t\t\t\t\t{hierarchyChildren.map(value => {\r\n\t\t\t\t\t\t\tconst selectionState = store.isFacetSelected(facet, value).state;\r\n\t\t\t\t\t\t\tconst isNegated = selectionState === FacetSelectionState.Negated;\r\n\t\t\t\t\t\t\tconst isSelected = selectionState !== FacetSelectionState.NotSelected;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<NestedItem\r\n\t\t\t\t\t\t\t\t\tkey={value.Path}\r\n\t\t\t\t\t\t\t\t\thierarchyValue={value}\r\n\t\t\t\t\t\t\t\t\tisSelected={isSelected}\r\n\t\t\t\t\t\t\t\t\tisNegated={isNegated}\r\n\t\t\t\t\t\t\t\t\tonValueSelected={item.onValueSelected}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t{renderChildTruncation()}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t) : (\r\n\t\t\t\t<></>\r\n\t\t\t)}\r\n\t\t</li>\r\n\t);\r\n}\r\n\r\nexport default NestedItem;\r\n","import React from 'react';\r\n\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { FacetSelectionState } from 'store/Store';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport NestedItem from './NestedItem';\r\nimport { Value } from 'models/Facets/Value';\r\n\r\nfunction Nested() {\r\n\tconst { store } = useHawksearch();\r\n\tconst {\r\n\t\tfacet,\r\n\t\tstate: { facetValues },\r\n\t\tactor,\r\n\t\trenderer,\r\n\t} = useFacet();\r\n\r\n\tfunction onValueSelected(facetValue: Value, isNegated: boolean) {\r\n\t\tisNegated ? actor.negateFacet(facetValue) : actor.selectFacet(facetValue);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"hawk-facet-rail__facet-values\">\r\n\t\t\t<div className=\"hawk-facet-rail__facet-values-checkbox\">\r\n\t\t\t\t<ul className=\"hawk-facet-rail__facet-list\">\r\n\t\t\t\t\t{facetValues.map(value => {\r\n\t\t\t\t\t\t// facets can be selected or negated, so explicitly check that the facet is not selected\r\n\t\t\t\t\t\tconst selectionState = store.isFacetSelected(facet, value).state;\r\n\r\n\t\t\t\t\t\tconst isSelected = selectionState !== FacetSelectionState.NotSelected;\r\n\t\t\t\t\t\tconst isNegated = selectionState === FacetSelectionState.Negated;\r\n\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<NestedItem\r\n\t\t\t\t\t\t\t\tkey={value.Value}\r\n\t\t\t\t\t\t\t\thierarchyValue={value}\r\n\t\t\t\t\t\t\t\tisSelected={isSelected}\r\n\t\t\t\t\t\t\t\tisNegated={isNegated}\r\n\t\t\t\t\t\t\t\tonValueSelected={onValueSelected}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* render the default truncation control as we don't need to customize this */}\r\n\t\t\t{renderer.renderTruncation()}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default Nested;\r\n","import React, { useEffect, useState } from 'react';\r\nimport moment from 'moment';\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\n\r\nfunction replaceHyphen(date: string) {\r\n\tif (!date) {\r\n\t\treturn date;\r\n\t}\r\n\treturn date.replace(/-/g, '/');\r\n}\r\n\r\nfunction OpenRangeDatetime() {\r\n\tconst { actor: hawkActor } = useHawksearch();\r\n\tconst {\r\n\t\tstore: { facetSelections },\r\n\t} = useHawksearch();\r\n\tconst {\r\n\t\tstate: { facetValues },\r\n\t\tfacet,\r\n\t\tactor,\r\n\t} = useFacet();\r\n\tconst daterange = facetValues.length > 0 ? facetValues[0] : null;\r\n\tconst rangeStartDate =\r\n\t\tdaterange && daterange.RangeStart ? moment(daterange.RangeStart).format('YYYY-MM-DDTHH:mm') : '';\r\n\tconst rangeEndDate = daterange && daterange.RangeEnd ? moment(daterange.RangeEnd).format('YYYY-MM-DDTHH:mm') : '';\r\n\r\n\t// if there's no range, initialize to empty strings\r\n\tconst [minDateValue, setdateStartValue] = useState(rangeStartDate || '');\r\n\tconst [maxDateValue, setdateEndValue] = useState(rangeEndDate || '');\r\n\t// the open range boundary values are defined by the first facet value. or null if there is no first value\r\n\r\n\tconst range = facetValues.length > 0 ? facetValues[0] : null;\r\n\r\n\tconst rangeStart = (range && range.RangeStart) || '';\r\n\tconst rangeEnd = (range && range.RangeEnd) || '';\r\n\r\n\tuseEffect(() => {\r\n\t\tconst paramName = facet.ParamName || facet.Field;\r\n\r\n\t\t// Set min and max value if these were cleared\r\n\t\tif (!paramName || !(paramName in facetSelections)) {\r\n\t\t\tsetdateStartValue(rangeStartDate);\r\n\t\t\tsetdateEndValue(rangeEndDate);\r\n\t\t} else if (\r\n\t\t\tparamName in facetSelections &&\r\n\t\t\tfacetSelections[paramName].items &&\r\n\t\t\tfacetSelections[paramName].items.length > 0\r\n\t\t) {\r\n\t\t\tconst selectedValues = facetSelections[paramName].items[0].value.split(',');\r\n\t\t\tsetdateStartValue(selectedValues[0].replace(/\\//g, '-'));\r\n\t\t\tsetdateEndValue(selectedValues[1].replace(/\\//g, '-'));\r\n\t\t}\r\n\t}, [facetSelections]);\r\n\r\n\tif (rangeStart === null || rangeEnd === null) {\r\n\t\t// this facet is somehow misconfigured so don't render\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfunction ondateRangeStartChange(event: React.FormEvent<HTMLInputElement>) {\r\n\t\tsetdateFacetValues(event.currentTarget.value, maxDateValue);\r\n\t}\r\n\r\n\tfunction ondateRangeEndChange(event: React.FormEvent<HTMLInputElement>) {\r\n\t\tsetdateFacetValues(minDateValue, event.currentTarget.value);\r\n\t}\r\n\r\n\tfunction setdateFacetValues(startVal: string, endVal: string) {\r\n\t\tsetdateStartValue(startVal);\r\n\t\tsetdateEndValue(endVal);\r\n\r\n\t\t// this selection is sent to hawk separated by commas, so build the value here\r\n\r\n\t\tif (startVal === '' && endVal === '') {\r\n\t\t\thawkActor.clearFacet(facet);\r\n\t\t} else {\r\n\t\t\tconst selection = `${replaceHyphen(startVal)},${replaceHyphen(endVal)}`;\r\n\t\t\tactor.setFacets([selection]);\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"hawk-facet-rail__facet-values\">\r\n\t\t\t<div className=\"hawk-facet-rail__facet-values-link\">\r\n\t\t\t\t<div className=\"hawk-open-range hawk-facet-type-date\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"datetime-local\"\r\n\t\t\t\t\t\tclassName=\"hawk-text-input hawk-date-value-start\"\r\n\t\t\t\t\t\tvalue={minDateValue}\r\n\t\t\t\t\t\tmin={rangeStartDate}\r\n\t\t\t\t\t\tmax={rangeEndDate}\r\n\t\t\t\t\t\tonChange={ondateRangeStartChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"datetime-local\"\r\n\t\t\t\t\t\tclassName=\"hawk-text-input hawk-date-value-end\"\r\n\t\t\t\t\t\tvalue={maxDateValue}\r\n\t\t\t\t\t\tmin={rangeStartDate}\r\n\t\t\t\t\t\tmax={rangeEndDate}\r\n\t\t\t\t\t\tonChange={ondateRangeEndChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default OpenRangeDatetime;\r\n","import React, { useState } from 'react';\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\n\r\nfunction OpenRangeNumber() {\r\n\tconst { actor: hawkActor } = useHawksearch();\r\n\r\n\tconst {\r\n\t\tstate: { facetValues },\r\n\t\tfacet,\r\n\t\tactor,\r\n\t} = useFacet();\r\n\r\n\t// the open range boundary values are defined by the first facet value. or null if there is no first value\r\n\tconst range = facetValues.length > 0 ? facetValues[0] : null;\r\n\r\n\tconst rangeStart = (range && range.RangeStart) || '';\r\n\tconst rangeEnd = (range && range.RangeEnd) || '';\r\n\r\n\t// if there's no range, initialize to empty strings\r\n\tconst [minValue, setStartValue] = useState(rangeStart || '');\r\n\tconst [maxValue, setEndValue] = useState(rangeEnd || '');\r\n\r\n\tfunction onRangeStartChange(event: React.FormEvent<HTMLInputElement>) {\r\n\t\tsetFacetValues(event.currentTarget.value, maxValue);\r\n\t}\r\n\r\n\tfunction onRangeEndChange(event: React.FormEvent<HTMLInputElement>) {\r\n\t\tsetFacetValues(minValue, event.currentTarget.value);\r\n\t}\r\n\r\n\tfunction setFacetValues(startVal: string, endVal: string) {\r\n\t\tsetStartValue(startVal);\r\n\t\tsetEndValue(endVal);\r\n\r\n\t\t// this selection is sent to hawk separated by commas, so build the value here\r\n\r\n\t\tif (startVal === '' && endVal === '') {\r\n\t\t\thawkActor.clearFacet(facet);\r\n\t\t} else {\r\n\t\t\tconst selection = `${startVal},${endVal}`;\r\n\t\t\tactor.setFacets([selection]);\r\n\t\t}\r\n\t}\r\n\r\n\tif (rangeStart === null || rangeEnd === null) {\r\n\t\t// this facet is somehow misconfigured so don't render\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"hawk-facet-rail__facet-values\">\r\n\t\t\t<div className=\"hawk-facet-rail__facet-values-link\">\r\n\t\t\t\t<div className=\"hawk-open-range\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tclassName=\"hawk-text-input value-start\"\r\n\t\t\t\t\t\tdata-type=\"currency\"\r\n\t\t\t\t\t\tvalue={minValue}\r\n\t\t\t\t\t\tonChange={onRangeStartChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tclassName=\"hawk-text-input value-end\"\r\n\t\t\t\t\t\tonChange={onRangeEndChange}\r\n\t\t\t\t\t\tvalue={maxValue}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default OpenRangeNumber;\r\n","import React, { useState } from 'react';\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport OpenRangeDatetime from './OpenRangeDatetime';\r\nimport OpenRangeNumber from './OpenRangeNumber';\r\n\r\nfunction OpenRange() {\r\n\tconst { facet } = useFacet();\r\n\r\n\tif (facet.DataType && facet.DataType === 'datetime') {\r\n\t\treturn <OpenRangeDatetime />;\r\n\t}\r\n\r\n\treturn <OpenRangeNumber />;\r\n}\r\n\r\nexport default OpenRange;\r\n","import React from 'react';\r\n\r\ninterface SizeItemProps {\r\n\tsize: {\r\n\t\tValue: string;\r\n\t\tLabel: string;\r\n\t\tSelected: boolean;\r\n\t};\r\n\tisNegated: boolean;\r\n\tonSwatchSelected: (a: string, b: boolean) => void;\r\n}\r\n\r\nconst SizeItem = React.memo(({ size, onSwatchSelected, isNegated }: SizeItemProps) => {\r\n\treturn (\r\n\t\t<li\r\n\t\t\tkey={size.Value}\r\n\t\t\tclassName={size.Selected ? 'selected' : ''}\r\n\t\t\tonClick={() => onSwatchSelected(size.Value, isNegated)}\r\n\t\t>\r\n\t\t\t<div>{size.Label}</div>\r\n\t\t</li>\r\n\t);\r\n});\r\n\r\nexport default SizeItem;\r\n","import React, { useState } from 'react';\r\n\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport { FacetSelectionState } from 'store/Store';\r\nimport SizeItem from './SizeItem';\r\n\r\nfunction Size() {\r\n\tconst { store } = useHawksearch();\r\n\tconst {\r\n\t\tfacet,\r\n\t\tactor,\r\n\t\tstate: { facetValues },\r\n\t} = useFacet();\r\n\r\n\tfunction onSwatchSelected(facetValue: string, isNegated: boolean) {\r\n\t\tisNegated ? actor.negateFacet(facetValue) : actor.selectFacet(facetValue);\r\n\t}\r\n\treturn (\r\n\t\t<div className=\"hawk-facet-rail__facet-values\">\r\n\t\t\t<div className=\"hawk-facet-rail__facet-values-size\">\r\n\t\t\t\t<ul className=\"hawk-facet-rail__facet-list col-sm-8\">\r\n\t\t\t\t\t{facet.Values &&\r\n\t\t\t\t\t\tfacetValues.map(value => {\r\n\t\t\t\t\t\t\tconst selectionState = store.isFacetSelected(facet, value).state;\r\n\t\t\t\t\t\t\tconst isNegated = selectionState === FacetSelectionState.Negated;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<SizeItem\r\n\t\t\t\t\t\t\t\t\tkey={value.Value}\r\n\t\t\t\t\t\t\t\t\tsize={{ ...value, Value: value.Value || '', Label: value.Label || '' }}\r\n\t\t\t\t\t\t\t\t\tonSwatchSelected={onSwatchSelected}\r\n\t\t\t\t\t\t\t\t\tisNegated={isNegated}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default Size;\r\n","import React, { useState } from 'react';\r\n\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { FacetSelectionState } from 'store/Store';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport { Value } from 'models/Facets';\r\nexport interface NestedLinkItemProps {\r\n\thierarchyValue: Value;\r\n\tisNegated: boolean;\r\n\tisSelected: boolean;\r\n\tonValueSelected(facetValue: Value, isNegated: boolean): void;\r\n}\r\n\r\nfunction NestedLinkItem(item: NestedLinkItemProps) {\r\n\tconst { store } = useHawksearch();\r\n\tconst { facet } = useFacet();\r\n\r\n\tconst [isExpanded, setIsExpanded] = useState(false);\r\n\tconst [isTruncated, setIsTruncated] = useState(facet.shouldTruncate);\r\n\r\n\tconst hierarchyValue = item.hierarchyValue || '';\r\n\tlet hierarchyChildren = item.hierarchyValue.Children || [];\r\n\r\n\tlet remainingValues = 0;\r\n\r\n\tconst shouldTruncateChildren =\r\n\t\tfacet.DisplayType === 'truncating' && hierarchyChildren.length > facet.TruncateThreshold;\r\n\r\n\tif (shouldTruncateChildren && isTruncated) {\r\n\t\tconst valuesBeforeTrunc = hierarchyChildren.length;\r\n\r\n\t\thierarchyChildren = hierarchyChildren.slice(0, facet.TruncateThreshold);\r\n\r\n\t\tremainingValues = valuesBeforeTrunc - facet.TruncateThreshold;\r\n\t}\r\n\r\n\tfunction renderChildTruncation() {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t{shouldTruncateChildren && (\r\n\t\t\t\t\t<li className=\"hawk-facet-rail__facet-list-item hawk-show-more\">\r\n\t\t\t\t\t\t<button onClick={() => setIsTruncated(!isTruncated)} className=\"hawk-facet-rail__show-more-btn\">\r\n\t\t\t\t\t\t\t{isTruncated ? `(+) Show ${remainingValues} More` : '(-) Show Less'}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t)}\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<li className=\"hawk-facet-rail__facet-list-item hawkFacet-group\">\r\n\t\t\t<div className=\"hawkFacet-group__inline\">\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => item.onValueSelected(hierarchyValue, false)}\r\n\t\t\t\t\tclassName=\"hawk-facet-rail__facet-btn\"\r\n\t\t\t\t\taria-pressed={item.isSelected}\r\n\t\t\t\t>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tstyle={item.isNegated ? { textDecoration: 'line-through' } : undefined}\r\n\t\t\t\t\t\tclassName={\r\n\t\t\t\t\t\t\titem.isSelected ? 'hawk-facet-rail__facet-name checked' : 'hawk-facet-rail__facet-name'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{item.hierarchyValue.Label} ({item.hierarchyValue.Count})\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</button>\r\n\t\t\t\t{hierarchyChildren.length > 0 ? (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName={\r\n\t\t\t\t\t\t\tisExpanded\r\n\t\t\t\t\t\t\t\t? 'hawk-collapseState hawk-linklist'\r\n\t\t\t\t\t\t\t\t: 'hawk-collapseState hawk-linklist collapsed'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\taria-expanded=\"false\"\r\n\t\t\t\t\t\tonClick={() => setIsExpanded(!isExpanded)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t&nbsp;\r\n\t\t\t\t\t</button>\r\n\t\t\t\t) : null}\r\n\t\t\t</div>\r\n\t\t\t{isExpanded && hierarchyChildren ? (\r\n\t\t\t\t<div className=\"hawk-facet-rail__w-100\">\r\n\t\t\t\t\t<ul className=\"hawkFacet-group-inside\">\r\n\t\t\t\t\t\t{hierarchyChildren.map(value => {\r\n\t\t\t\t\t\t\tconst selectionState = store.isFacetSelected(facet, value).state;\r\n\t\t\t\t\t\t\tconst isNegated = selectionState === FacetSelectionState.Negated;\r\n\t\t\t\t\t\t\tconst isSelected = selectionState !== FacetSelectionState.NotSelected;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<NestedLinkItem\r\n\t\t\t\t\t\t\t\t\tkey={value.Path}\r\n\t\t\t\t\t\t\t\t\thierarchyValue={value}\r\n\t\t\t\t\t\t\t\t\tisSelected={isSelected}\r\n\t\t\t\t\t\t\t\t\tisNegated={isNegated}\r\n\t\t\t\t\t\t\t\t\tonValueSelected={item.onValueSelected}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t{renderChildTruncation()}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t) : (\r\n\t\t\t\t<></>\r\n\t\t\t)}\r\n\t\t</li>\r\n\t);\r\n}\r\n\r\nexport default NestedLinkItem;\r\n","import React from 'react';\r\n\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { FacetSelectionState } from 'store/Store';\r\nimport { useFacet } from 'components/ui/Facets/Facet';\r\nimport NestedLinkItem from './NestedLinkItem';\r\nimport { Value } from 'models/Facets/Value';\r\n\r\nfunction NestedLink() {\r\n\tconst { store } = useHawksearch();\r\n\tconst {\r\n\t\tfacet,\r\n\t\tstate: { facetValues },\r\n\t\tactor,\r\n\t\trenderer,\r\n\t} = useFacet();\r\n\r\n\tfunction onValueSelected(facetValue: Value, isNegated: boolean) {\r\n\t\tisNegated ? actor.negateFacet(facetValue) : actor.selectFacet(facetValue);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"hawk-facet-rail__facet-values\">\r\n\t\t\t<div className=\"hawk-facet-rail__facet-values-linklist\">\r\n\t\t\t\t<ul className=\"hawk-facet-rail__facet-list\">\r\n\t\t\t\t\t{facetValues.map(value => {\r\n\t\t\t\t\t\t// facets can be selected or negated, so explicitly check that the facet is not selected\r\n\t\t\t\t\t\tconst selectionState = store.isFacetSelected(facet, value).state;\r\n\r\n\t\t\t\t\t\tconst isSelected = selectionState !== FacetSelectionState.NotSelected;\r\n\t\t\t\t\t\tconst isNegated = selectionState === FacetSelectionState.Negated;\r\n\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<NestedLinkItem\r\n\t\t\t\t\t\t\t\tkey={value.Value}\r\n\t\t\t\t\t\t\t\thierarchyValue={value}\r\n\t\t\t\t\t\t\t\tisSelected={isSelected}\r\n\t\t\t\t\t\t\t\tisNegated={isNegated}\r\n\t\t\t\t\t\t\t\tonValueSelected={onValueSelected}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* render the default truncation control as we don't need to customize this */}\r\n\t\t\t{renderer.renderTruncation()}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default NestedLink;\r\n","import {\r\n\tCheckbox as DefaultCheckbox,\r\n\tNestedCheckbox as DefaultNestedCheckbox,\r\n\tSearch as DefaultSearch,\r\n\tLink as DefaultLink,\r\n\tSlider as DefaultSlider,\r\n\tSwatch as DefaultSwatch,\r\n\tOpenRange as DefaultOpenRange,\r\n\tSize as DefaultSize,\r\n\tNestedLink as DefaultNestedLink,\r\n} from 'components/ui/Facets/FacetTypes';\r\nimport { FacetComponent } from 'types/FacetComponent';\r\nimport { FacetType } from 'models/Facets/FacetType';\r\nimport { SuggestionStrategyMatch, SuggestionType } from 'models/Autocomplete/Suggestion';\r\nimport { ProductStrategy, CategoryStrategy, PopularStrategy, ContentStrategy } from 'models/Autocomplete';\r\n\r\n// the default set of facet components that we support\r\nconst defaultFacetComponents: FacetComponent[] = [\r\n\t{ facetType: FacetType.Checkbox, component: DefaultCheckbox },\r\n\t{ facetType: FacetType.NestedCheckbox, component: DefaultNestedCheckbox },\r\n\t{ facetType: FacetType.SearchWithin, component: DefaultSearch },\r\n\t{ facetType: FacetType.Link, component: DefaultLink },\r\n\t{ facetType: FacetType.Slider, component: DefaultSlider },\r\n\t{ facetType: FacetType.Swatch, component: DefaultSwatch },\r\n\t{ facetType: FacetType.OpenRange, component: DefaultOpenRange },\r\n\t{ facetType: FacetType.Size, component: DefaultSize },\r\n\t{ facetType: FacetType.Nestedlink, component: DefaultNestedLink },\r\n];\r\n\r\nconst defaultAutocompleteStrategies: SuggestionStrategyMatch[] = [\r\n\t{ SuggestionType: SuggestionType.Product, SuggestionStrategy: new ProductStrategy() },\r\n\t{ SuggestionType: SuggestionType.Category, SuggestionStrategy: new CategoryStrategy() },\r\n\t{ SuggestionType: SuggestionType.Popular, SuggestionStrategy: new PopularStrategy() },\r\n\t{ SuggestionType: SuggestionType.Content, SuggestionStrategy: new ContentStrategy() },\r\n];\r\n\r\n/**\r\n * Builds a list of all supported facet components by also taking into consideration overridden components.\r\n */\r\nexport function getFacetComponents(overridedComponents: FacetComponent[]) {\r\n\tconst facetComponents: FacetComponent[] = [];\r\n\r\n\t// tslint:disable-next-line:forin\r\n\tfor (const key in FacetType) {\r\n\t\tconst fType = FacetType[key];\r\n\r\n\t\tconst fComponent =\r\n\t\t\t// check to see if the facet is overridden\r\n\t\t\toverridedComponents.find(component => component.facetType === fType) ||\r\n\t\t\t// otherwise, pull from defaults\r\n\t\t\tdefaultFacetComponents.find(component => component.facetType === fType);\r\n\r\n\t\tif (fComponent) {\r\n\t\t\tfacetComponents.push(fComponent);\r\n\t\t}\r\n\t}\r\n\r\n\treturn facetComponents;\r\n}\r\n\r\n/**\r\n * Builds a list of all supported autocomplete suggestion strategiesby also taking into consideration overridden strategies.\r\n */\r\nexport function getAutocompleteStrategies(overridedStrategies: SuggestionStrategyMatch[]): SuggestionStrategyMatch[] {\r\n\tconst suggestionStrategies: SuggestionStrategyMatch[] = [];\r\n\r\n\t// tslint:disable-next-line:forin\r\n\tfor (const key in SuggestionType) {\r\n\t\tconst sType = SuggestionType[key];\r\n\r\n\t\tconst autocompleteStrategy =\r\n\t\t\t// check to see if the facet is overridden\r\n\t\t\toverridedStrategies.find(strategyMatch => strategyMatch.SuggestionType === sType) ||\r\n\t\t\t// otherwise, pull from defaults\r\n\t\t\tdefaultAutocompleteStrategies.find(strategyMatch => strategyMatch.SuggestionType === sType);\r\n\r\n\t\tif (autocompleteStrategy) {\r\n\t\t\tsuggestionStrategies.push(autocompleteStrategy);\r\n\t\t}\r\n\t}\r\n\treturn suggestionStrategies;\r\n}\r\n","export const getVisitorExpiry = () => {\r\n\tconst d = new Date();\r\n\t// 1 year\r\n\td.setTime(d.getTime() + 360 * 24 * 60 * 60 * 1000);\r\n\treturn d.toUTCString();\r\n};\r\n\r\nexport const getVisitExpiry = () => {\r\n\tconst d = new Date();\r\n\t// 4 hours\r\n\td.setTime(d.getTime() + 4 * 60 * 60 * 1000);\r\n\treturn d.toUTCString();\r\n};\r\n\r\nexport const createGuid = () => {\r\n\tconst s: any[] = [];\r\n\tconst hexDigits = '0123456789abcdef';\r\n\tfor (let i = 0; i < 36; i++) {\r\n\t\ts[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\r\n\t}\r\n\ts[14] = '4'; // bits 12-15 of the time_hi_and_version field to 0010\r\n\t// tslint:disable-next-line: no-bitwise\r\n\ts[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01\r\n\ts[8] = s[13] = s[18] = s[23] = '-';\r\n\r\n\tconst uuid = s.join('');\r\n\treturn uuid;\r\n};\r\n\r\nexport const createWidgetId = () => {\r\n\tconst s: any[] = [];\r\n\tconst hexDigits = '0123456789abcdef';\r\n\r\n\tfor (let i = 0; i < 16; i++) {\r\n\t\ts[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\r\n\t}\r\n\r\n\tconst uuid = s.join('');\r\n\treturn uuid;\r\n};\r\n\r\nexport const getCookie = name => {\r\n\tconst nameEQ = name + '=';\r\n\tconst ca = document.cookie.split(';');\r\n\t// tslint:disable-next-line: prefer-for-of\r\n\tfor (let i = 0; i < ca.length; i++) {\r\n\t\tlet c = ca[i];\r\n\t\twhile (c.charAt(0) === ' ') {\r\n\t\t\tc = c.substring(1, c.length);\r\n\t\t}\r\n\t\tif (c.indexOf(nameEQ) === 0) {\r\n\t\t\treturn c.substring(nameEQ.length, c.length);\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nexport const setCookie = (name, value, expiry) => {\r\n\tlet expires;\r\n\tif (expiry) {\r\n\t\texpires = '; expires=' + expiry;\r\n\t} else {\r\n\t\texpires = '';\r\n\t}\r\n\tdocument.cookie = name + '=' + value + expires + '; path=/';\r\n};\r\n","import { ControllerStateAndHelpers } from 'downshift';\r\n\r\nexport enum SuggestionType {\r\n\tProduct = 'product',\r\n\tCategory = 'category',\r\n\tContent = 'content',\r\n\tPopular = 'popular',\r\n}\r\nexport abstract class Suggestion {\r\n\tpublic SuggestionType: SuggestionType;\r\n\tpublic constructor(suggestionType: SuggestionType) {\r\n\t\tthis.SuggestionType = suggestionType;\r\n\t}\r\n}\r\n\r\nexport interface SuggestionStrategy {\r\n\thandleItemChange(item: Suggestion, downshift: ControllerStateAndHelpers<Suggestion>): void;\r\n\ttoString(item: Suggestion): string;\r\n}\r\n\r\nexport interface SuggestionStrategyMatch {\r\n\tSuggestionType: SuggestionType;\r\n\tSuggestionStrategy: SuggestionStrategy;\r\n}\r\n","import React from 'react';\r\nimport { ControllerStateAndHelpers } from 'downshift';\r\n\r\nimport { Response, Product, Popular, Category, Content } from 'models/Autocomplete';\r\nimport { Suggestion } from '../../../models/Autocomplete/Suggestion';\r\nimport { CustomSuggestionListProps } from 'models/Autocomplete/CustomSuggestionList';\r\n\r\nexport interface SearchSuggestionsListProps {\r\n\tisLoading: boolean;\r\n\tsearchResults: Response;\r\n\tdownshift: ControllerStateAndHelpers<Suggestion>;\r\n\tonViewMatches: (downshift: ControllerStateAndHelpers<Suggestion>) => void;\r\n\tSuggestionList?: React.ComponentType<CustomSuggestionListProps>;\r\n}\r\n\r\nfunction hasAllEmpty(popular: Popular[], categories: Category[], products: Product[], content: Content[]) {\r\n\tconst hasPopular = popular && popular.length === 0;\r\n\tconst hasCategories = categories && categories.length === 0;\r\n\tconst hasProducts = products && products.length === 0;\r\n\tconst hasContent = content && content.length === 0;\r\n\treturn hasPopular && hasCategories && hasProducts && hasContent;\r\n}\r\n\r\nfunction SearchSuggestionsList({\r\n\tisLoading,\r\n\tsearchResults,\r\n\tdownshift,\r\n\tonViewMatches,\r\n\tSuggestionList,\r\n}: SearchSuggestionsListProps) {\r\n\tconst { Popular: popular, Categories: categories, Products: products, Content: content } = searchResults;\r\n\r\n\tconst isRecordEmpty = hasAllEmpty(popular, categories, products, content);\r\n\r\n\tif (isRecordEmpty) {\r\n\t\treturn null;\r\n\t}\r\n\treturn SuggestionList ? (\r\n\t\t<SuggestionList\r\n\t\t\tisLoading={isLoading}\r\n\t\t\tdownshift={downshift}\r\n\t\t\tsearchResults={searchResults}\r\n\t\t\tonViewMatches={onViewMatches}\r\n\t\t/>\r\n\t) : null;\r\n}\r\n\r\nexport default SearchSuggestionsList;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { ControllerStateAndHelpers } from 'downshift';\r\nimport axios, { CancelToken } from 'axios';\r\n\r\nimport HawkClient from 'net/HawkClient';\r\nimport { Response, Product, Category } from 'models/Autocomplete';\r\nimport { useHawkConfig } from 'components/ConfigProvider';\r\nimport SearchSuggestionsList from './SearchSuggestionsList';\r\nimport { Suggestion } from 'models/Autocomplete/Suggestion';\r\nimport { CustomSuggestionListProps } from 'models/Autocomplete/CustomSuggestionList';\r\nimport { getCookie, setCookie, createGuid, getVisitExpiry, getVisitorExpiry } from 'helpers/utils';\r\nimport { useHawksearch } from 'components/StoreProvider';\r\n\r\ninterface ClientData {\r\n\tVisitorId: string;\r\n\tVisitId: string;\r\n\tUserAgent: string;\r\n\tCustom?: {\r\n\t\tlanguage: string;\r\n\t};\r\n}\r\n\r\nexport interface SearchSuggestionsProps {\r\n\t/** The user entered search string in the autocomplete text input. */\r\n\tquery: string;\r\n\r\n\t/** Downshift's render prop parameter. */\r\n\tdownshift: ControllerStateAndHelpers<Suggestion>;\r\n\r\n\tonViewMatches: (downshift: ControllerStateAndHelpers<Suggestion>) => void;\r\n\tSuggestionList?: React.ComponentType<CustomSuggestionListProps>;\r\n}\r\n\r\nfunction SearchSuggestions({ query, downshift, onViewMatches, SuggestionList }: SearchSuggestionsProps) {\r\n\tconst { config } = useHawkConfig();\r\n\tconst { store } = useHawksearch();\r\n\r\n\tconst client = new HawkClient(config);\r\n\r\n\tconst [results, setResults] = useState({} as Response);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\r\n\t// debounce the input search string so that we only do an autocomplete query every so often\r\n\tuseEffect(() => {\r\n\t\t// default to 200ms if not specified\r\n\t\tconst debounceMs = config.autocompleteDebounce || 200;\r\n\r\n\t\tconst cts = axios.CancelToken.source();\r\n\t\tconst timeout = setTimeout(() => doAutocomplete(query, cts.token), debounceMs);\r\n\r\n\t\treturn () => {\r\n\t\t\tcts.cancel();\r\n\t\t\tclearTimeout(timeout);\r\n\t\t};\r\n\t}, [query, config.autocompleteDebounce]);\r\n\r\n\t/**\r\n\t * Performs an autocomplete request to the Hawk API and populates the result set of this component.\r\n\t * @param input The user entered search string that results will be autocompleted for.\r\n\t */\r\n\tasync function doAutocomplete(input: string, cancellationToken?: CancelToken) {\r\n\t\tsetIsLoading(true);\r\n\r\n\t\tlet response: Response | null = null;\r\n\r\n\t\ttry {\r\n\t\t\tresponse = await client\r\n\t\t\t\t.autocomplete(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tClientGuid: config.clientGuid,\r\n\t\t\t\t\t\tKeyword: decodeURIComponent(input),\r\n\t\t\t\t\t\tIndexName: config.indexName,\r\n\t\t\t\t\t\tDisplayFullResponse: true,\r\n\t\t\t\t\t\tFacetSelections: store.pendingSearch.FacetSelections,\r\n\t\t\t\t\t\tClientData: getClientData(),\r\n\t\t\t\t\t\tIsInPreview: config.isInPreview,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcancellationToken\r\n\t\t\t\t)\r\n\t\t\t\t.then(o => {\r\n\t\t\t\t\t// ensure, returned object will return response\r\n\t\t\t\t\t// since by default, axios uses JSON.parse to parse an object,\r\n\t\t\t\t\t// it doesn't recognize it as Response type - this line is to prevent it\r\n\t\t\t\t\treturn Object.assign(new Response(o));\r\n\t\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tif (axios.isCancel(error)) {\r\n\t\t\t\t// if the request was cancelled, it's because this component was updated\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.error('Autocomplete request error:', error);\r\n\t\t}\r\n\r\n\t\tsetIsLoading(false);\r\n\r\n\t\tif (response) {\r\n\t\t\tsetResults(response);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getClientData() {\r\n\t\tlet visitId = getCookie('hawk_visit_id');\r\n\t\tlet visitorId = getCookie('hawk_visitor_id');\r\n\r\n\t\tif (!visitId) {\r\n\t\t\tsetCookie('hawk_visit_id', createGuid(), getVisitExpiry());\r\n\t\t\tvisitId = getCookie('hawk_visit_id');\r\n\t\t}\r\n\r\n\t\tif (!visitorId) {\r\n\t\t\tsetCookie('hawk_visitor_id', createGuid(), getVisitorExpiry());\r\n\t\t\tvisitorId = getCookie('hawk_visitor_id');\r\n\t\t}\r\n\r\n\t\tconst clientData: ClientData = {\r\n\t\t\tVisitorId: visitorId || '',\r\n\t\t\tVisitId: visitId || '',\r\n\t\t\tUserAgent: navigator.userAgent,\r\n\t\t};\r\n\r\n\t\tif (store.language) {\r\n\t\t\tclientData.Custom = {\r\n\t\t\t\tlanguage: store.language,\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn clientData;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"autosuggest-menu\">\r\n\t\t\t<SearchSuggestionsList\r\n\t\t\t\tonViewMatches={onViewMatches}\r\n\t\t\t\tdownshift={downshift}\r\n\t\t\t\tisLoading={isLoading}\r\n\t\t\t\tsearchResults={results}\r\n\t\t\t\tSuggestionList={SuggestionList}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default SearchSuggestions;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { DownshiftState, StateChangeOptions, ControllerStateAndHelpers } from 'downshift';\r\n\r\nimport SearchSuggestions from 'components/ui/SearchBox/SearchSuggestions';\r\nimport { Suggestion, SuggestionStrategyMatch } from 'models/Autocomplete/Suggestion';\r\nimport { getAutocompleteStrategies } from '../Facets/Overrides';\r\nimport { useHawkConfig } from 'components/ConfigProvider';\r\nimport { Product } from 'models/Autocomplete';\r\nimport { useHawksearch } from 'components/StoreProvider';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { CustomSuggestionListProps } from 'models/Autocomplete/CustomSuggestionList';\r\n\r\nimport Downshift from 'downshift';\r\n\r\nexport interface SearchBoxBaseProps {\r\n\tinitialValue?: string;\r\n\tonSubmit: (event: React.KeyboardEvent<HTMLInputElement>, downshift: ControllerStateAndHelpers<Suggestion>) => void;\r\n\tonViewMatches: (downshift: ControllerStateAndHelpers<Suggestion>) => void;\r\n\tSuggestionList?: React.ComponentType<CustomSuggestionListProps>;\r\n}\r\n\r\nfunction SearchBoxBase({ initialValue, onSubmit, onViewMatches, SuggestionList }: SearchBoxBaseProps) {\r\n\tconst { config } = useHawkConfig();\r\n\tconst strategies = getAutocompleteStrategies(config.autocompleteStrategies || []);\r\n\tconst { t, i18n } = useTranslation();\r\n\tconst {\r\n\t\tstore: { pendingSearch, searchResults },\r\n\t} = useHawksearch();\r\n\tconst [initialInput, setInitialInput] = useState('');\r\n\r\n\t// Will update the suggested selected keyword in the autocomplete input box\r\n\tuseEffect(() => {\r\n\t\tsetInitialInput(decodeURIComponent(pendingSearch.Keyword || ''));\r\n\t}, [pendingSearch.Keyword, initialValue, pendingSearch.IgnoreSpellcheck]);\r\n\r\n\t// Will update the Adjusted keyword in the autocomplete input box\r\n\tuseEffect(() => {\r\n\t\tif (searchResults && searchResults.AdjustedKeyword) {\r\n\t\t\tsetInitialInput(decodeURIComponent(searchResults.AdjustedKeyword));\r\n\t\t}\r\n\t}, [searchResults]);\r\n\r\n\t/** Called when the internal state of downshift changes - we're handling a couple custom behaviors here */\r\n\tfunction handleStateChange(\r\n\t\tstate: DownshiftState<Suggestion>,\r\n\t\tchanges: StateChangeOptions<Suggestion>\r\n\t): Partial<StateChangeOptions<Suggestion>> {\r\n\t\tif (\r\n\t\t\t// NOTE: these strings are hardcoded to support code splitting downshift.\r\n\t\t\t// using the constants from the package will prevent code splitting from operating correctly\r\n\t\t\tchanges.type === '__autocomplete_mouseup__' ||\r\n\t\t\tchanges.type === '__autocomplete_keydown_enter__' ||\r\n\t\t\tchanges.type === '__autocomplete_click_item__'\r\n\t\t) {\r\n\t\t\t// when:\r\n\t\t\t//\r\n\t\t\t//  1. the mouse the clicked outside of downshift\r\n\t\t\t//  2. enter is pressed on the keyboard\r\n\t\t\t//  3. an item is selected from the dropdown\r\n\t\t\t//\r\n\t\t\t// then we want to retain the input value that was originally typed in. by default downshift\r\n\t\t\t// will clear the input value, so we're overriding this behavior here.\r\n\t\t\treturn { ...changes, inputValue: state.inputValue };\r\n\t\t}\r\n\r\n\t\treturn changes;\r\n\t}\r\n\r\n\t/** Called when an item has been selected from the autocomplete results. */\r\n\tfunction handleItemChange(item: Suggestion, downshift: ControllerStateAndHelpers<Suggestion>) {\r\n\t\tif (!item) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst matchedStrategy = strategies.find(strategy => strategy.SuggestionType === item.SuggestionType);\r\n\t\tif (!matchedStrategy) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t(matchedStrategy as SuggestionStrategyMatch).SuggestionStrategy.handleItemChange(item, downshift);\r\n\t}\r\n\r\n\tfunction handleToString(item: Suggestion): string {\r\n\t\tif (!item) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\tconst matchedStrategy = strategies.find(strategy => strategy.SuggestionType === item.SuggestionType);\r\n\t\tif (!matchedStrategy) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn (matchedStrategy as SuggestionStrategyMatch).SuggestionStrategy.toString(item);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<React.Suspense fallback={<div>{t('Loading')}...</div>}>\r\n\t\t\t<Downshift\r\n\t\t\t\tstateReducer={handleStateChange}\r\n\t\t\t\titemToString={(item: Suggestion) => handleToString(item)}\r\n\t\t\t\tonChange={handleItemChange}\r\n\t\t\t\tinitialInputValue={decodeURIComponent(initialValue || '')}\r\n\t\t\t\tinputValue={initialInput}\r\n\t\t\t>\r\n\t\t\t\t{(options: ControllerStateAndHelpers<Suggestion>) => {\r\n\t\t\t\t\tconst { isOpen, inputValue, getInputProps, openMenu, closeMenu } = options;\r\n\r\n\t\t\t\t\tconst showSuggestions = isOpen && inputValue && inputValue.length > 0;\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div className=\"hawk__searchBox__searchInput\" aria-labelledby=\"autocomplete-search-box\">\r\n\t\t\t\t\t\t\t<div id=\"autocomplete-search-box\" className=\"hidden-label\">\r\n\t\t\t\t\t\t\t\tAutocomplete search box\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tstyle={{ width: '100%' }}\r\n\t\t\t\t\t\t\t\t{...getInputProps({\r\n\t\t\t\t\t\t\t\t\tonKeyDown: event => {\r\n\t\t\t\t\t\t\t\t\t\tif (onSubmit) {\r\n\t\t\t\t\t\t\t\t\t\t\tonSubmit(event, options);\r\n\t\t\t\t\t\t\t\t\t\t\tcloseMenu();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t\t// when the input is focused again, reopen the downshift menu\r\n\t\t\t\t\t\t\t\t\tonFocus: () => {\r\n\t\t\t\t\t\t\t\t\t\tif (inputValue && inputValue.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\topenMenu();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tonChange: event => {\r\n\t\t\t\t\t\t\t\t\t\tsetInitialInput(event.target.value);\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t\tplaceholder: t('Enter a search term'),\r\n\t\t\t\t\t\t\t\t\t'aria-labelledby': 'autocomplete-search-box',\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{showSuggestions ? (\r\n\t\t\t\t\t\t\t\t<SearchSuggestions\r\n\t\t\t\t\t\t\t\t\tquery={inputValue || ''}\r\n\t\t\t\t\t\t\t\t\tdownshift={options}\r\n\t\t\t\t\t\t\t\t\tonViewMatches={onViewMatches}\r\n\t\t\t\t\t\t\t\t\tSuggestionList={SuggestionList}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t) : null}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t);\r\n\t\t\t\t}}\r\n\t\t\t</Downshift>\r\n\t\t</React.Suspense>\r\n\t);\r\n}\r\n\r\nexport default SearchBoxBase;\r\n"],"sourceRoot":""}